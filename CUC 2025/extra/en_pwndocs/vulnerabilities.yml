- cvssv3: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
  priority: 2
  remediationComplexity: 1
  details:
    - locale: EN
      title: Powershell Hardening
      vulnType: Pentest
      description: >-
        <p>PowerShell is a task automation and configuration management
        framework developed by Microsoft, consisting of a command-line shell and
        associated scripting language built on the .NET framework. It was
        designed to provide a more efficient and effective way for Windows
        administrators to manage and automate various system administration
        tasks, including managing the Windows operating system and other
        Microsoft products such as Exchange, SharePoint, and SQL
        Server.<br><br>PowerShell is often used by adversaries because it
        provides them with a built-in versatile tool for executing malicious
        scripts and commands, bypassing security controls, accessing sensitive
        information, and hiding their actions, making it an attractive tool for
        malicious actors.<br><br>There are several steps that can be taken to
        harden the way PowerShell can act on a system or in specific user
        context:<br></p><ul><li><p>Restrict the Language Mode</p><p>The
        PowerShell language mode determines the syntax, language elements, and
        behavior of PowerShell scripts, with the two main modes being "Full" and
        "Constrained" that can be used to restrict the capabilities of
        PowerShell scripts for security and administrative
        purposes.</p></li><li><p>Set an Execution Policy</p><p>The PowerShell
        execution policy is a security feature that determines what types of
        PowerShell scripts can run on a system and is used to help protect
        against malicious scripts by restricting the execution of scripts from
        unknown or untrusted sources.</p></li><li><p>Uninstall old PowerShell
        versions</p><p>PowerShell version 5 and above has important built-in
        security features that make it safer to use in enterprise environments.
        For example, PowerShell v5 logs every script that is run, making it
        easier to trace the execution of malware. <br>These security features
        are not present in PowerShell v2.0, making it less secure, which at the
        same time makes it a lucrative alternative for
        attackers.</p></li></ul><p></p>
      observation: >-
        <p>Language Mode Failure = Medium<br>Execution Policy =
        Low<br>PowerShell v2 = High</p>
      remediation: >-
        <p>Set the Language Mode to <em>Restricted</em>. This can be activated
        locally:</p><pre><code>[Environment]::SetEnvironmentVariable(‘__PSLockdownPolicy‘,
        ‘4’, ‘Machine‘)</code></pre><p>Or via Group Policies
        Objects:</p><p><em>Computer Configuration\Preferences\Windows
        Settings\Environment</em><br></p><img class="custom-image"
        src="63e504b947c5530011586cfc" alt="Setting PowerShell Language Mode via
        GPO"><p></p><p>Set the Execution Policy to <em>AllSigned</em>. This can
        be done via GPO here: <em>Computer Configuration &gt; Policies &gt;
        Administrative Templates &gt; Windows Components &gt; Windows
        PowerShell</em><br></p><img class="custom-image"
        src="63e505c447c5530011586cfd" alt="Setting Execution Policy for
        PowerShell via GPO"><p><br><br>Deactivate PowerShell v2.0 via GPO or
        remove it locally via the "Windows Features".</p>
      references:
        - https://adsecurity.org/?p=2604
        - >-
          https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.security/set-executionpolicy?view=powershell-7.3
        - >-
          https://learn.microsoft.com/en-us/powershell/scripting/learn/security-features?view=powershell-7.3
        - >-
          https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_execution_policies?view=powershell-7.3
      customFields: []
  category: System Security
- cvssv3: CVSS:3.1/AV:P/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N
  priority: 2
  remediationComplexity: 2
  details:
    - locale: EN
      title: DMA Attacks
      description: >-
        <p>DMA (Direct Memory Access) attacks are a class of security threats
        that exploit the DMA feature present in many computer systems. DMA
        allows hardware devices, such as network cards or USB controllers, to
        access the system's memory directly without involving the CPU, enabling
        faster data transfers.</p><p>In a DMA attack, an attacker gains physical
        or remote access to a target system and leverages DMA capabilities to
        directly read from or write to the system's memory. This access allows
        the attacker to bypass traditional security measures, such as operating
        system permissions or encryption, and potentially gain unauthorized
        access to sensitive data or compromise the system's
        integrity.</p><p>There are two main types of DMA
        attacks:</p><ol><li><p>DMA Read Attacks: In this type of attack, the
        attacker gains access to the system's memory and can read sensitive
        information stored in the memory, including encryption keys, passwords,
        or confidential data. The attacker can then use this information for
        unauthorized purposes.</p></li><li><p>DMA Write Attacks: In a DMA write
        attack, the attacker injects malicious data or code into the system's
        memory, potentially overwriting critical data or modifying the system's
        behavior. This can lead to unauthorized privilege escalation, injection
        of malware, or modification of system settings.</p></li></ol><p>DMA
        attacks can be executed through various means, including physical access
        to the target system, compromised peripheral devices, or exploiting
        vulnerabilities in system firmware or drivers. Some examples of DMA
        attack vectors include FireWire, Thunderbolt, PCI Express, or PCMCIA
        interfaces.</p>
      remediation: >-
        <p>Apply according counter measures via GPO (please also refer to the
        references):<br><br>Firewire: <br><code>Computer Configuration &gt;
        Administrative Templates &gt; System &gt; Device Installation &gt;
        Device Installation Restrictions &gt; Prevent installation of devices
        using drivers that match these device setup classes</code></p><p>Add the
        following entries:</p><table><tbody><tr><th colspan="1"
        rowspan="1"><p><strong>GUID</strong></p></th></tr><tr><td colspan="1"
        rowspan="1"><p><strong>{7ebefbc0-3200-11d2-b4c2-00a0C9697d07}</strong></p></td></tr><tr><td
        colspan="1"
        rowspan="1"><p><strong>{c06ff265-ae09-48f0-812c-16753d7cba83}</strong></p></td></tr><tr><td
        colspan="1"
        rowspan="1"><p><strong>{d48179be-ec20-11d1-b6b8-00c04fa372a7}</strong></p></td></tr><tr><td
        colspan="1"
        rowspan="1"><p><strong>{6bdd1fc1-810f-11d0-bec7-08002be2092f}</strong></p></td></tr></tbody></table><p></p><p>PCIe:<br><code>Computer
        Configuration &gt; Administrative Templates &gt; Windows Components &gt;
        BitLocker Drive Encryption &gt; Disable new DMA devices when this
        computer is locked</code></p><p>General protection against DMA
        attacks:</p><p><code>Computer Configuration &gt; Administrative
        Templates &gt; System &gt; Device Guard &gt; Turn on Virtualization
        Based Security &gt; Secure Boot with DMA</code></p>
      references:
        - >-
          https://www.synacktiv.com/en/publications/practical-dma-attack-on-windows-10.html
        - https://www.scip.ch/?labs.20211209
      customFields: []
  category: System Security
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:N
  priority: 2
  remediationComplexity: 1
  details:
    - locale: EN
      title: LSA Protection Settings
      vulnType: Pentest
      description: >-
        <p>LSA Protection, also known as RunAsPPL (Protected Process Light), is
        a security feature introduced in Windows 10 and Windows Server 2016. It
        is designed to protect critical operating system processes by running
        them with an elevated level of protection.</p><p>LSA (Local Security
        Authority) is a subsystem in Windows responsible for security-related
        operations. LSA Protection ensures that certain critical LSA processes
        are isolated and run in a restricted mode called "Protected Process
        Light." This mode provides additional security measures to prevent
        unauthorized access or tampering of these processes.</p><p>Protected
        Process Light (PPL) restricts the interactions and privileges of a
        process, making it more resistant to attacks and unauthorized
        modifications. PPL processes are given a higher integrity level, making
        it difficult for lower-privileged processes or malware to tamper with
        them. This helps protect critical system functions and sensitive
        data.</p><p>By running LSA processes as PPL, Windows enhances the
        overall security of the operating system and helps mitigate various
        attack vectors that target system-level processes.</p>
      observation: <p><br><br></p>
      remediation: >-
        <p>Activate LSA Protection by setting the following registry
        key:<br><code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\LSA
        RunAsPPL= 1</code></p>
      references:
        - https://itm4n.github.io/lsass-runasppl/
      customFields: []
  category: System Security
- cvssv3: CVSS:3.1/AV:P/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
  priority: 2
  remediationComplexity: 1
  details:
    - locale: EN
      title: Disk Encryption Settings
      vulnType: Pentest
      description: >-
        <p>Disk encryption is a security measure used to protect the data stored
        on a storage device, such as a hard drive or solid-state drive (SSD). It
        ensures that the data remains unreadable and inaccessible to
        unauthorized users even if the device is lost, stolen, or accessed
        without proper authorization.</p><p>The primary purpose of disk
        encryption is to encrypt the entire contents of the disk, including the
        operating system, applications, and user data. It prevents unauthorized
        individuals from accessing or extracting sensitive information from the
        disk by encrypting it using a cryptographic algorithm.</p><p>One method
        to enhance the security of disk encryption is through preboot
        authentication (PBA). PBA adds an additional layer of protection by
        requiring users to provide authentication credentials before the
        operating system boots up. This means that even if someone gains
        physical access to the device, they cannot bypass the encryption without
        providing the correct authentication.</p><p>Preboot authentication
        typically involves a separate login screen or interface that prompts
        users to enter a password or other authentication factors, such as a PIN
        or biometric data (e.g., fingerprint or facial recognition). Only upon
        successful authentication will the device proceed to boot up the
        operating system and decrypt the disk.</p><p>By combining disk
        encryption with preboot authentication, the data on the encrypted disk
        remains secure from unauthorized access. Even if an attacker manages to
        steal or gain physical access to the device, they would need to bypass
        the preboot authentication to gain access to the encrypted
        data.</p><p>It is important to choose strong authentication credentials
        and regularly update them to maintain the security of the disk
        encryption. Additionally, ensuring the device's firmware and software
        are up to date helps protect against known vulnerabilities and ensures
        the effectiveness of the encryption and authentication mechanisms.</p>
      remediation: >-
        <p>If the encryption is meant to protect against sophisticated attacks,
        the TPM only mode for BitLocker is not sufficient. One of the
        alternative solutions with an additional PIN or USB device should be
        taken into consideration[2]. Another idea would be to make use of 3rd
        party applications that will give the user a SSO feeling that integrate
        with BitLocker.</p>
      references:
        - '[1] https://luemmelsec.github.io/Go-away-BitLocker-you-are-drunk/'
        - >-
          [2]
          https://learn.microsoft.com/en-us/windows/security/information-protection/bitlocker/bitlocker-countermeasures
      customFields: []
  category: System Security
- cvssv3: CVSS:3.1/AV:P/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
  priority: 2
  remediationComplexity: 1
  details:
    - locale: EN
      title: Removal Media Control Settings
      vulnType: Pentest
      description: >-
        <p>Removable media control is a security feature that helps protect
        against various threats related to the use of removable storage devices
        such as USB flash drives, external hard drives, and optical media.
        Here's a brief description of why removable media control is considered
        a security feature and the threats it can help
        mitigate:</p><ol><li><p>Unauthorized data access: Preventing
        unauthorized access to sensitive data on removable
        devices.</p></li><li><p>Malware introduction and spread: Reducing the
        risk of malware infections and the spread of malicious code through
        removable media.</p></li><li><p>"Bad USB" or "Bad Ethernet" devices that
        disguise as legitimate USB devices emulating HIDs like a keyboard or a
        network adapter to execute code or sniff
        credentials.</p></li><li><p>Data loss prevention: Implementing measures
        to prevent accidental data loss or unauthorized copying of sensitive
        information.</p></li><li><p>Unauthorized software or applications:
        Restricting the introduction of unauthorized software onto corporate
        devices through removable media.</p></li><li><p>Compliance and
        regulatory requirements: Enforcing policies to meet industry regulations
        and demonstrate data security compliance.</p></li></ol><p><a
        target="_blank" rel="noopener noreferrer nofollow"
        href="http://compliance.By">By</a> implementing removable media control
        as a security feature, organizations can mitigate the risks associated
        with unauthorized data access, malware infections, data loss,
        unauthorized software execution, and non-compliance with regulations. It
        provides an additional layer of protection to safeguard sensitive
        information and maintain the integrity and security of systems and
        networks.</p>
      remediation: >-
        <p>Implement according countermeasures that prevent attacks over
        removeable media.<br>This can for example be done via
        GPOs:</p><ol><li><p>Device installation restrictions: Group Policy can
        be used to restrict the installation of USB devices on computers. It
        allows administrators to define policies that prevent the installation
        of unrecognized or unauthorized USB devices, thereby mitigating the risk
        of "Bad USB" attacks.</p></li><li><p>USB port disabling: Group Policy
        enables administrators to disable specific USB ports on computers. By
        selectively disabling USB ports, organizations can limit the risk of
        unauthorized USB devices being connected and prevent potential "Bad USB"
        attacks.</p></li><li><p>Windows Defender Application Control: Windows
        Defender Application Control (WDAC) is a security feature available in
        Windows 10 Enterprise and Windows Server editions. It uses Group Policy
        to define policies that allow only trusted applications to run on a
        system. By enforcing strict application control policies, organizations
        can reduce the risk of "Bad USB" attacks by blocking the execution of
        unauthorized or malicious code from USB
        devices.</p></li></ol><p></p><p><br></p>
      references: []
      customFields: []
  category: System Security
- cvssv3: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:L/A:N
  priority: 3
  remediationComplexity: 1
  details:
    - locale: EN
      title: Credential Guard Settings
      vulnType: Pentest
      description: >-
        <p>Credential Guard is a security feature introduced in Windows 10 and
        Windows Server 2016 that helps protect against credential theft and
        unauthorized access to sensitive credentials on a Windows system. It is
        specifically designed to defend against Pass-the-Hash (PtH) and
        Pass-the-Ticket (PtT) attacks.</p><p>Credential theft attacks typically
        target the authentication process by stealing or manipulating user
        credentials, such as usernames and passwords, stored in memory or the
        Local Security Authority (LSA) process. These attacks allow adversaries
        to gain unauthorized access to systems, networks, or sensitive
        resources.</p><p>Credential Guard leverages virtualization-based
        security to isolate and protect these credentials. It utilizes
        virtualization technology, such as Hyper-V, to create a separate
        isolated environment called the "security boundary." Within this
        security boundary, sensitive credentials are stored and processed,
        effectively isolating them from the rest of the system, including the
        operating system and user processes.</p><p>By isolating credentials in a
        protected environment, Credential Guard helps prevent unauthorized
        access or tampering by malicious actors. It ensures that even if an
        attacker gains access to the operating system or compromises the system
        at a lower level, they cannot access or extract sensitive credentials
        stored within Credential Guard.</p><p>Key features and benefits of
        Credential Guard include:</p><ol><li><p>Protection against Pass-the-Hash
        and Pass-the-Ticket attacks.</p></li><li><p>Isolation of credentials in
        a separate security boundary.</p></li><li><p>Use of virtualization-based
        security technology for enhanced
        protection.</p></li><li><p>Compatibility with existing authentication
        methods, such as Kerberos and NTLM.</p></li><li><p>Integration with
        other security technologies, like Windows Hello for Business and Windows
        Defender Credential Guard.</p></li></ol><p>Overall, Credential Guard
        strengthens the security posture of Windows systems by safeguarding
        sensitive credentials and mitigating the risk of credential theft
        attacks.</p>
      remediation: >-
        <p>Follow the steps provided by Microsoft [1] to enabled Credential
        Guard.</p>
      references:
        - >-
          [1]
          https://learn.microsoft.com/en-us/windows/security/identity-protection/credential-guard/credential-guard-manage
        - https://blog.nviso.eu/2018/01/09/windows-credential-guard-mimikatz/
        - >-
          https://blog.netwrix.com/2023/02/06/using-windows-defender-credential-guard-to-protect-privileged-credentials/
      customFields: []
  category: System Security
- cvssv3: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N
  priority: 2
  remediationComplexity: 3
  details:
    - locale: EN
      title: Applocker Settings
      vulnType: Pentest
      description: >-
        <p>AppLocker is a security feature introduced in Windows 7 and Windows
        Server 2008 R2, and it is available in subsequent versions of Windows.
        It is designed to help organizations enforce application control
        policies by allowing or blocking the execution of specified applications
        and scripts.</p><p>AppLocker enables administrators to define rules that
        determine which applications are allowed to run on a system. These rules
        can be based on various criteria, including file path, file hash,
        publisher, or digital signature. By configuring these rules,
        administrators have granular control over the types of applications that
        can be executed on managed systems.</p><p>Key features and benefits of
        AppLocker include:</p><ol><li><p>Application Whitelisting:
        Administrators can create rules that specify which applications are
        allowed to run, effectively whitelisting approved applications. This
        helps prevent unauthorized or malicious software from running on the
        system.</p></li><li><p>Rule Enforcement: AppLocker enforces the
        configured rules at the operating system level, ensuring that only
        approved applications are allowed to execute. It helps protect against
        unauthorized software installations and execution
        attempts.</p></li><li><p>Flexible Rule Criteria: Rules can be created
        based on various criteria, including file attributes, publisher
        information, digital signatures, and path locations. This flexibility
        allows organizations to define specific policies tailored to their
        needs.</p></li><li><p>Centralized Management: AppLocker can be managed
        through Group Policy, providing a centralized management interface for
        creating, deploying, and maintaining application control policies across
        multiple systems.</p></li><li><p>Auditing and Reporting: AppLocker
        provides auditing capabilities to track and monitor application
        execution attempts. Detailed logs and reports help administrators
        identify and investigate unauthorized or blocked application
        activities.</p></li></ol><p>AppLocker is primarily aimed at
        organizations that require strict control over the software running on
        their systems, such as enterprises, government agencies, and regulated
        industries. It helps enhance security by preventing the execution of
        unauthorized or potentially malicious applications, reducing the attack
        surface and mitigating the risk of malware infections and unauthorized
        software usage.</p>
      remediation: >-
        <p>Where applicable use WDAC (see [1]).</p><p>If not feasible, implement
        Applocker to further harden the system against attacks.</p><p>Follow the
        guidelines referenced from Microsoft [2].</p>
      references:
        - >-
          [1]
          https://learn.microsoft.com/de-de/windows/security/threat-protection/windows-defender-application-control/wdac-and-applocker-overview
        - >-
          [2]
          https://learn.microsoft.com/de-de/windows/security/threat-protection/windows-defender-application-control/applocker/applocker-overview
      customFields: []
  category: System Security
- cvssv3: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:L
  priority: 3
  remediationComplexity: 1
  details:
    - locale: EN
      title: DHCPv6 Settings
      vulnType: Pentest
      description: >-
        <p>In DHCPv6, one of the potential attack vectors is related to the
        DHCPv6 offer process, specifically when configuring DNS servers. Here's
        an explanation of DHCPv6 attacks related to setting DNS servers via DHCP
        offers:</p><ol><li><p>Rogue DHCPv6 Server: An attacker can set up a
        rogue DHCPv6 server on the network to offer malicious DNS server
        addresses in the DHCPv6 response. When clients request DHCPv6
        configuration, they may receive a DHCPv6 offer from the rogue server
        with DNS server addresses that the attacker controls. This can redirect
        the client's DNS queries to malicious DNS servers under the attacker's
        control.</p></li><li><p>DNS Spoofing: By providing malicious DNS server
        addresses in the DHCPv6 offer, an attacker can perform DNS spoofing.
        When clients use the offered DNS servers to resolve domain names, the
        attacker's DNS servers respond with false or malicious information. This
        can lead to users being redirected to malicious websites, phishing
        attacks, or manipulation of DNS responses to gain unauthorized access to
        sensitive information.</p></li><li><p>MITM Attacks: DHCPv6 DNS server
        configuration can also be exploited for Man-in-the-Middle (MitM)
        attacks. An attacker may intercept the DHCPv6 offer and modify the DNS
        server addresses to point to their own server. This enables the attacker
        to intercept DNS queries and responses, allowing them to monitor or
        manipulate the communication between the client and legitimate DNS
        servers.</p></li></ol><p>Normally companies have a DHCPv4 server running
        but not one for DHCPv6. Modern Windows versions ship with IPv6 enabled,
        which takes precedence over IPv4. Hence out of the box these systems are
        likely to be vulnerable to the before mentioned attacks.</p>
      remediation: >-
        <p>To mitigate the described attacks, the following measures can be
        implemented:</p><p>Disable IPv6: If IPv6 is not required, it is
        recommended to disable the IPv6 interface on client systems. This can be
        done through network adapter settings or registry
        configurations.</p><p>Prefer IPv4 over IPv6: Network configurations can
        be adjusted to prioritize IPv4 connectivity over IPv6. This can be done
        by modifying network interface settings or network routing
        configurations. In these cases the valid IPv4 configuration for e.g. DNS
        will "overrule" the rouge IPv6 DNS setting.</p><p>Exercise caution in
        disabling IPv6 on Servers: Microsoft advises against disabling IPv6 in
        server environments, as it may cause disruptions to critical
        functionalities such as Exchange or Domain Controllers. Careful
        consideration should be given before disabling IPv6 on
        servers.</p><p>Configure IPS/IDS Rules: Intrusion Prevention Systems
        (IPS) or Intrusion Detection Systems (IDS) can be configured with
        additional rules specifically designed to detect and mitigate DHCPv6
        attacks. These rules should be regularly updated to address emerging
        threats.</p><p>Use Encrypted Connections: To prevent man-in-the-middle
        attacks, it is recommended to utilize encrypted connections wherever
        possible. This includes using secure protocols such as HTTPS for web
        communications and implementing VPNs (Virtual Private Networks) for
        secure remote access.</p><p>Specify Static Gateway and DNS Server: If
        IPv6 is necessary, it is advisable to manually configure and specify the
        gateway and DNS server addresses statically. This reduces the risk of
        DNS-related attacks by eliminating the reliance on DHCPv6 for network
        configuration.</p>
      references:
        - >-
          https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/
        - >-
          https://www.blackhillsinfosec.com/mitm6-strikes-again-the-dark-side-of-ipv6/
      customFields: []
  category: System Security
- cvssv3: CVSS:3.1/AV:P/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
  priority: 1
  remediationComplexity: 1
  details:
    - locale: EN
      title: BIOS Hardening
      vulnType: Pentest
      description: >-
        <p>The Basic Input/Output System (BIOS) is a firmware that is embedded
        in a computer's motherboard. It is responsible for initializing hardware
        components during the boot process and providing a basic set of
        instructions for the operating system to interact with the
        hardware.</p><p>Securing the BIOS with a password is important for
        several reasons:</p><ol><li><p>Unauthorized access prevention: Setting a
        BIOS password adds an extra layer of security to your computer system.
        It prevents unauthorized users from accessing and modifying critical
        BIOS settings, such as boot order, hardware configurations, and security
        features.</p></li><li><p>Protection against unauthorized booting: A BIOS
        password helps protect against unauthorized booting of the system from
        external devices, such as USB drives or optical media. It ensures that
        only authorized individuals can boot the system, reducing the risk of
        unauthorized access or malware infections.</p></li><li><p>Data
        protection: By securing the BIOS, you can help protect sensitive data
        stored on your computer. If someone tries to tamper with the BIOS
        settings or remove the hard drive, they will be unable to access the
        data without the BIOS password.</p></li><li><p>Preventing malicious
        firmware modifications: Securing the BIOS helps prevent unauthorized
        modifications to the firmware itself. Malicious actors could potentially
        modify the BIOS to install persistent malware or compromise the system's
        integrity. A BIOS password reduces the risk of such
        tampering.</p></li><li><p>Compliance and regulatory requirements: In
        certain industries or organizations, securing the BIOS with a password
        may be necessary to comply with industry regulations or internal
        security policies. It demonstrates a proactive approach to securing
        computer systems and protecting sensitive
        information.</p></li></ol><p>It's important to note that while a BIOS
        password provides a level of security, it is not foolproof. Advanced
        attackers may still find ways to bypass or reset the BIOS password.
        However, setting a BIOS password is a recommended security practice that
        can help mitigate the risk of unauthorized access and protect system
        integrity.</p>
      remediation: <p>A strong and unique password for each system should be used.</p>
      references: []
      customFields: []
  category: System Security
- cvssv3: CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:L/I:H/A:N
  priority: 2
  remediationComplexity: 2
  details:
    - locale: EN
      title: Writeable SYSTEM Path Folders
      vulnType: Pentest
      description: >-
        <p>Granting low-privileged users write rights over folders that are in
        the SYSTEM Path variable can pose security risks due to the following
        reasons:</p><ul><li><p>Malicious code execution: If low-privileged users
        can write to the folders in the SYSTEM Path variable, they could
        potentially place malicious executables or scripts in those folders.
        This could allow them to execute arbitrary code with elevated
        privileges, bypassing security controls.</p></li><li><p>DLL hijacking:
        By placing a malicious DLL (Dynamic Link Library) with the same name as
        a legitimate DLL used by an application in one of the writable folders,
        low-privileged users can trick the application into loading the
        malicious DLL. This can lead to arbitrary code execution or privilege
        escalation.</p></li><li><p>Path hijacking: If low-privileged users can
        modify the SYSTEM Path variable, they can manipulate the order of folder
        paths. This can result in unintended application behavior, as an
        attacker can substitute a legitimate executable or script with a
        malicious one in a folder they have write access
        to.</p></li><li><p>Privilege escalation: Exploiting write access to
        folders in the SYSTEM Path variable can be used as a stepping stone for
        privilege escalation. By placing a malicious executable in a writable
        folder, an attacker can trick a higher-privileged user or system process
        to execute it, potentially gaining elevated privileges.</p></li></ul>
      remediation: >-
        <p>To mitigate these risks, it is recommended to restrict write access
        to folders in the SYSTEM Path variable to only trusted administrators or
        authorized users. Regular users should not have write permissions on
        these folders to prevent unauthorized modifications and potential
        security breaches.</p>
      references: []
      customFields: []
  category: System Security
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:H/A:N
  details:
    - locale: EN
      title: WDAC Settings
      vulnType: Pentest
      description: >-
        <p>Windows Defender Application Control (WDAC) is a security feature in
        Windows 10 that helps protect systems against malware and unauthorized
        software execution, and is the successor to Applocker. WDAC utilizes
        code integrity policies to enforce strict control over which
        applications and code can run on a device.</p><p>WDAC operates by
        establishing a trusted set of rules that define which applications are
        allowed to execute based on factors such as digital signatures, file
        hashes, and other criteria. These rules create a whitelist of trusted
        applications and prevent the execution of unauthorized or malicious
        code.</p><p>With WDAC, organizations can define and enforce policies
        that specify which software is allowed to run, reducing the risk of
        malware infection and unauthorized software installations. It adds an
        additional layer of protection by verifying the integrity and
        authenticity of applications before they are executed.</p><p>WDAC
        leverages virtualization-based security technologies, such as Virtual
        Secure Mode (VSM) and hardware-based security features, to provide a
        highly secure execution environment. It helps protect against
        kernel-level exploits, code injection attacks, and other advanced
        malware techniques.</p><p>By implementing WDAC, organizations can
        strengthen their security posture, reduce the attack surface, and ensure
        that only trusted and authorized applications can run on their Windows
        10 devices.</p>
      remediation: >-
        <p>Enabling Windows Defender Application Control (WDAC) involves several
        steps and requires specific configurations. Here's a general outline of
        the process:</p><ul><li><p>Verify System Requirements: Ensure that your
        system meets the hardware and software requirements for WDAC. This
        includes having a compatible version of Windows 10 Enterprise or Windows
        Server, a compatible processor with virtualization extensions, and
        Secure Boot enabled.</p></li><li><p>Create Code Integrity Policies: WDAC
        relies on code integrity policies to define the rules for application
        and code execution. You need to create and configure these policies
        based on your organization's requirements. This involves specifying
        trusted sources, file hashes, and other criteria that determine which
        applications are allowed to run.</p></li><li><p>Deploy WDAC Policies:
        Once the code integrity policies are defined, you need to deploy them to
        the target devices. This can be done using Group Policy, Configuration
        Manager, or other deployment tools. Ensure that the policies are
        distributed and applied correctly to the intended
        devices.</p></li><li><p>Test and Validate Policies: It's crucial to
        thoroughly test and validate the WDAC policies to ensure that they
        function as intended. This includes verifying that only trusted
        applications can run while unauthorized or malicious code is blocked.
        Conduct thorough testing to identify any potential conflicts or
        issues.</p></li><li><p>Monitor and Maintain WDAC: After enabling WDAC,
        it's essential to monitor and maintain the policies regularly. Monitor
        system logs and events to identify any policy violations or potential
        threats. Update and maintain the code integrity policies as needed to
        adapt to changes in your environment.</p></li></ul><p>It's important to
        note that the specific steps and configurations for enabling WDAC may
        vary depending on factors such as your organization's security
        requirements, network infrastructure, and device configuration. It's
        recommended to consult Microsoft's official documentation or seek
        guidance from a qualified IT professional for detailed instructions and
        best practices tailored to your specific environment.</p>
      references:
        - >-
          https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/windows-defender-application-control
      customFields: []
  category: System Security
- cvssv3: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
  priority: 2
  remediationComplexity: 1
  details:
    - locale: EN
      title: Access to System Tools and Settings
      vulnType: Pentest
      description: >-
        <p>System tools on a Windows system refer to built-in utilities and
        applications that provide various functionalities for managing and
        configuring the operating system. These tools are typically designed to
        perform critical system tasks, diagnostics, troubleshooting, system
        configuration, and administration. Some common examples of system tools
        in Windows include Command Prompt (cmd.exe), PowerShell, Task Manager,
        Registry Editor, Event Viewer, Device Manager, and Disk Management,
        among others. Changing settings for things like the system proxy,
        firewall rules and states, network configuration and even installing or
        uninstalling software is referred to as system settings.</p><p>While
        system tools and settings are essential for system administrators and
        power users to effectively manage and maintain the system, granting
        access to these tools to normal users can pose security concerns. Here
        are a few reasons:</p><ul><li><p>Unauthorized System Modifications:
        System tools often have the capability to modify system settings,
        configurations, and critical files. If normal users have access to these
        tools, they may unintentionally or maliciously modify system settings,
        leading to system instability, performance issues, or security
        vulnerabilities.</p></li><li><p>Privilege Escalation: Certain system
        tools can be leveraged to escalate privileges or execute commands with
        elevated permissions. If normal users have access to such tools, they
        may attempt to exploit them to gain unauthorized access or perform
        actions that they should not have privileges
        for.</p></li><li><p>Exposure of Sensitive Information: System tools can
        provide access to sensitive system information, logs, or files that may
        contain confidential data. Allowing normal users to access these tools
        may expose sensitive information or compromise data
        privacy.</p></li><li><p>Malware Execution: Malware often attempts to
        leverage system tools to carry out its malicious activities. Granting
        access to these tools to normal users increases the risk of
        inadvertently executing malware or running malicious
        commands.</p></li></ul><p>To mitigate these security concerns, it is
        generally recommended to restrict access to system tools and settings
        and limit their usage to trusted administrators or privileged accounts.
        User access control, proper permission settings, and implementing the
        principle of least privilege can help minimize the risk associated with
        normal users accessing system tools.</p>
      remediation: >-
        <p>Restrict access to tools that are meant mainly for administrative
        purposes as much as possible.<br>This can be done via GPOs or
        Intune.</p>
      references: []
      customFields: []
  category: System Security
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
  priority: 3
  remediationComplexity: 1
  details:
    - locale: EN
      title: NetBIOS Name Resolution / LLMNR / mDNS Settings
      vulnType: Pentest
      description: >-
        <p>NetBIOS Name Resolution, Link-Local Multicast Name Resolution (LLMNR)
        and Multicast DNS (mDNS) are protocols used for name resolution in
        Windows networks. They allow devices on a local network to discover and
        communicate with each other by resolving computer names to IP
        addresses.</p><p>NetBIOS Name Resolution: NetBIOS (Network Basic
        Input/Output System) is a legacy protocol used for communication between
        devices on a local network. NetBIOS Name Resolution translates NetBIOS
        names (computer names) to IP addresses. It relies on broadcast messages
        to resolve names, which can be inefficient and pose security
        risks.</p><p>LLMNR: LLMNR is a modern replacement for NetBIOS Name
        Resolution introduced in Windows Vista and later versions. It performs a
        similar function as NetBIOS Name Resolution but uses multicast messages
        instead of broadcasts. LLMNR is intended to resolve names on local
        networks when DNS name resolution fails.</p><p>mDNS: mDNS (Multicast
        DNS) is a protocol that allows devices on the same local network to
        resolve hostnames without the need for a centralized DNS server. It is
        part of the <strong>Z</strong>ero-Configuration Networking (Zeroconf)
        suite and is widely used for device and service discovery, especially in
        home networks or small office setups.</p><p>Security Concerns: NetBIOS
        Name Resolution, LLMNR and mDNS can introduce security risks,
        particularly when they are enabled on systems connected to untrusted
        networks or outside the local network.</p><ul><li><p>Man-in-the-Middle
        (MitM) Attacks: When NetBIOS Name Resolution, LLMNR or mDNS are enabled,
        an attacker can intercept and respond to name resolution queries, posing
        as the intended device. This allows them to redirect network traffic to
        their own system, enabling potential eavesdropping, data interception,
        or modification of network communications.</p></li><li><p>Name Spoofing
        and Identity Theft: By responding to name resolution queries, an
        attacker can potentially spoof the identity of legitimate devices on the
        network. This can lead to confusion, unauthorized access, or identity
        theft.</p></li><li><p>Information Disclosure: Name resolution requests
        can leak sensitive information, such as computer names and domain
        information, which can be exploited by an attacker for reconnaissance or
        targeted attacks.</p></li></ul><p>To mitigate these security concerns,
        it is generally recommended to disable NetBIOS Name Resolution, LLMNR
        and mDNS, especially on systems connected to untrusted networks or when
        not required for local network functionality. Instead, relying on more
        secure name resolution mechanisms like DNS (Domain Name System) is
        recommended. Disabling these protocols can help reduce the attack
        surface and protect against potential MitM attacks and other security
        vulnerabilities.</p>
      remediation: >-
        <p>NetBIOS should be disabled on all systems that don't need to be
        compatible with Windows 2000 or older OS. It can be disabled via DHCP or
        GPO.<br></p><img class="custom-image" src="64998d53b1221cb2c209eb7d"
        alt="NetBIOS settings in registry"><p></p><p>You can change all adapters
        to 2 like so:</p><p><code>$regkey =
        "HKLM:SYSTEM\CurrentControlSet\services\NetBT\Parameters\Interfaces"</code><br><code>Get-ChildItem
        $regkey |foreach { Set-ItemProperty -Path "$regkey\$($_.pschildname)"
        -Name NetbiosOptions -Value 2 -Verbose}</code></p><p>The same applies to
        LLMNR. However, it can only be disabled via GPO or a script.</p><img
        class="custom-image" src="64998dceb1221cb2c209eb83" alt="GPO settings to
        disable LLMNR"><p><code>Computer Configuration -&gt; Administrative
        Templates -&gt; Network -&gt; DNS Client -&gt; Turn off multicast name
        resolution</code></p><p><code>set-ItemProperty -Path
        "HKLM:\Software\Policies\Microsoft\Windows NT\DNSClient" -name
        EnableMulticast -Value 0<br>new-ItemProperty -Path
        "HKLM:\Software\Policies\Microsoft\Windows NT\DNSClient" -name
        "EnableMulticast" -Value 0 -Type DWord</code><br><br>mDNS can be
        disabled via the registry as well:<br><code>Set-ItemProperty
        "HKLM:\SYSTEM\CurrentControlSet\Services\Dnscache\Parameters\" -Name
        EnableMDNS -Value 0

        New-ItemProperty
        "HKLM:\SYSTEM\CurrentControlSet\Services\Dnscache\Parameters\" -Name
        EnableMDNS -Value 0 -Type DWord</code></p>
      references:
        - https://luemmelsec.github.io/Relaying-101/
        - >-
          https://woshub.com/how-to-disable-netbios-over-tcpip-and-llmnr-using-gpo/
      customFields: []
  category: System Security
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
  details:
    - locale: EN
      title: SMB Server Settings
      vulnType: Pentest
      description: >-
        <p>SMB (Server Message Block) is a network protocol used for file and
        printer sharing between computers. There are different versions of the
        SMB protocol, including SMB1 (also known as CIFS - Common Internet File
        System), SMB2, SMB2.1, SMB3, and SMB3.02.</p><p>SMB signing is a
        security feature that helps protect against tampering and unauthorized
        access of SMB traffic. When signing is enabled, the SMB server and
        client sign the SMB packets, providing a way to verify the integrity and
        authenticity of the data exchanged between them.</p><p>Here's an
        overview of SMB protocol versions and their support for
        signing:</p><ol><li><p>SMB1 (CIFS): SMB1 supports SMB message signing.
        It provides a basic level of security, but it is considered outdated and
        less secure compared to newer versions.</p></li><li><p>SMB2 and newer:
        Starting from SMB2, the protocol introduced significant improvements in
        terms of performance and security. SMB2 supports stronger encryption
        algorithms and the ability to negotiate signing as a security
        feature.</p></li></ol><ul><li><p>SMB2.1: This version adds support for
        larger buffer sizes and better performance.</p></li><li><p>SMB3: SMB3
        further enhances security and performance. It introduces features like
        encryption and transparent failover for continuous
        availability.</p></li><li><p>SMB3.02: This version adds improvements for
        SMB Direct, which enables high-speed data transfers using RDMA (Remote
        Direct Memory Access).</p></li></ul><p>Not having SMB signing enabled
        can pose security risks, especially in the context of relay attacks. A
        relay attack involves an attacker intercepting and forwarding SMB
        traffic between a client and a server, potentially tampering with or
        impersonating the communication.</p><p>When SMB signing is disabled, an
        attacker can modify SMB packets in transit without detection,
        potentially injecting malicious code or manipulating data. By enabling
        SMB signing, the server and client can verify the integrity and
        authenticity of the SMB traffic, reducing the risk of unauthorized
        modification or tampering.</p><p>Enabling SMB signing helps protect
        against attacks like Man-in-the-Middle (MitM) attacks, where an attacker
        intercepts SMB traffic and manipulates it to gain unauthorized access or
        extract sensitive information. By ensuring that SMB packets are signed,
        the receiving party can verify the origin and integrity of the data,
        making it harder for an attacker to tamper with the
        communication.</p><p>It is recommended to enable SMB signing for
        improved security, particularly in environments where sensitive data is
        being transmitted over SMB connections.</p>
      remediation: >-
        <p>Activate SMB Signing wherever possible.</p><p>This can be done e.g.
        via GPO:</p><p><code>Computer Configuration -&gt; Policies -&gt; Windows
        Settings -&gt; Security Settings -&gt; Local Policies -&gt; Security
        Options -&gt; "Microsoft network server: Digitally sign communications
        (always)"</code></p><p>It's important to test the changes in a
        controlled environment and verify that SMB signing is working as
        expected before applying the GPO to production systems.</p>
      references: []
      customFields: []
  category: System Security
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
  priority: 2
  remediationComplexity: 1
  details:
    - locale: EN
      title: Windows Firewall Settings
      vulnType: Pentest
      description: >-
        <p>The Windows Firewall is a built-in security feature in Windows
        operating systems that helps protect your computer from unauthorized
        network access. It acts as a barrier between your computer and external
        networks, controlling incoming and outgoing network traffic based on
        predefined rules.</p><p>Here are some reasons why the Windows Firewall
        should be turned on:</p><ul><li><p>Network Security: The primary purpose
        of the firewall is to safeguard your computer from malicious network
        activity, such as unauthorized access, hacking attempts, malware, and
        network-based attacks.</p></li><li><p>Blocking Unauthorized Connections:
        The firewall blocks incoming connections that are not explicitly allowed
        by the configured rules. This prevents unauthorized access to your
        computer and helps protect your personal and sensitive
        information.</p></li><li><p>Outbound Traffic Control: The firewall also
        monitors and controls outgoing network traffic. It prevents potentially
        harmful programs or malware from connecting to the internet without your
        knowledge, reducing the risk of data leakage and preventing unauthorized
        communications.</p></li><li><p>Default Protection: Windows Firewall is
        enabled by default on most Windows installations. Keeping it enabled
        ensures that you have a baseline level of protection even if you don't
        have any additional third-party security solutions
        installed.</p></li></ul>
      observation: >-
        <p>Scoring hardly depends on what you found.<br>Disabled Firewall =
        High<br>Enabled Firewall with any-any is the same ^^<br>Enabled firewall
        with bigger security holes might be medium ...</p>
      remediation: >-
        <p>To ensure the effective use of the Windows Firewall, it's important
        to follow these best practices:</p><ul><li><p>Enable the Firewall:
        Always ensure that the Windows Firewall is enabled on your computer to
        provide the first line of defense against unauthorized network
        access.</p></li><li><p>Use Default Firewall Profiles: Windows Firewall
        provides separate profiles for different network locations (Domain,
        Private, Public). Configure the appropriate profile for each network
        connection to apply the necessary rules based on the network's trust
        level.</p></li><li><p>Allow Only Necessary Ports: By default, the
        Windows Firewall blocks all incoming connections. If you need to allow
        specific network services or applications, create custom rules to open
        only the necessary ports in both inbound and outbound directions. This
        reduces the attack surface and minimizes the risk of unwanted
        access.</p></li><li><p>Regularly Update Firewall Rules: Periodically
        review and update your firewall rules to ensure they reflect your
        current network requirements. Remove any unnecessary or obsolete rules
        to maintain an efficient and secure
        configuration.</p></li></ul><p>Overall, enabling and properly
        configuring the Windows Firewall is an essential step in securing your
        computer and protecting it from unauthorized network access and
        potential threats.</p>
      references:
        - >-
          https://learn.microsoft.com/en-us/windows/security/operating-system-security/network-security/windows-firewall/best-practices-configuring
      customFields: []
  category: System Security
- cvssv3: null
  priority: 3
  remediationComplexity: 1
  details:
    - locale: EN
      title: Antivirus Settings
      vulnType: Pentest
      description: >-
        <p>Antivirus (AV) software, also known as antivirus or anti-malware
        software, is designed to protect computers and other devices from
        malicious software, such as viruses, worms, Trojans, spyware, adware,
        and other types of malware. Its primary purpose is to detect, prevent,
        and remove malicious programs that can harm your computer system or
        compromise your data.</p><p>Here are some key reasons why it is
        important to have AV software turned on:</p><ul><li><p>Malware
        Protection: AV software scans files, programs, and websites for known
        malware signatures and behavioral patterns, preventing them from
        infecting your system. It helps safeguard your computer against viruses,
        which can cause data loss, system crashes, or unauthorized
        access.</p></li><li><p>Real-Time Protection: AV software provides
        real-time monitoring of files and activities on your computer, detecting
        and blocking malware threats as they occur. This proactive approach
        helps prevent malware from executing and spreading throughout your
        system.</p></li><li><p>Web Protection: Many AV solutions include web
        protection features that help block access to malicious websites or warn
        you about potentially dangerous sites. This protects you from phishing
        attempts, drive-by downloads, and other web-based
        threats.</p></li><li><p>Email Protection: AV software often integrates
        with email clients to scan incoming and outgoing email attachments for
        malware. It helps prevent the spread of infected files through email and
        reduces the risk of falling victim to email-borne threats, such as
        phishing emails or malicious attachments.</p></li><li><p>Vulnerability
        Detection: Some AV software includes vulnerability scanning features
        that identify security weaknesses in your operating system or installed
        applications. By identifying vulnerabilities, you can take necessary
        steps to patch or update software, minimizing the risk of exploitation
        by malware.</p></li><li><p>Data Protection: AV software helps protect
        your personal and sensitive information by preventing unauthorized
        access or theft. It can detect keyloggers, screen capture tools, and
        other types of spyware that aim to collect your private
        data.</p></li><li><p>System Performance: While AV software performs
        resource-intensive tasks like scanning files and monitoring activities,
        modern solutions are designed to minimize impact on system performance.
        They use optimized scanning algorithms and leverage hardware
        acceleration to ensure efficient protection without significantly
        slowing down your computer.</p></li></ul><p>In summary, having AV
        software turned on is crucial for maintaining a secure and safe
        computing environment. It helps protect your system, data, and privacy
        from various malware threats, ensuring a smoother and more secure
        digital experience.</p>
      observation: >-
        <p>Rating hardly depends on what is setup.<br>Is AV on or not?<br>Many
        exclusions that can be reviewed by anyone? Are they lax?<br>All features
        enabled or are crucial ones missing?</p>
      remediation: >-
        <p>An AV solution should be installed and actively running on each
        system.<br>The product itself as well as its patterns should be kept
        up-to-date at any time.<br>Harden the systems as much as possible by
        making use of all features provided by your AV.<br>Ensure that things
        like tamper protection are enabled and can't be disabled by normal users
        - best also not by administrators.<br>Exclusions should be kept to a
        minimum, where possible individually by system. So you should not
        globally exclude path x or application y, just because you need it on
        one system out of hundreds.<br></p>
      references: []
      customFields: []
  category: System Security
- cvssv3: null
  priority: 3
  remediationComplexity: 2
  details:
    - locale: EN
      title: Proxy Settings
      vulnType: Pentest
      description: >-
        <p>A proxy server acts as an intermediary between a client (such as a
        computer or device) and the internet. When a client requests a resource
        from the internet, the request first goes through the proxy server,
        which then forwards the request on behalf of the client. The proxy
        server can provide various functions, including caching, filtering, and
        anonymizing the client's requests.</p><p>The primary reasons for using a
        proxy server are:</p><ul><li><p>Anonymity and Privacy: By using a proxy
        server, the client's IP address and other identifying information can be
        masked. This helps protect the client's privacy and adds a layer of
        anonymity when accessing websites or online
        services.</p></li><li><p>Caching and Performance: Proxy servers can
        store copies of frequently accessed web resources, allowing subsequent
        requests for the same resource to be fulfilled from the cache. This
        reduces bandwidth usage and improves performance by delivering content
        faster to the client.</p></li><li><p>Content Filtering and Access
        Control: Proxy servers can be configured to filter web content based on
        predefined rules. This allows organizations to enforce access policies,
        block malicious websites, or restrict access to certain categories of
        content, enhancing security and productivity.</p></li></ul><p>Now,
        regarding security issues, not using a proxy server when required or
        recommended can pose several risks:</p><ul><li><p>Data Leaks: Without a
        proxy server, client requests are made directly to the destination
        server, potentially revealing the client's IP address and other
        identifying information. This information can be used for tracking,
        targeting, or profiling the client.</p></li><li><p>Bypassing Security
        Controls: Proxy servers can implement security controls such as
        antivirus scanning, intrusion detection, or content filtering. Not using
        a proxy may bypass these controls, increasing the risk of accessing
        malicious or inappropriate content.</p></li><li><p>Exposure to Malicious
        Content: Proxy servers can provide an additional layer of defense by
        scanning and filtering web content for malware or malicious scripts.
        Without a proxy, clients may be more exposed to such
        threats.</p></li><li><p>Limited Access Management: Proxy servers allow
        organizations to enforce access policies, blocking access to
        unauthorized websites or limiting access to specific resources. Not
        using a proxy can make it challenging to manage and control internet
        access, leading to potential security and compliance
        issues.</p></li></ul><p>In summary, using a proxy server offers benefits
        such as privacy, performance, and security controls. Neglecting to use a
        proxy, when necessary or advised, can compromise privacy, expose clients
        to security risks, and make it challenging to enforce access policies
        and protect against malicious content.</p>
      observation: >-
        <p>Rating depends on what you found.<br>No proxy - bad<br>Proxy but it
        doesn't filter - bad<br>Try to download Malware via HTTP, HTTPS, in a
        ZIP file, in an encrypted ZIP file etc.</p>
      remediation: >-
        <p>Use a proxy, either locally or in a central place.<br>Make sure to
        block malicious web traffic.<br>Inspect secured traffic for malware -
        SSL inspection.</p>
      references: []
      customFields: []
  category: System Security
- cvssv3: null
  priority: 3
  remediationComplexity: 2
  details:
    - locale: EN
      title: Software Lifecycle Management
      vulnType: Pentest
      description: >-
        <p>Used soft- and firmware as well as operating systems should always be
        kept to the most current versions.</p><p>Using outdated versions poses
        several direct and indirect security risks like:<br>- Security
        vulnerabilities: outdated software may have unpatched security holes
        that can be exploited by attackers.<br>- Compatibility issues: new
        hardware or software may not be compatible with old systems.<br>-
        Performance degradation: outdated software may run slower, become less
        responsive, or crash more often.<br>- Lack of features: newer software
        may have additional features or improvements that are not available in
        older versions.<br>- Compliance problems: outdated software may not meet
        industry regulations or standards.<br><br>So staying up to date is a
        mandatory requirement to a matured security culture and should be part
        of the patch management process.</p>
      observation: >-
        <p>Criticality depending on what could be achieved due to systems and
        software being outdated.</p>
      remediation: >-
        <p>Check if any of the mentioned software components can be upgraded /
        updated and if important security updates are missing.<br>Implement a
        patch management strategy and process that ensures that all your systems
        are up to date and that updates are applied timely according to their
        criticality.<br>Apply workarounds when no patches are available when
        tackling critical flaws.</p>
      references: []
      customFields: []
  category: System Security
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
  priority: 2
  remediationComplexity: 1
  details:
    - locale: EN
      title: RDP Settings
      vulnType: Pentest
      description: >-
        <p><br>Remote Desktop Protocol (RDP) is a technology developed by
        Microsoft that allows users to connect to and control a remote computer
        over a network connection. It enables remote access to resources,
        applications, and desktop environments on a remote system.</p><p>RDP can
        be convenient for various purposes, such as remote administration,
        technical support, and remote work scenarios. However, if not properly
        secured, RDP can pose security risks. Some of the potential risks
        include:</p><ul><li><p>Unauthorized access: If RDP is exposed to the
        internet or not adequately protected, it can become a target for
        malicious actors attempting to gain unauthorized access to
        systems.</p></li><li><p>Brute-force attacks: Attackers can launch
        brute-force attacks against RDP sessions, trying various username and
        password combinations to gain access.</p></li><li><p>Vulnerabilities:
        Like any software, RDP implementations can have security vulnerabilities
        that can be exploited by attackers.</p></li></ul><p>Network Level
        Authentication (NLA) is a security feature in RDP that can help mitigate
        some of these risks. NLA requires users to authenticate themselves
        before establishing a remote desktop connection. It adds an extra layer
        of security by verifying the user's credentials before allowing access
        to the remote system. With NLA enabled, the remote system must
        authenticate the user before a full RDP session is initiated, reducing
        the risk of unauthorized access.</p><p>By enabling NLA, potential
        security risks associated with RDP can be mitigated, as it helps ensure
        that only authenticated and authorized users can establish remote
        desktop connections. It is recommended to configure RDP with NLA and
        follow best practices for securing RDP connections, such as using strong
        passwords, enabling network firewalls, keeping the RDP software up to
        date, and restricting access to trusted networks or specific IP
        addresses.</p>
      remediation: >-
        <p>If possible disable RDP completely.<br>If not possible, harden access
        by enforcing NLA. This can be done via GPO or directly via
        registry:<br><code>Computer Configuration -&gt; Administrative Templates
        -&gt; Windows Components -&gt; Remote Desktop Services -&gt; Remote
        Desktop Session Host -&gt; Security -&gt; Require user authentication
        for remote connections by using Network Level
        Authentication</code></p><p><code>Set-ItemProperty -Path
        'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal
        Server\WinStations\RDP-Tcp' -Name 'UserAuthentication' -Value
        1</code><br></p><p>Ensure strong passwords or even better MFA for
        accounts that can login remotely.</p>
      references: []
      customFields: []
  category: System Security
- cvssv3: null
  priority: 2
  remediationComplexity: 1
  details:
    - locale: EN
      title: WinRM Settings
      vulnType: Pentest
      description: >-
        <p>WinRM (Windows Remote Management) is a Microsoft Windows feature that
        allows for remote management and execution of commands on Windows
        systems over a network. It enables administrators to remotely manage
        Windows computers using PowerShell or other remote management
        tools.</p><p>WinRM relies on a client-server model, where the client
        (usually a remote administrator) communicates with the WinRM service
        running on the target system to perform management tasks. This allows
        administrators to remotely configure settings, execute commands,
        retrieve information, and perform other administrative tasks without
        physically accessing the system.</p><p>In terms of security
        implications, WinRM introduces potential risks if not properly
        configured and secured. Some key considerations
        include:</p><ul><li><p>Authentication and Authorization: WinRM should be
        configured to use strong authentication mechanisms, such as Kerberos or
        SSL/TLS, to prevent unauthorized access. Access controls should be
        defined to limit who can connect and what actions they can
        perform.</p></li><li><p>Encryption: Communication between the WinRM
        client and server should be encrypted using SSL/TLS to protect sensitive
        data and prevent eavesdropping or tampering.</p></li><li><p>Firewall
        Configuration: The necessary firewall rules should be in place to allow
        WinRM traffic only from trusted sources and block unauthorized access
        from the network.</p></li><li><p>Credential Management: Proper
        management of credentials used for WinRM authentication is essential.
        Secure storage and handling of credentials are crucial to prevent
        unauthorized access to sensitive information.</p></li><li><p>Regular
        Updates: Keeping the WinRM service and underlying operating system up to
        date with the latest security patches is important to address any
        vulnerabilities that may be discovered over time.</p></li></ul><p>By
        considering and implementing these security measures, WinRM can be used
        effectively while minimizing the potential risks associated with remote
        management capabilities.</p>
      remediation: >-
        <p>Follow the guidelines outlined in the description to harden
        WinRM.<br>If possible disable WinRM completely.</p>
      references:
        - >-
          https://learn.microsoft.com/en-us/powershell/scripting/learn/remoting/winrmsecurity?view=powershell-7.3
      customFields: []
  category: System Security
- cvssv3: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
  priority: 4
  remediationComplexity: 1
  details:
    - locale: EN
      title: Unquoted Service Paths
      vulnType: Pentest
      description: >-
        <p>Windows services normally start executables. The executable path
        allows the OS to find the correct executable to run for each service.
        The following path is an example of a secure service
        path:</p><p><code>"C:\Programs\Test
        Folder\bin\service.exe"</code></p><p>The following path is an example of
        an unsafe service path:</p><p><code>C:\Program Files\Test
        Folder\bin\service.exe</code></p><p>When Windows attempts to read the
        path to this executable, it interprets the space as a kind of terminator
        if the path is not enclosed in <code>"</code>.&nbsp; So it will attempt
        to execute the following (in
        order):</p><p><code>C:\Program.exe</code></p><p><code>C:\Program
        Files\Test.exe</code></p><p><code>C:\Program Files\Test
        Folder\bin\service.exe</code></p><p>If the directories are configured
        with inappropriate permissions, the attacker can place a malicious
        executable file in them. If the service is set to run with
        administrative privileges (e.g. SYSTEM), the attacker can elevate its
        privileges and gain unauthorized administrative access to the system. In
        this case the attacker would want to try to add the first 2 files to the
        filesystem.</p>
      remediation: >-
        <p>The first step would be to ask the vendor of the affected application
        for an updated versions that fixes the misconfiguration.</p><p>A manual
        workaround would be to manually put the binary path into quotes.</p>
      references:
        - >-
          https://www.ired.team/offensive-security/privilege-escalation/unquoted-service-paths
      customFields: []
  category: System Security
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
  priority: 4
  remediationComplexity: 2
  details:
    - locale: EN
      title: 'WSTG-INPV-05: SQL Injection'
      vulnType: Pentest
      description: >-
        <p>SQL injection (SQLi) is a type of attack where an attacker exploits a
        vulnerability in a web application that allows them to execute malicious
        SQL statements. This is typically accomplished by inserting SQL commands
        or fragments of SQL code into input fields or parameters that are sent
        to a web application's database, which can result in unauthorized access
        to data, modification or deletion of data, or even complete takeover of
        the web application.</p><p>For example, an attacker might use SQL
        injection to bypass authentication mechanisms by entering a specially
        crafted input that causes the database to return all user records or
        grant administrative access. They could also modify or delete data by
        injecting SQL code that modifies or deletes database entries, or even
        drop or corrupt the entire database.</p>
      remediation: >-
        <p>The affected parameters should be checked for validity on the server
        side and special characters should be filtered out.</p><p>Ideally,
        prepared statements should be used for the database queries to avoid SQL
        injection vulnerabilities.</p><p></p>
      references:
        - https://owasp.org/www-community/attacks/SQL_Injection
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:L
  priority: 3
  remediationComplexity: 2
  details:
    - locale: EN
      title: 'WSTG-INPV-01: Cross-Site-Scripting in GET-Request'
      vulnType: Pentest
      description: >-
        <p>Input is not sufficiently validated or filtered within the web
        application. This enables an attacker to inject HTML and JavaScript
        code.</p><p>By exploiting this vulnerability, cross-site scripting
        attacks on website visitors are possible. Possible effects of successful
        cross-site scripting attacks include:</p><ul><li><p>Stealing
        credentials, session information, cookies,</p></li><li><p>Complete
        takeover of the client browser, including remote control of the client,
        if exploits exist for the browser used,</p></li><li><p>compromising the
        functionality of the web application,</p></li><li><p>alteration of the
        content and design of the pages.</p></li></ul><p>For example, if a user
        opens a crafted link, the attacker is able to manipulate the web page
        content and include a link to third-party malware to infect attacked
        clients.</p>
      observation: <p>THIS IS MY POC</p>
      remediation: >-
        <p>It is generally recommended checking all parameters transmitted by
        the client for validity and establishing appropriate filters for
        unauthorized characters, or encoding malicious characters in the output.
        This includes verifying that input is of the correct type and length,
        and that it does not contain any potentially malicious characters or
        code. <br>A check via JavaScript on the client side is not sufficient,
        since this can also be manipulated by the client.</p><p>Output encoding
        can further help to harden against XSS attacks. All data that is output
        to a web page should be encoded using the appropriate encoding method,
        such as HTML encoding, to prevent it from being interpreted as
        executable code by the browser.</p><p>Using known vulnerable software
        should be avoided where possible.</p>
      references: []
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N
  priority: 2
  remediationComplexity: 1
  details:
    - locale: EN
      title: 'WSTG-CONF-07: HSTS-Header not set'
      vulnType: Pentest
      description: >-
        <p>HSTS stands for HTTP Strict Transport Security. It is a security
        feature that is implemented using an HTTP response header that instructs
        web browsers to only connect to a website using HTTPS (HTTP over
        SSL/TLS) protocol, even if the user types "http" in the URL
        bar.</p><p>The HSTS header helps prevent "Man-in-the-Middle" (MITM)
        attacks where an attacker could intercept the user's connection to the
        website and redirect them to a fake website where they could steal
        sensitive information like login credentials, credit card details,
        etc.</p><p>When a website sends the HSTS header to the browser, it
        instructs the browser to remember that the website should always be
        accessed via HTTPS for a specified period of time (usually for several
        months). Once the browser has received this instruction, it will
        automatically upgrade any HTTP requests to HTTPS requests for that
        website, even if the user types "http" in the URL bar.</p><p>HSTS is an
        important security feature for websites, and it is recommended to
        implement it along with other security features such as SSL/TLS
        encryption, proper certificate management, and secure authentication
        methods.</p>
      remediation: >-
        <p>It is recommended to set the HTTP Strict-Transport-Security
        header.</p>
      references:
        - >-
          https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Strict_Transport_Security_Cheat_Sheet.html
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N
  priority: 1
  remediationComplexity: 1
  details:
    - locale: EN
      title: 'WSTG-INFO-02: Revealed Webserver Technology'
      vulnType: Pentest
      description: >-
        <p>Knowing the technology of a webserver can aid an attacker to
        determine how more targeted attacks can be conducted.<br>Webservers
        often times reveal the technology they are running on in response
        headers, even including concrete version numbers.<br>Attackers can then
        check if the version is affected by some kind of vulnerability and try
        to abuse it.</p><p></p>
      remediation: >-
        <p>It is recommened to publish as little information as possible about
        installed version statuses and reconfiguring the header information
        accordingly.</p>
      references: []
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  priority: 4
  remediationComplexity: 1
  details:
    - locale: EN
      title: 'WSTG-CONF-09: Unauthenticated File Access'
      vulnType: Pentest
      description: >-
        <p>File permissions are meant to restrict access to data so that only
        people that need access to it are allowed to.</p><p>Unrestricted file
        access poses a significant security risk due to the following
        reasons:</p><ul><li><p>Unauthorized Access: Unrestricted file access
        means that anyone, including malicious actors, can view, modify, or
        delete sensitive files. It allows unauthorized individuals or attackers
        to gain access to confidential information, personal data, intellectual
        property, or system files.</p></li><li><p>Data Leakage: Unrestricted
        file access increases the risk of data leakage. Sensitive or
        confidential information may be inadvertently or deliberately shared
        with unauthorized parties. This can lead to financial losses,
        reputational damage, compliance violations, or legal
        consequences.</p></li><li><p>Malware Injection: Malicious actors can
        exploit unrestricted file access to inject malware into the system. By
        accessing and modifying critical files, they can introduce malicious
        code, viruses, or ransomware that can compromise the integrity and
        functionality of the system.</p></li><li><p>Unauthorized Modifications:
        Unrestricted file access allows unauthorized users to modify or tamper
        with files. This can result in unauthorized changes to system
        configurations, application settings, or critical data, leading to
        system instability, operational disruptions, or compromised
        functionality.</p></li><li><p>Privilege Escalation: Unrestricted file
        access can enable privilege escalation attacks. If an attacker gains
        access to certain files with elevated privileges, they can exploit
        vulnerabilities or weak security controls to escalate their privileges,
        gaining unauthorized administrative access to the system or sensitive
        resources.</p></li><li><p>Insider Threats: Unrestricted file access
        increases the risk of insider threats. Employees or insiders with
        legitimate access to files may misuse their privileges, intentionally or
        unintentionally, by leaking sensitive information, modifying critical
        files, or stealing valuable data.</p></li><li><p>Compliance Violations:
        Unrestricted file access may lead to non-compliance with industry
        regulations and data protection standards. Many regulatory frameworks,
        such as the General Data Protection Regulation (GDPR), require
        organizations to implement appropriate access controls and restrictions
        to protect personal data and ensure privacy.</p></li></ul><p>To mitigate
        these risks, it is essential to implement strong access controls, file
        permissions, and security measures. Access should be restricted to
        authorized individuals based on the principle of least privilege, where
        users only have access to the files necessary for their roles and
        responsibilities. Regular monitoring, auditing, and encryption of
        sensitive files can further enhance security.</p>
      remediation: >-
        <p>Restrict access to the files according to the principle of least
        privileges.<br>It is already done at several places inside the
        application, so should be adopted accordingly.</p>
      references:
        - https://owasp.org/www-community/Broken_Access_Control
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:L/A:N
  priority: 3
  remediationComplexity: 1
  details:
    - locale: EN
      title: 'WSTG-ATHN-01: Unencrypted Login via HTTP'
      vulnType: Pentest
      description: >-
        <p>Credentials, such as usernames and passwords, are sensitive
        information that should be protected from unauthorized access or
        interception. Transporting them over encrypted channels helps to ensure
        their confidentiality, integrity, and authenticity.</p><p>Encryption is
        a process of converting plaintext into ciphertext using an encryption
        algorithm and a secret key. The resulting ciphertext can only be
        decrypted back into plaintext using the same key. This ensures that only
        authorized parties with access to the key can read the contents of the
        message.</p><p>When credentials are transported over an encrypted
        channel, such as HTTPS, the data is protected from interception and
        tampering. This is because the encryption process makes it difficult for
        attackers to read or modify the contents of the message. It also
        provides assurance that the sender is who they claim to be, and that the
        message has not been altered in transit.</p><p>Without encryption,
        credentials can be easily intercepted by attackers who have access to
        the communication channel, such as through packet sniffing or
        man-in-the-middle attacks. This can lead to unauthorized access to
        sensitive data, such as personal information, financial data, or
        intellectual property.</p><p>In summary, transporting credentials over
        encrypted channels is essential to protect them from interception and
        ensure their confidentiality, integrity, and authenticity.</p>
      observation: >-
        <p>The application can be accessed over HTTP as well as HTTPS.<br>As
        there are no HSTS headers set (refer to chapter XYZ), the user can
        freely decide if to use the encrypted or unencrypted version.<br>In the
        case of the latter one, the credentials are transported unencrypted and
        as such easily to retrieve in Man-in-the-Middle attacks.</p>
      remediation: >-
        <p>Only use secured protocols and services to run applications.<br>In
        this case turn of the possibility to use the unencrypted HTTP version of
        the webapplication.</p>
      references:
        - >-
          https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/09-Testing_for_Weak_Cryptography/03-Testing_for_Sensitive_Information_Sent_via_Unencrypted_Channels
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:L/A:N
  priority: 2
  remediationComplexity: 2
  details:
    - locale: EN
      title: 'WSTG-ATHN-03: Missing Brute-Force Protection'
      vulnType: Pentest
      description: >-
        <p>Brute-force protection is a mechanism used to prevent attackers from
        guessing a user's login credentials through a trial-and-error process
        known as a brute-force attack. In this type of attack, an attacker tries
        multiple combinations of usernames and passwords until they find the
        correct one, allowing them to gain unauthorized access to the
        system.</p><p>To prevent brute-force attacks, login functionality may
        include various brute-force protection measures. One common method is to
        limit the number of login attempts within a specified time frame. For
        example, after three failed login attempts, the system may lock the
        account or impose a time delay before allowing additional login
        attempts. This prevents an attacker from trying an unlimited number of
        combinations in a short period.</p><p>Another method of brute-force
        protection is to implement a CAPTCHA (Completely Automated Public Turing
        test to tell Computers and Humans Apart) system, which requires the user
        to enter a visual or audio challenge-response test that only humans can
        solve. This helps to prevent automated bots from attempting multiple
        login attempts in quick succession.</p><p>In summary, brute-force
        protection is used to prevent attackers from guessing a user's login
        credentials through a trial-and-error process. This is typically
        achieved by limiting the number of login attempts within a specified
        time frame, or by implementing a CAPTCHA system to prevent automated
        attacks. These measures help to improve the security of login
        functionality and protect user accounts from unauthorized access.</p>
      remediation: >-
        <p>Implement countermeasures like timeouts, lockout policies and
        captchas.</p>
      references:
        - https://owasp.org/www-community/attacks/Brute_force_attack
        - >-
          https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/04-Authentication_Testing/03-Testing_for_Weak_Lock_Out_Mechanism
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N
  priority: 2
  remediationComplexity: 2
  details:
    - locale: EN
      title: 'WSTG-ATHN-03: Weak Lockout Policy'
      vulnType: Pentest
      description: >-
        <p>A lockout policy is a security mechanism used to prevent unauthorized
        access to an account by locking the account after a certain number of
        failed login attempts. This is done to prevent brute-force attacks, in
        which an attacker tries to guess a user's login credentials by
        repeatedly submitting different username and password
        combinations.</p><p>The lockout policy typically includes the number of
        failed login attempts that trigger the account lockout, as well as the
        duration of the lockout period. For example, a lockout policy might
        specify that after five failed login attempts, the account will be
        locked for 30 minutes.</p><p>Lockout policies help to improve the
        security of user accounts by preventing attackers from gaining
        unauthorized access through brute-force attacks. They also encourage
        users to create strong passwords and take other security measures to
        protect their accounts, as they know that repeated failed login attempts
        could lead to a lockout.</p><p>However, lockout policies can also have
        drawbacks if they are set too strictly. For example, if the number of
        failed login attempts is set too low, users may accidentally trigger the
        lockout policy by mistyping their password or forgetting their password
        and attempting to reset it. Additionally, if the lockout period is too
        long, it can be frustrating for users who need to access their account
        urgently. As such, lockout policies should be carefully designed and
        tested to balance security needs with user experience.</p>
      remediation: >-
        <p>Implement according policies that lockout accounts after a predefined
        amount of failed attempts.</p>
      references:
        - >-
          https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html
        - >-
          https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/04-Authentication_Testing/03-Testing_for_Weak_Lock_Out_Mechanism
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N
  priority: 3
  remediationComplexity: 1
  details:
    - locale: EN
      title: 'WSTG-ATHN-07: Weak Password Policy'
      vulnType: Pentest
      description: >-
        <p>A password policy is a set of rules and guidelines that dictate the
        requirements for creating and using passwords in a system. The primary
        purpose of a password policy is to improve the security of user accounts
        by ensuring that passwords are strong, unique, and not easily
        guessable.</p><p>Password policies may include requirements such as
        minimum length, complexity, and expiration period. For example, a
        password policy might require that passwords be at least 8 characters
        long, contain a combination of letters, numbers, and symbols, and expire
        every 90 days. The policy may also prohibit the use of common passwords
        or dictionary words, and may enforce a limit on the number of failed
        login attempts before locking the account.</p><p>Password policies are
        important because weak passwords are a common vulnerability that can be
        easily exploited by attackers. By requiring strong passwords and
        enforcing regular password changes, password policies can help to
        prevent unauthorized access and data breaches.</p><p>However, password
        policies can also have drawbacks if they are too strict or complicated.
        For example, if the requirements for password complexity are too
        difficult to remember, users may resort to writing down their passwords
        or reusing the same password across multiple accounts, which can also
        pose security risks. As such, password policies should be carefully
        designed to balance security needs with user experience and
        convenience.</p>
      remediation: >-
        <p>Implement a strong password policy that hinders users to set weak
        passwords.</p><p>Best practices include:<br></p><ul><li><p>Length:
        Encourage the use of longer passwords, typically a minimum of 12
        characters or more. Longer passwords are generally more secure as they
        increase the number of possible combinations, making them harder to
        guess or crack.</p></li><li><p>Complexity: Require a combination of
        uppercase and lowercase letters, numbers, and special characters. This
        ensures a broader range of characters are used, making passwords more
        resistant to dictionary-based attacks.</p></li><li><p>Avoid common
        patterns and predictable information: Discourage the use of easily
        guessable patterns (e.g., "123456" or "abcdef") and information commonly
        associated with users (e.g., names, birthdates, or common words). These
        can be easily exploited by attackers.</p></li><li><p>Avoid forced
        regular password changes: Research suggests that frequent password
        changes may lead to weaker passwords, as users tend to choose simpler
        passwords when forced to change them frequently. Instead, encourage
        password changes when there is a suspected compromise or evidence of
        weak security.</p></li><li><p>Password blacklisting: Maintain a list of
        commonly used or compromised passwords and prevent users from selecting
        them. This helps to block the use of easily guessable or breached
        passwords.</p></li><li><p>Two-factor authentication (2FA): Encourage or
        require the use of additional authentication factors, such as SMS codes,
        authenticator apps, or hardware tokens, to add an extra layer of
        security to user accounts. This helps protect against unauthorized
        access even if the password is compromised.</p></li><li><p>User
        education and awareness: Provide clear guidelines to users on how to
        create strong passwords and the importance of good password hygiene.
        Educate users about the risks of password reuse, phishing attacks, and
        the significance of protecting their accounts.</p></li></ul><p>All
        checks should be done server-side and not allow for bypasses like
        manipulating client-side validations (such as JavaScript
        checks).</p><p>Remember that password complexity policies should be
        balanced to ensure they are strong enough to resist attacks but not
        overly burdensome for users. Striking the right balance promotes better
        security practices and user compliance.<br></p>
      references:
        - >-
          https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html
        - >-
          https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/04-Authentication_Testing/07-Testing_for_Weak_Password_Policy
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
  priority: 4
  remediationComplexity: 3
  details:
    - locale: EN
      title: 'WSTG-ATHZ-03: Elevation of Privileges'
      vulnType: Pentest
      description: >-
        <p>Privilege escalation refers to the act of gaining increased access or
        permissions on a computer system, network, or application beyond what
        was originally authorized. This can be achieved through exploiting
        vulnerabilities, misconfigurations, or weaknesses in security
        controls.</p><p>Privilege escalation is generally considered a bad thing
        because it can lead to unauthorized access and control over sensitive
        information, systems, and resources. Attackers can use privilege
        escalation to perform malicious activities such as stealing data,
        modifying data, installing malware, or disrupting
        services.</p><p>Privilege escalation can also undermine the integrity
        and confidentiality of data, as well as violate privacy laws and
        regulations. It can lead to financial losses, reputational damage, and
        legal consequences for both individuals and organizations.</p><p>In
        summary, privilege escalation is a bad thing because it can lead to
        unauthorized access and control, which can result in serious security
        and privacy breaches.</p>
      remediation: >-
        <p>The separation of user rights should not only take place on the GUI
        level. Functions and endpoints meant for administrative purposes should
        only be available to users that are assigned to the according
        groups.</p><p></p>
      references: []
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:N
  priority: 2
  remediationComplexity: 1
  details:
    - locale: EN
      title: 'WSTG-SESS-02: Session-Cookie without httpOnly-Flag'
      vulnType: Pentest
      description: >-
        <p>The httpOnly flag is an optional parameter for cookies and specifies
        that cookies secured with this flag may not be read via client-side
        scripts.</p><p>In the context of cross-site scripting attacks, for
        example, attempts are often made to take over a user's session by
        reading the cookie via JavaScript. This attack vector is prevented by
        setting the httpOnly flag.</p>
      remediation: <p>Set the <em>httpOnly </em>flag for all session relevant cookies.</p>
      references:
        - >-
          https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/06-Session_Management_Testing/02-Testing_for_Cookies_Attributes
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N
  priority: 4
  remediationComplexity: 2
  details:
    - locale: EN
      title: 'WSTG-SESS-05: Cross Site Request Forgery (CSRF)'
      vulnType: Pentest
      description: >-
        <p>Cross-site request forgery (CSRF or XSRF) is a type of attack where a
        malicious actor tricks a user into performing an action on a website
        without their knowledge or consent. This is achieved by sending a
        request from a user's browser that appears to originate from a
        legitimate website that the user is logged into, but is actually sent by
        the attacker. <br>The purpose of a CSRF attack is to exploit the trust
        that a website has in a user's browser, allowing the attacker to perform
        actions on the user's behalf, such as making unauthorized purchases or
        changing account settings.</p>
      remediation: >-
        <p>To protect against CSRF attacks, websites can implement
        countermeasures such as using CSRF tokens or requiring user confirmation
        for sensitive actions.<br>The tokens should be set for all critical
        functions.<br>Use secured cookies that store the CSRF tokens.<br>Make
        sure that CSRF token are actually evaluated.<br>CSRF tokens are meant to
        change for every request. Fixed tokens are a security concern. Make sure
        to change the tokens for every request.</p>
      references:
        - >-
          https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/06-Session_Management_Testing/05-Testing_for_Cross_Site_Request_Forgery
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:L
  priority: 3
  remediationComplexity: 2
  details:
    - locale: EN
      title: 'WSTG-INPV-01: Reflected Cross-Site-Scripting'
      vulnType: Pentest
      description: >-
        <p>Input is not sufficiently validated or filtered within the web
        application. This enables an attacker to inject HTML and JavaScript
        code.</p><p>By exploiting this vulnerability, cross-site scripting
        attacks on website visitors are possible. Possible effects of successful
        cross-site scripting attacks include:</p><ul><li><p>Stealing
        credentials, session information, cookies,</p></li><li><p>Complete
        takeover of the client browser, including remote control of the client,
        if exploits exist for the browser used,</p></li><li><p>compromising the
        functionality of the web application,</p></li><li><p>alteration of the
        content and design of the pages.</p></li></ul><p>In the case of
        reflected XSS the attacker needs the victim to execute the code, e.g. by
        sending him a malicious link he needs to click.</p>
      remediation: >-
        <p>It is generally recommended checking all parameters transmitted by
        the client for validity and establishing appropriate filters for
        unauthorized characters, or encoding malicious characters in the output.
        This includes verifying that input is of the correct type and length,
        and that it does not contain any potentially malicious characters or
        code. <br>A check via JavaScript on the client side is not sufficient,
        since this can also be manipulated by the client.</p><p>Output encoding
        can further help to harden against XSS attacks. All data that is output
        to a web page should be encoded using the appropriate encoding method,
        such as HTML encoding, to prevent it from being interpreted as
        executable code by the browser.</p><p>Using known vulnerable software
        should be avoided where possible.</p>
      references:
        - >-
          https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/07-Input_Validation_Testing/01-Testing_for_Reflected_Cross_Site_Scripting
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:L
  priority: 4
  remediationComplexity: 2
  details:
    - locale: EN
      title: 'WSTG-INPV-02: Stored Cross-Site-Scripting'
      vulnType: Pentest
      description: >-
        <p>Input is not sufficiently validated or filtered within the web
        application. This enables an attacker to inject HTML and JavaScript
        code.</p><p>By exploiting this vulnerability, cross-site scripting
        attacks on website visitors are possible. Possible effects of successful
        cross-site scripting attacks include:</p><ul><li><p>Stealing
        credentials, session information, cookies,</p></li><li><p>Complete
        takeover of the client browser, including remote control of the client,
        if exploits exist for the browser used,</p></li><li><p>compromising the
        functionality of the web application,</p></li><li><p>alteration of the
        content and design of the pages.</p></li></ul><p>In the case of stored
        XSS the attacker is able to place the malicious code inside the
        application. He then needs to wait for his victims to trigger the code
        e.g. by using a specific function inside the application.</p>
      remediation: >-
        <p>It is generally recommended checking all parameters transmitted by
        the client for validity and establishing appropriate filters for
        unauthorized characters, or encoding malicious characters in the output.
        This includes verifying that input is of the correct type and length,
        and that it does not contain any potentially malicious characters or
        code. <br>A check via JavaScript on the client side is not sufficient,
        since this can also be manipulated by the client.</p><p>Output encoding
        can further help to harden against XSS attacks. All data that is output
        to a web page should be encoded using the appropriate encoding method,
        such as HTML encoding, to prevent it from being interpreted as
        executable code by the browser.</p><p>Using known vulnerable software
        should be avoided where possible.</p>
      references:
        - >-
          https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/02-Testing_for_Stored_Cross_Site_Scripting
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
  priority: 2
  remediationComplexity: 2
  details:
    - locale: EN
      title: 'WSTG-CRYP-01: Weak TLS Configuration'
      vulnType: Pentest
      description: >-
        <p>Transport Layer Security (TLS) is a cryptographic protocol that
        provides secure communication over a network by encrypting data sent
        between two devices. TLS is commonly used to secure HTTP connections,
        which are used to transfer data between web servers and clients, and is
        often referred to as HTTPS.</p><p>TLS works by creating a secure
        communication channel between two devices, using a combination of public
        key encryption and symmetric key encryption. During the initial
        connection, the client and server exchange cryptographic keys to
        establish a secure session. The keys are then used to encrypt and
        decrypt data sent between the two devices.</p><p>While Transport Layer
        Security (TLS) is a widely used and effective protocol for securing
        communication over a network, it is not without weaknesses. Some of the
        weaknesses of TLS include:</p><ul><li><p>Weak cipher suites: Some older
        cipher suites used in TLS are now considered weak and vulnerable to
        attacks, such as the infamous POODLE attack. It is important to use
        strong cipher suites and disable any deprecated or insecure cipher
        suites.</p></li><li><p>Certificate authority (CA) vulnerabilities: The
        trust model of TLS relies on the security of the CA system, which can be
        vulnerable to attacks such as phishing or compromise of CAs. This can
        result in fake or fraudulent certificates being issued, which can then
        be used to perform man-in-the-middle
        attacks.</p></li><li><p>Implementation flaws: TLS implementations can
        contain flaws that could be exploited by attackers, such as the
        Heartbleed vulnerability, which allowed attackers to steal sensitive
        information from servers using a specific version of the OpenSSL
        cryptographic library.</p></li><li><p>Key management: TLS relies on
        secure key management practices to ensure the integrity and
        confidentiality of data in transit. If keys are compromised or not
        managed properly, it can result in the encryption being broken and
        sensitive information being exposed.</p></li><li><p>Attacks against the
        protocol itself: New attacks against the TLS protocol are regularly
        discovered and may require updates or changes to the protocol to address
        them.</p></li></ul><p>It is important to stay up to date with the latest
        best practices for using TLS, including using strong cipher suites,
        implementing proper certificate validation, and regularly updating TLS
        implementations to address new vulnerabilities.</p>
      remediation: >-
        <p>Disable SSLv3.<br>Update the Webserver and SSL implementation to the
        latest version.<br>Disable weak ciphers (SEED, IDEA, RC2, RC4,...) on
        the server.<br>Configure the server to use a 2048-bit Diffie-Hellman
        group.<br>Disable cipher with 64-bit block size (3DES, DES,
        Blowfish).<br>Disable HTTP compression on the server or ignored if there
        is no secret in the page.<br>Disable 3DES ciphers on the server.<br>Only
        use TLS1.2 and upwards.</p>
      references:
        - >-
          https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/09-Testing_for_Weak_Cryptography/01-Testing_for_Weak_Transport_Layer_Security
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:L
  priority: 4
  remediationComplexity: 1
  details:
    - locale: EN
      title: 'WSTG-BUSL-09: Upload of Malicious Files'
      vulnType: Pentest
      description: >-
        <p>Allowing users to upload files to a web server can pose significant
        risks, as it can provide an opportunity for attackers to upload and
        execute malicious code on the server. Some of the risks of allowing file
        uploads include:</p><ul><li><p>Malware distribution: Attackers can use
        file uploads to distribute malware, such as viruses, worms, or Trojans,
        to other users who download the infected files.</p></li><li><p>Website
        defacement: Attackers can upload malicious files that can deface the
        website, altering its appearance and possibly damaging its
        reputation.</p></li><li><p>Server compromise: Attackers can use file
        uploads to gain access to the server and execute remote code, allowing
        them to take full control of the system and potentially steal sensitive
        information.</p></li><li><p>Backdoor access: Attackers can use file
        uploads to create a backdoor on the server, allowing them to access the
        system even after they are removed.</p></li><li><p>Resource exhaustion:
        Attackers can upload files that consume a large amount of server
        resources, such as disk space or memory, causing the server to crash or
        become unavailable.</p></li></ul>
      remediation: >-
        <p>It is recommended performing a server-side check of the file
        extensions as well as the file type. However, checking the file
        extension itself is not a sufficient protection and in addition the
        magic bytes of the files uploaded should be checked.</p><p>Furthermore,
        uploaded files should be checked for malware using antivirus software.
        Possible embedded objects should be removed. Among other things,
        Microsoft Office documents, PDF files and images can contain embedded
        objects, which are not always detected by antivirus programs. These can
        be converted to safe files using file disinfection (for example, PDF to
        PDFA). Further recommendations can be found in the OWASP Guideline.</p>
      references:
        - >-
          https://cheatsheetseries.owasp.org/cheatsheets/File_Upload_Cheat_Sheet.html
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
  priority: 3
  remediationComplexity: 1
  details:
    - locale: EN
      title: 'WSTG-BUSL-07: Application Logic Flaw - Passwords length visible'
      vulnType: Pentest
      description: >-
        <p>Hiding passwords in applications in general is a good idea. Access to
        such sensitive info should be restricted as good as possible and
        revealing should ask you for confirmation. The length of the hiding
        characters should always be the same so that no conclusions can be drawn
        on the length of the password.</p>
      remediation: >-
        <p>Mask the password in a way that no conclusions regarding the length
        can be drawn.</p>
      references: []
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:L/A:N
  priority: 2
  remediationComplexity: 3
  details:
    - locale: EN
      title: 'WSTG-SESS-03: Session Fixation'
      vulnType: Pentest
      description: >-
        <p>Session fixation is a vulnerability that allows an attacker to hijack
        a user's session on a web application. This type of attack involves
        manipulating the session ID (identifier) used to authenticate a user's
        session.</p><p>Session fixation occurs when an attacker can force a user
        to use a specific session ID, and when that user logs in, the session
        remains active with the same ID. This allows the attacker, who already
        knows the session ID, to impersonate the victim.</p><p>To prevent
        session fixation, web applications should ensure that a new session ID
        is generated for each user upon login, rather than accepting a
        pre-existing session ID. Additionally, the session ID should be
        regenerated upon certain events such as a change in user privilege or
        login status. This helps to ensure that the session ID cannot be fixed
        and is therefore more secure.</p>
      remediation: >-
        <p>To protect against session fixation, there are several best practices
        that web applications should follow:</p><ol><li><p>Regenerate Session
        IDs: Upon login, web applications should generate a new session ID for
        each user. This ensures that the session ID cannot be predetermined or
        fixed by an attacker. Additionally, the session ID should be regenerated
        upon certain events such as a change in user privilege or login
        status.</p></li><li><p>Use Strong Session IDs: Session IDs should be
        long, random, and complex. This makes them difficult for an attacker to
        guess or brute-force.</p></li><li><p>Use HTTPS: Web applications should
        use HTTPS to encrypt all communication between the client and server.
        This helps to prevent session hijacking and other types of attacks that
        can compromise the user's session.</p></li><li><p>Use HttpOnly and
        Secure Cookies: HttpOnly cookies cannot be accessed by client-side
        scripts, which helps to prevent cross-site scripting (XSS) attacks.
        Secure cookies can only be transmitted over HTTPS, which helps to
        prevent the interception of session IDs over unsecured
        connections.</p></li><li><p>Implement Session Timeout: Web applications
        should implement a session timeout to automatically log out users after
        a period of inactivity. This reduces the risk of session hijacking if
        the user leaves their session open on a public computer or if their
        device is lost or stolen.</p></li></ol><p>For ASP applications the OWASP
        foundation has some additional recommnedations on how this situation
        could be
        tackled:<br>https://owasp.org/www-community/controls/Session_Fixation_Protection</p>
      references:
        - https://owasp.org/www-community/attacks/Session_fixation
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:L/A:N
  priority: 3
  remediationComplexity: 1
  details:
    - locale: EN
      title: 'WSTG-SESS-01: Session-Token in URL'
      vulnType: Pentest
      description: >-
        <p>Session tokens are used to identify and authenticate a user's session
        on a website or application. They need to be secured to prevent
        unauthorized access to a user's account and sensitive information, such
        as personal data or financial information. If a session token is
        compromised, an attacker could hijack a user's session and gain access
        to their account, potentially causing significant harm to the user and
        the organization.</p><p>When session tokens are sent as part of the URL,
        they appear in the user's browser history and in log files on web
        servers or proxies. A compromise of the user's client might allow an
        attacker to get access to the session token via the history and take
        over the session if it has not already been invalidated.
        <br>Administrators may have access the session tokens of all users via
        the logs of proxies or web servers. <br>A compromised web server would
        allow an attacker to access all sessions or accounts.</p>
      remediation: >-
        <p>Session tokens should not be send as part of the URL. <br>Using HTTP
        cookies or hidden fields in forms submitted with POST parameters should
        be used as a safe way of transmitting session tokens. This measure
        ensures that the session tokens are not visible in the browser history
        or in log files.</p>
      references:
        - >-
          https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/06-Session_Management_Testing/01-Testing_for_Session_Management_Schema
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
  priority: 2
  remediationComplexity: 1
  details:
    - locale: EN
      title: 'WSTG-IDNT-04: User Enumeration'
      vulnType: Pentest
      description: >-
        <p>User enumeration is a technique used by attackers to discover valid
        usernames or email addresses associated with user accounts in a web
        application. This is typically done by submitting login requests with
        various usernames or email addresses and observing the response from the
        server.</p><p>The response from the server can indicate whether a
        username or email address is valid or not. For example, if an attacker
        submits a login request with an invalid username, the server may respond
        with a message indicating that the username is incorrect. On the other
        hand, if the attacker submits a login request with a valid username, the
        server may respond with a message indicating that the password is
        incorrect. By using this technique, attackers can gradually build a list
        of valid usernames or email addresses that can be used in further
        attacks, such as password guessing or targeted phishing
        attacks.</p><p>User enumeration is dangerous because it provides
        attackers with a list of valid usernames or email addresses that can be
        used to launch more targeted attacks against the web application or its
        users. For example, if an attacker knows that a particular email address
        is associated with a user account on the web application, they can
        launch a phishing attack that appears to come from the web application
        and requests the user to reset their password, giving the attacker
        access to the user's account.</p><p>Furthermore, user enumeration can
        also help attackers understand the structure of the web application and
        identify potential vulnerabilities. For instance, if the server responds
        differently to invalid and valid usernames, this may indicate that the
        application is vulnerable to a timing attack, where an attacker can use
        timing differences to determine valid usernames or
        passwords.</p><p>Overall, user enumeration is a dangerous vulnerability
        in web applications that can be exploited by attackers to launch
        targeted attacks and gain unauthorized access to sensitive data. It is
        important for web application developers to implement measures to
        prevent user enumeration, such as returning the same error message for
        all login failures or using CAPTCHA to prevent automated login
        attempts.</p>
      remediation: >-
        <p>Generate unspecific error messages that do not allow an attacker to
        draw conclusions if a user exists or not.</p>
      references: []
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:P/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
  priority: 2
  remediationComplexity: 1
  details:
    - locale: EN
      title: 'WSTG-ATHN-06: Browser Cache holding Sensitive Data'
      vulnType: Pentest
      description: >-
        <p>Browser Cache Weaknesses refer to vulnerabilities in web applications
        that allow sensitive information, such as personal data, authentication
        tokens, or other confidential information, to be stored in the cache of
        the user's web browser. This information can remain in the cache even
        after the user logs out of the web application or closes the browser,
        and can be accessible to attackers who gain access to the user's
        computer or device.</p><p>These weaknesses are dangerous because they
        can enable attackers to obtain sensitive information without needing to
        directly attack the web application itself. Instead, attackers can
        exploit the weakness by accessing the user's cache, either through
        physical access to the user's device or by using malware or other
        techniques to gain remote access.</p><p>Once an attacker gains access to
        the cached information, they can use it for a variety of malicious
        purposes, such as identity theft, fraud, or unauthorized access to the
        web application or other systems that use the same authentication
        tokens.</p><p>To mitigate Browser Cache Weaknesses, developers should
        implement appropriate measures, such as using HTTPS connections, setting
        proper caching headers, and implementing mechanisms to clear the cache
        of sensitive information when the user logs out or closes the browser.
        Additionally, users should be educated on the risks of cached
        information and advised to clear their browser cache regularly.</p>
      observation: <p></p><p></p>
      remediation: >-
        <p>Implement a strict control of the browser's cache for sensitive data
        by using the Cache-Control headers.<br>More info can be found here:
        https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#web-content-caching</p>
      references:
        - >-
          https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/04-Authentication_Testing/06-Testing_for_Browser_Cache_Weaknesses
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:N/A:N
  priority: 2
  remediationComplexity: 1
  details:
    - locale: EN
      title: 'WSTG-APIT-01: Exposed GraphQL Playground'
      vulnType: Pentest
      description: >-
        <p>GraphQL Playground is a graphical user interface (GUI) that is used
        to test, explore, and interact with GraphQL APIs. It provides an
        interactive environment that allows developers to query a GraphQL API,
        see the schema, and test various queries and mutations.</p><p>GraphQL
        Playground is a useful tool for both frontend and backend developers, as
        it enables them to easily test and iterate on their GraphQL API without
        having to manually construct requests and parse responses. With GraphQL
        Playground, developers can quickly test out new queries and mutations,
        see the results in real-time, and experiment with different parameters
        and inputs.</p><p>Additionally, GraphQL Playground provides a variety of
        features that make working with GraphQL APIs easier, such as syntax
        highlighting, autocomplete, and documentation. It can also be used to
        view the GraphQL schema, explore the available types, and understand the
        structure of the API.</p><p>Overall, GraphQL Playground is a powerful
        tool that simplifies the process of developing and testing GraphQL APIs,
        and makes it easier for developers to build high-quality
        applications.<br><br>From an attacker's perspective all this info can
        come in useful, leaving them with a documentation what and how things
        are working.</p>
      remediation: >-
        <p>Restrict access to the GrapQL Playground, so only authorized users or
        systems can access it.</p>
      references:
        - >-
          https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/12-API_Testing/01-Testing_GraphQL
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:L
  priority: 2
  remediationComplexity: 1
  details:
    - locale: EN
      title: 'WSTG-BUSL-07: Application Misuse due to missing Throttling'
      vulnType: Pentest
      description: >-
        <p>Abusing an application by sending masses of requests can have several
        negative impacts on an application:<br>- It might get slow or even
        unresponsive<br>- It gets flooded with garbage data which makes it
        harder to use the app<br>- Flooding the database<br>- ...<br></p>
      remediation: >-
        <p>Implement measures that reduce the amount of requests that can be
        made within a certain timeframe.<br>This can be throttling mechanisms on
        the webserver, Captchas of whatever is suitable.</p>
      references:
        - >-
          https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/10-Business_Logic_Testing/07-Test_Defenses_Against_Application_Misuse
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:L/I:L/A:N
  priority: 1
  remediationComplexity: 2
  details:
    - locale: EN
      title: 'WSTG-SESS-06: Missing Session Termination'
      vulnType: Pentest
      description: >-
        <p>Session termination is an important part of the session lifecycle.
        Reducing to a minimum the lifetime of the session tokens decreases the
        likelihood of a successful session hijacking attack. This can be seen as
        a control against preventing other attacks like Cross Site Scripting and
        Cross Site Request Forgery. Such attacks have been known to rely on a
        user having an authenticated session present. Not having a secure
        session termination only increases the attack surface for any of these
        attacks.</p><p>A secure session termination requires at least the
        following components:</p><ul><li><p>Availability of user interface
        controls that allow the user to manually log out.</p></li><li><p>Session
        termination after a given amount of time without activity (session
        timeout).</p></li><li><p>Proper invalidation of server-side session
        state.</p></li></ul>
      remediation: >-
        <p>Sessions should get terminated automatically after a certain amount
        of time.<br>If a user logs out of the application, the sessions
        information need to be terminated and invalidated on the server side, so
        that no reusage is possible.<br>Make sure to find the right balance
        between user experience and security.<br><br></p>
      references:
        - >-
          https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/06-Session_Management_Testing/06-Testing_for_Logout_Functionality
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:H/A:N
  priority: 3
  remediationComplexity: 2
  details:
    - locale: EN
      title: 'WSTG-BUSL-07: Application Misuse Input Validation'
      vulnType: Pentest
      description: >-
        <p>Input validation is a crucial aspect of web security that involves
        verifying and sanitizing user input to prevent malicious or unintended
        actions. In web applications, user input can come from various sources,
        such as form submissions, URL parameters, and HTTP headers, and it is
        important to ensure that this input is valid and safe to use before
        processing it.</p><p>Input validation involves checking that the user
        input conforms to expected formats, types, and ranges, and rejecting any
        input that does not meet these criteria. This can help prevent a wide
        range of attacks, including SQL injection, cross-site scripting (XSS),
        and command injection, which can be used to steal sensitive data, modify
        application behavior, or take over the server.</p><p>In addition to
        validating input, it is also important to sanitize it by removing any
        potentially dangerous characters or sequences, such as HTML tags,
        JavaScript code, or shell commands. This can help prevent attacks that
        rely on injecting malicious code into the application, and can help
        ensure that the user input is used only for its intended
        purpose.</p><p>Overall, input validation and sanitization are essential
        techniques for ensuring web security, and should be applied consistently
        throughout the application to help prevent a wide range of attacks. By
        carefully validating and sanitizing user input, developers can help
        protect their users' data and prevent malicious actors from exploiting
        vulnerabilities in the application.</p>
      remediation: >-
        <p>Input validation should be implemented throughout the application.
        Special characters and things like URLs should be sanitized.</p>
      references:
        - >-
          https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/10-Business_Logic_Testing/07-Test_Defenses_Against_Application_Misuse
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
  priority: 2
  remediationComplexity: 2
  details:
    - locale: EN
      title: 'WSTG-ATHN-03: Faulty Brute-Force Protection'
      vulnType: Pentest
      description: >-
        <p>Brute-force protection is a mechanism used to prevent attackers from
        guessing a user's login credentials through a trial-and-error process
        known as a brute-force attack. In this type of attack, an attacker tries
        multiple combinations of usernames and passwords until they find the
        correct one, allowing them to gain unauthorized access to the
        system.</p><p>To prevent brute-force attacks, login functionality may
        include various brute-force protection measures. One common method is to
        limit the number of login attempts within a specified time frame. For
        example, after three failed login attempts, the system may lock the
        account or impose a time delay before allowing additional login
        attempts. This prevents an attacker from trying an unlimited number of
        combinations in a short period.</p><p>Another method of brute-force
        protection is to implement a CAPTCHA (Completely Automated Public Turing
        test to tell Computers and Humans Apart) system, which requires the user
        to enter a visual or audio challenge-response test that only humans can
        solve. This helps to prevent automated bots from attempting multiple
        login attempts in quick succession.</p><p>In summary, brute-force
        protection is used to prevent attackers from guessing a user's login
        credentials through a trial-and-error process. This is typically
        achieved by limiting the number of login attempts within a specified
        time frame, or by implementing a CAPTCHA system to prevent automated
        attacks. These measures help to improve the security of login
        functionality and protect user accounts from unauthorized access.</p>
      remediation: >-
        <p>Implement a valuable protection mechanism against brute-force
        attempts.<br>Detailed info can be found in the description section of
        this finding.</p>
      references:
        - >-
          https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/04-Authentication_Testing/03-Testing_for_Weak_Lock_Out_Mechanism
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N
  priority: 1
  remediationComplexity: 1
  details:
    - locale: EN
      title: 'WSTG-ERRH-01: Detailed Stack Traces'
      vulnType: Pentest
      description: >-
        <p>In a web app, a stack trace is a report that shows the sequence of
        function calls that led to an error or exception being thrown. It helps
        developers diagnose and fix issues in the code by identifying the
        specific code paths that caused the error.</p><p>However, if a detailed
        stack trace is visible to an attacker, it can reveal sensitive
        information about the application, including the underlying
        architecture, technologies, and potential vulnerabilities. An attacker
        can use this information to exploit the application, gain unauthorized
        access, or launch other types of attacks. Therefore, it is crucial to
        protect the stack trace from being accessible to unauthorized users and
        to minimize the amount of sensitive information it reveals.</p>
      remediation: >-
        <p>Stack traces should be disabled to not reveal any sensitive info that
        might be useful to an attacker.</p>
      references:
        - >-
          https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/08-Testing_for_Error_Handling/01-Testing_For_Improper_Error_Handling
      customFields: []
  category: Web Pentest
- cvssv3: null
  priority: 3
  remediationComplexity: 1
  details:
    - locale: EN
      title: 'WSTG-INFO-09: Outdated Software'
      vulnType: Pentest
      description: >-
        <p>Used soft- and firmware as well as operating systems should always be
        kept to the most current versions.</p><p>Using outdated versions poses
        several direct and indirect security risks like:<br>- Security
        vulnerabilities: outdated software may have unpatched security holes
        that can be exploited by attackers.<br>- Compatibility issues: new
        hardware or software may not be compatible with old systems.<br>-
        Performance degradation: outdated software may run slower, become less
        responsive, or crash more often.<br>- Lack of features: newer software
        may have additional features or improvements that are not available in
        older versions.<br>- Compliance problems: outdated software may not meet
        industry regulations or standards.<br><br>Staying up to date is a
        mandatory requirement to a matured security culture and should be part
        of the patch management process.</p>
      remediation: >-
        <p>Check if any of the mentioned software components can be upgraded /
        updated and if important security updates are missing.<br>Implement a
        patch management strategy and process that ensures that all your systems
        are up to date and that updates are applied timely according to their
        criticality.<br>Apply workarounds when no patches are available when
        tackling critical flaws.<br>Check if potential flaws are mitigated by
        backports.</p>
      references: []
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
  priority: 3
  remediationComplexity: 2
  details:
    - locale: EN
      title: 'WSTG-ATHZ-04: Insecure Direct Object Reference (IDOR)'
      vulnType: Pentest
      description: >-
        <p>IDOR, or Insecure Direct Object Reference, is a web security
        vulnerability that occurs when an application provides direct access to
        objects based on user-supplied input, such as file names, URLs, or
        database keys. In an IDOR vulnerability, an attacker can manipulate
        these references to access unauthorized data or perform actions they
        shouldn't have access to. IDOR arises when an application lacks proper
        access controls and relies solely on user input to identify and access
        objects or resources. An attacker can exploit IDOR by tampering with
        parameters (e.g., changing a URL parameter or modifying hidden fields in
        a form) to access or manipulate data or actions that they are not
        authorized to perform. IDOR vulnerabilities can lead to unauthorized
        data exposure, data manipulation, account takeover, or even the
        modification or deletion of sensitive records.</p><p>In summary, IDOR is
        a security flaw that occurs when an application doesn't adequately
        protect against direct manipulation of object references, potentially
        allowing attackers to access or manipulate data or actions they should
        not have access to. It's important for developers to implement robust
        access controls and validate user input to mitigate IDOR
        vulnerabilities.</p>
      remediation: >-
        <p>To prevent IDOR vulnerabilities, developers should implement proper
        access controls, validate user input, and use authentication and
        authorization mechanisms to ensure that users can only access the data
        and actions they are authorized for.<br>Further details can be found in
        the reference section.</p>
      references:
        - >-
          https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/05-Authorization_Testing/04-Testing_for_Insecure_Direct_Object_References
        - https://portswigger.net/web-security/access-control/idor
        - >-
          https://cheatsheetseries.owasp.org/cheatsheets/Insecure_Direct_Object_Reference_Prevention_Cheat_Sheet.html
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
  details:
    - locale: EN
      title: 'WSTG-CRYP-04: Weak Hashing'
      vulnType: Pentest
      description: >-
        <p>Hashing is a one-way process of converting input data (of any size)
        into a fixed-length string of characters, which is typically a hash
        value or digest. The output, known as the hash, should be unique to the
        input data, making it practically impossible to reverse the
        process.</p><p>Hash functions are commonly used to verify the integrity
        of data. Even a small change in the input data should result in a
        substantially different hash value. This property helps detect tampering
        or corruption.</p><p>Hashing is widely employed to secure passwords.
        Storing hashed passwords instead of plaintext enhances security.
        However, using weak hashing algorithms or short hash lengths makes it
        easier for attackers to perform brute-force or rainbow table
        attacks.</p><p>&nbsp;</p><p><strong>Security Risks of Weak
        Hashing:</strong></p><p>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <strong>Brute-Force Attacks:</strong> Weak hash algorithms can be more
        easily broken using brute-force attacks, where attackers systematically
        try all possible inputs to find a
        match.</p><p>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <strong>Collision Vulnerabilities:</strong> Weak hashing may lead to
        collisions, where different inputs produce the same hash output. This
        compromises the uniqueness of the hash and introduces security
        vulnerabilities.</p><p>&nbsp;</p><p>Many security standards and
        regulations mandate the use of strong and cryptographically secure
        hashing algorithms to protect sensitive data. Weak hashing practices may
        result in non-compliance and increased susceptibility to unauthorized
        access.</p><p>In summary, using weak hashing algorithms poses security
        risks by making it easier for attackers to compromise password security,
        undermine data integrity, and violate privacy. Strong and
        well-established hashing practices are essential for robust data
        protection</p>
      remediation: >-
        <ul><li><p><strong>Use Cryptographically Secure Hash Functions:</strong>
        Choose well-established and cryptographically secure hash functions
        designed for security, such as SHA-256 or SHA-3. These algorithms are
        rigorously tested and widely accepted in the security
        community.</p></li><li><p><strong>Keyed Hashing for Passwords:</strong>
        For password hashing, use a key derivation function (KDF) designed for
        this purpose, such as bcrypt, Argon2, or scrypt. These KDFs include
        additional parameters like salt and iteration count, enhancing the
        security of password storage.</p></li><li><p><strong>Salt the
        Hash:</strong> Always use a unique salt for each piece of sensitive data
        before hashing. Salting ensures that even identical inputs produce
        different hash outputs, preventing attackers from using precomputed
        tables (rainbow tables) for attacks.</p></li><li><p><strong>Consider
        Using Pepper:</strong> Pepper is a secret key added to the data before
        hashing, providing an additional layer of security. Unlike salt, pepper
        is kept secret and can be implemented as a configuration parameter
        separate from the hashed data.</p></li><li><p><strong>Stay Informed and
        Update:</strong> Regularly review industry best practices and updates
        related to hashing algorithms. Security evolves, and algorithms that
        were once secure may become vulnerable over time. Stay informed about
        the latest developments and be prepared to update hashing practices
        accordingly.</p></li><li><p><strong>Implement Strong Access
        Controls:</strong> Limit access to the hashed data, ensuring that only
        authorized individuals or systems can retrieve or manipulate sensitive
        information. This adds an extra layer of protection even if the hash is
        somehow exposed.</p></li><li><p><strong>Encrypt Sensitive Data Before
        Hashing (if applicable):</strong> Depending on the context, consider
        encrypting sensitive data before hashing it. Encryption adds an extra
        layer of protection, especially in scenarios where confidentiality is a
        primary concern.</p></li></ul>
      references: []
      customFields: []
  category: Web Pentest
- cvssv3: null
  details:
    - locale: EN
      title: 'WSTG-BUSL-07: Application Logic Flaw - Unauthorized Log Access'
      vulnType: Pentest
      description: >-
        <p>Sensitive info like it is contained in logs should only be available
        to authorized users like administrators.<br>The application might
        otherwise expose personal info, credentials and other critical data to
        unintended audience.</p>
      references: []
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
  priority: 3
  remediationComplexity: 1
  details:
    - locale: EN
      title: 'WSTG-ATHZ-01: Directory Traversal'
      vulnType: Pentest
      description: >-
        <p>Directory or path traversal attacks involve manipulating file or
        directory paths in an application by injecting malicious
        input.</p><p>Attackers use "../" or similar sequences to navigate
        outside intended directories, gaining unauthorized access to sensitive
        files or data.</p><p>These attacks are dangerous because they can lead
        to unauthorized data exposure, system compromise, and application
        defacement.</p>
      remediation: >-
        <ul><li><p><strong>Input Validation:</strong> Validate and sanitize user
        inputs to ensure they conform to expected formats and
        structures.</p></li><li><p><strong>Use Whitelists:</strong> Maintain
        whitelists of valid file paths, allowing only predefined
        inputs.</p></li><li><p> <strong>Access Controls:</strong> Implement
        proper access controls to restrict user permissions, ensuring they only
        access authorized resources.</p></li><li><p><strong>File System
        Protection:</strong> Apply proper file system configurations to limit
        access and execution permissions.</p></li><li><p><strong>Secure
        APIs:</strong> Use secure APIs that abstract file system operations,
        preventing direct manipulation.</p></li><li><p><strong>Encode
        Output:</strong> Encode output to prevent characters like "../" from
        being interpreted as directory traversal.</p></li><li><p><strong>Logging
        and Monitoring:</strong> Implement robust logging and monitoring to
        detect and respond to suspicious activities.</p></li></ul>
      references:
        - >-
          https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/05-Authorization_Testing/01-Testing_Directory_Traversal_File_Include
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
  priority: 3
  remediationComplexity: 2
  details:
    - locale: EN
      title: 'WSTG-CLNT-13: CSV Injection'
      vulnType: Pentest
      description: >-
        <p>CSV injection, also known as formula injection, occurs when a cell in
        a CSV (Comma-Separated Values) file contains data that, when interpreted
        by a spreadsheet program, is treated as a formula rather than plain
        text. This can be dangerous due to the following
        reasons:</p><ul><li><p><strong>Arbitrary Code Execution:</strong> An
        attacker can embed malicious formulas or commands into the CSV file.
        When opened by a spreadsheet program, these formulas may execute
        arbitrary code on the user's system.</p></li><li><p><strong>Spreadsheet
        Program Vulnerabilities:</strong> Certain spreadsheet programs may have
        vulnerabilities that can be exploited through CSV injection. Attackers
        leverage these vulnerabilities to execute malicious
        actions.</p></li><li><p><strong>Data Manipulation:</strong> CSV
        injection can lead to unauthorized manipulation of data within the
        spreadsheet. This could result in data loss, corruption, or unauthorized
        access to sensitive information.</p></li><li><p><strong>Phishing
        Attacks:</strong> Malicious formulas can be crafted to create phishing
        scenarios, tricking users into revealing sensitive information or
        performing unintended actions.</p></li><li><p><strong>Cross-Site
        Scripting (XSS):</strong> In web applications that process CSV uploads,
        CSV injection may lead to XSS attacks if the injected data is reflected
        back to users without proper validation and sanitization.</p></li></ul>
      remediation: >-
        <ul><li><p><strong>Avoid Executable Content:</strong> Ensure that
        user-input data in CSV files is treated as plain text and not as
        executable content.</p></li><li><p><strong>Sanitize Input:</strong>
        Implement strict input validation and sanitization mechanisms to prevent
        the inclusion of formulas or malicious
        content.</p></li><li><p><strong>Use Cell Formatting:</strong> Apply
        proper cell formatting to explicitly define data types, preventing the
        automatic execution of formulas.</p></li><li><p><strong>Educate
        Users:</strong> Raise awareness among users about the risks of opening
        CSV files from untrusted sources and the importance of validating file
        contents.</p></li></ul>
      references:
        - >-
          https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/11-Client_Side_Testing/13-Testing_for_Cross_Site_Script_Inclusion
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N
  priority: 2
  remediationComplexity: 1
  details:
    - locale: EN
      title: 'WSTG-BUSL-07: Application Logic Flaw - Exposed Passwords'
      vulnType: Pentest
      description: >-
        <p>Passwords and other sensitive data should never be exposed in an
        application because doing so creates significant security risks. If
        passwords are included in server responses, logs, or visible fields
        within the application, they can be intercepted by attackers through
        network monitoring, cross-site scripting (XSS), or user mishandling.
        This exposure makes it easy for bad actors to gain unauthorized access
        to accounts, escalate privileges, or exploit the system
        further.</p><p>Even administrative users should not have access to
        plaintext passwords or sensitive information. If such data is
        accessible, malicious or compromised administrators could abuse it,
        violating user trust, breaching privacy regulations like GDPR, and
        potentially leading to lawsuits or reputational damage.</p><p>Hashed
        values must also be protected, as exposing them still poses a risk.
        Attackers can crack weak hashes using brute force or dictionary attacks,
        especially if the hashing algorithm is outdated (e.g., MD5, SHA1) or
        improperly implemented without salts. This can lead to credential
        stuffing attacks on other systems where users may have reused
        passwords.</p><p>Ultimately, exposing any form of sensitive information
        weakens the security posture of the application, increases the
        likelihood of data breaches, and endangers both users and the
        organization. Proper security measures, such as masking passwords,
        encrypting sensitive data, and ensuring even hashed values are kept
        secure, are essential to mitigate these risks.</p>
      remediation: >-
        <p>Mask the passwords if they really need to be available in the GUI.
        <br>A password reset functionality can also be implemented for
        administrative users without showing the actual values.</p>
      references: []
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:N
  priority: 1
  remediationComplexity: 1
  details:
    - locale: EN
      title: 'WSTG-CONF-05: Administrative Interfaces'
      vulnType: Pentest
      description: >-
        <table><tbody><tr><td colspan="1" rowspan="1"><p>Exposing administrative
        interfaces of a web application to the public increases the risk of
        unauthorized access and potential security breaches. Keeping these
        interfaces restricted to the corporate network or dedicated management
        machines helps mitigate these risks. This
        approach:</p><p>&nbsp;</p><ul><li><p><strong>Reduces Attack
        Surface</strong>: Limiting access to administrative interfaces minimizes
        the exposure of critical components to the external environment,
        lowering the chances of exploitation.</p></li><li><p><strong>Enhances
        Confidentiality</strong>: Internal access ensures that sensitive
        information, configurations, and functionalities are not easily
        accessible to unauthorized external
        entities.</p></li><li><p><strong>Mitigates Unauthorized Access</strong>:
        External exposure increases the likelihood of unauthorized users
        attempting to access administrative functions. Restricting access to
        internal networks adds an extra layer of
        protection.</p></li><li><p><strong>Protects Against Brute Force
        Attacks</strong>: Limiting access to specific networks reduces the
        attack surface for brute force attacks on administrative
        credentials.</p></li><li><p><strong>Preserves Availability</strong>: By
        preventing potential attacks from the public internet, the web
        application's administrative functionalities are less susceptible to
        denial-of-service attempts or other
        disruptions.</p></li><li><p><strong>Aligns with Least Privilege
        Principle</strong>: Granting access only to trusted networks adheres to
        the principle of least privilege, ensuring that only necessary entities
        have access to sensitive
        functionalities.</p></li></ul><p>&nbsp;</p><p>In summary, restricting
        access to administrative interfaces helps maintain a more secure and
        controlled environment, safeguarding critical aspects of the web
        application from external threats.</p></td></tr></tbody></table>
      remediation: >-
        <p>Restrict access to administrative functions to only allow access from
        specific IPs and / or networks.</p>
      references:
        - >-
          https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/05-Enumerate_Infrastructure_and_Application_Admin_Interfaces
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  priority: 4
  remediationComplexity: 2
  details:
    - locale: EN
      title: 'WSTG-ATHZ-02: Bypassing Authorization Schema'
      vulnType: Pentest
      description: >-
        <p>An authorization mechanism in a web application controls access to
        functionalities, resources, or data based on the identity and privileges
        of the user. It determines whether a user is allowed to perform certain
        actions or access specific information within the application.</p><p>If
        the authorization mechanism is bypassable, it can have significant
        security implications. This means that attackers may gain unauthorized
        access to sensitive functionalities or data within the application. They
        could potentially escalate their privileges, access confidential
        information, modify critical settings, or perform actions that could
        compromise the integrity, confidentiality, or availability of the
        application and its data. In essence, a bypassable authorization
        mechanism undermines the fundamental principle of least privilege and
        can lead to serious security breaches.</p>
      remediation: >-
        <p>Employ the least privilege principles on the users, roles, and
        resources to ensure that no unauthorized access occurs.</p>
      references:
        - >-
          https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/05-Authorization_Testing/02-Testing_for_Bypassing_Authorization_Schema
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
  priority: 3
  remediationComplexity: 1
  details:
    - locale: EN
      title: 'WSTG-ATHN-07: Weak Passwords'
      vulnType: Pentest
      description: >-
        <p>Strong passwords are essential, particularly for privileged accounts,
        due to the following reasons:</p><ul><li><p><strong>Protection against
        Unauthorized Access</strong>: Strong passwords serve as a primary
        defense mechanism against unauthorized access to sensitive systems and
        data. Privileged accounts have elevated permissions, allowing them to
        perform critical actions within an organization's infrastructure. If
        these accounts are compromised due to weak passwords, attackers can gain
        unfettered access to valuable resources, manipulate data, or cause
        widespread damage.</p></li><li><p><strong>Mitigation of Credential-Based
        Attacks</strong>: Weak passwords are vulnerable to various
        credential-based attacks, such as brute force attacks, dictionary
        attacks, and password spraying. Attackers use automated tools to
        systematically guess or crack passwords, exploiting weak or common
        choices. Strong passwords with a combination of uppercase and lowercase
        letters, numbers, and special characters significantly increase the
        complexity, making them more resilient to such
        attacks.</p></li><li><p><strong>Prevention of Privilege
        Escalation</strong>: Strong passwords help prevent privilege escalation
        attacks, where attackers compromise low-privileged accounts and attempt
        to escalate their privileges to gain access to more critical systems or
        resources. By ensuring that privileged accounts have strong passwords,
        organizations can mitigate the risk of unauthorized privilege escalation
        and maintain proper access controls.</p></li><li><p><strong>Compliance
        Requirements</strong>: Many regulatory frameworks and industry
        standards, such as PCI DSS, HIPAA, and GDPR, mandate the use of strong
        passwords and enforce password management practices for protecting
        sensitive data. Compliance with these requirements helps organizations
        demonstrate their commitment to security and avoid potential legal and
        financial consequences of data
        breaches.</p></li><li><p><strong>Maintaining Trust and
        Reputation</strong>: Security breaches resulting from weak passwords can
        tarnish an organization's reputation and erode customer trust. A data
        breach involving compromised privileged accounts can have severe
        repercussions, including financial losses, legal liabilities, and damage
        to brand reputation. Strong passwords contribute to maintaining trust
        and confidence among stakeholders by safeguarding sensitive information
        and maintaining the integrity of systems and data.</p></li></ul><p>In
        summary, strong passwords for privileged accounts are crucial for
        protecting against unauthorized access, mitigating credential-based
        attacks, preventing privilege escalation, complying with regulatory
        requirements, and upholding trust and reputation. Weak passwords pose a
        significant risk by exposing organizations to security breaches, data
        theft, and other adverse consequences.</p>
      remediation: >-
        <p>Privileged accounts should have extremely strong passwords. They
        should be at least 20 characters long, and comply to complexity with
        uppercase, lowercase, numbers and special characters. The passwords
        should be randomly generated, no words! Password blacklisting can be
        issued to help here.<br>Password reusage should be avoided at all
        costs.<br>Personal holding higher privileges needs to be trained and
        made aware of the possible risks. <br>Saving credentials in a Web
        Browser should also be avoided.<br>Additionally these accounts should be
        hardened via Multi Factor Authentication where possible.</p>
      references:
        - >-
          https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:N
  details:
    - locale: EN
      title: 'WSTG-BUSL-08: Upload of Unexpected File Types'
      description: >-
        <p>The upload of unexpected file types can pose significant security
        risks to a web application. Here's a brief
        overview:</p><ul><li><p><strong>Execution of Malicious Code</strong>:
        Attackers may upload files containing malicious code, such as scripts or
        executable files, disguised as benign file types. If the application
        allows these files to be uploaded and executed on the server or
        client-side, it can lead to various attacks, including remote code
        execution, command injection, or cross-site scripting
        (XSS).</p></li><li><p><strong>Security Bypass</strong>: Uploading
        unexpected file types can bypass security measures and access controls
        implemented by the application. For example, an attacker might upload a
        PHP file to exploit vulnerabilities in the server environment,
        circumventing authentication or authorization checks to gain
        unauthorized access to sensitive data or
        functionalities.</p></li><li><p><strong>File Inclusion
        Vulnerabilities</strong>: If the application allows uploaded files to be
        included or executed within the context of the application, it can
        introduce file inclusion vulnerabilities. Attackers may exploit these
        vulnerabilities to execute arbitrary code, disclose sensitive
        information, or compromise the integrity of the
        application.</p></li><li><p><strong>Denial of Service (DoS)
        Attacks</strong>: Uploading large or unexpected file types can consume
        excessive server resources, leading to denial of service (DoS)
        conditions. Attackers may exploit this by uploading large files
        repeatedly, causing the application to become unresponsive or
        unavailable to legitimate users.</p></li><li><p><strong>Data
        Exfiltration</strong>: Attackers may upload unexpected file types to
        exfiltrate sensitive data from the server or inject malicious content
        into the application. For example, uploading a malicious PDF file
        containing embedded scripts could be used to steal session cookies or
        perform other forms of data exfiltration.</p></li></ul><p>Overall,
        allowing the upload of unexpected file types without proper validation
        and sanitization can significantly increase the attack surface of a web
        application and expose it to various security threats. It's essential
        for developers to implement robust input validation, content-type
        verification, and file extension checks to mitigate these risks
        effectively.</p>
      remediation: >-
        <p>It is recommended performing a server-side check of the file
        extensions as well as the file type. However, checking the file
        extension itself is not a sufficient protection and in addition the
        magic bytes of the files uploaded should be checked.</p><p>Furthermore,
        uploaded files should be checked for malware using antivirus software.
        Possible embedded objects should be removed. Among other things,
        Microsoft Office documents, PDF files and images can contain embedded
        objects, which are not always detected by antivirus programs. These can
        be converted to safe files using file disinfection (for example, PDF to
        PDFA). Further recommendations can be found in the OWASP Guideline.</p>
      references:
        - >-
          https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/10-Business_Logic_Testing/08-Test_Upload_of_Unexpected_File_Types
      customFields: []
  category: Web Pentest
- cvssv3: null
  details:
    - locale: EN
      title: 'WSTG-ATHN-09: Weak Password Change or Reset Functionalities'
      description: >-
        <p>Forget password functions provide users with a mechanism to reset or
        recover their forgotten passwords. Typically, users are prompted to
        provide information or undergo a verification process to prove their
        identity before resetting their password.</p><p><strong>Potential
        Security Risks</strong>:</p><ul><li><p><strong>Identity Verification
        Weaknesses</strong>: If the identity verification process is weak or
        poorly implemented, attackers may exploit it to reset passwords for
        accounts they do not own. This could involve guessing security
        questions, exploiting knowledge-based authentication, or bypassing email
        verification processes.</p></li><li><p><strong>Account
        Enumeration</strong>: Flawed forget password implementations may
        inadvertently disclose whether a given email address is registered with
        the service, allowing attackers to enumerate valid user accounts. This
        information can be used for targeted attacks or spam
        campaigns.</p></li><li><p><strong>Brute Force Attacks</strong>: Weak
        account lockout policies or lack of rate limiting on forget password
        requests can make the system susceptible to brute force attacks.
        Attackers may attempt to enumerate valid usernames or email addresses
        and then launch automated attacks to reset passwords for multiple
        accounts.</p></li><li><p><strong>Insecure Email Communication</strong>:
        If forget password emails are transmitted insecurely or contain
        sensitive information in plaintext, they may be intercepted or exposed
        to unauthorized parties, compromising users'
        accounts.</p></li><li><p><strong>Data Privacy Concerns</strong>: Forget
        password functions may involve the collection and processing of users'
        personal information, such as email addresses or security question
        responses. Improper handling of this data can lead to privacy violations
        or data breaches, exposing users to identity theft or unauthorized
        access.</p><p></p></li></ul><p>In summary, while forget password
        functions provide users with a convenient way to recover their accounts,
        flawed implementations can introduce security risks, including identity
        verification weaknesses, account enumeration, and data privacy concerns.
        It's crucial for web developers to prioritize security when implementing
        and maintaining these functionalities to protect users' accounts and
        personal information effectively.</p>
      remediation: >-
        <p>To mitigate the security risks associated with forget password
        functions, web developers should:</p><ul><li><p>Implement strong
        identity verification mechanisms, such as multi-factor authentication or
        one-time passwords, to ensure that only authorized users can reset their
        passwords.</p></li><li><p>Enforce secure communication protocols, such
        as TLS, for all forget password-related interactions to protect
        sensitive information during transmission.</p></li><li><p>Implement
        account lockout mechanisms and rate limiting to prevent brute force
        attacks on forget password functionalities.</p></li><li><p>Avoid
        disclosing whether an email address is registered with the service to
        prevent account enumeration attacks.</p></li><li><p>Regularly audit and
        test forget password functionalities for vulnerabilities, such as
        account enumeration or weak identity verification
        processes.</p></li><li><p>Do not send clear text passwords via
        E-Mail.</p></li></ul>
      references:
        - >-
          https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/04-Authentication_Testing/09-Testing_for_Weak_Password_Change_or_Reset_Functionalities
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:L
  priority: 2
  remediationComplexity: 1
  details:
    - locale: EN
      title: 'WSTG-CONF-01: Network Infrastructure Configuration'
      vulnType: Pentest
      description: >-
        <p>The intrinsic complexity of interconnected and heterogeneous web
        server infrastructure, which can include hundreds of web applications,
        makes configuration management and review a fundamental step in testing
        and deploying every single application. It takes only a single
        vulnerability to undermine the security of the entire infrastructure,
        and even small and seemingly unimportant problems may evolve into severe
        risks for another application on the same server. In order to address
        these problems, it is of utmost importance to perform an in-depth review
        of configuration and known security issues, after having mapped the
        entire architecture.</p><p>Proper configuration management of the web
        server infrastructure is very important in order to preserve the
        security of the application itself. If elements such as the web server
        software, the backend database servers, or the authentication servers
        are not properly reviewed and secured, they might introduce undesired
        risks or introduce new vulnerabilities that might compromise the
        application itself.</p><p>For example, a web server vulnerability that
        would allow a remote attacker to disclose the source code of the
        application itself (a vulnerability that has arisen a number of times in
        both web servers and application servers) could compromise the
        application, as anonymous users could use the information disclosed in
        the source code to leverage attacks against the application or its
        users.</p>
      observation: <p></p><p></p>
      remediation: >-
        <p>Ports and services must be exposed according to the principle of
        least privilege.<br>Restrict access to those ports to systems and users
        that need it.</p>
      references:
        - >-
          https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/01-Test_Network_Infrastructure_Configuration
      customFields: []
  category: Web Pentest
- cvssv3: null
  details:
    - locale: EN
      title: 'WSTG-ATHN-04: Authentication Schema Problems'
      description: >-
        <p>An authentication schema, also known as an authentication mechanism
        or authentication system, is a method used to verify the identity of a
        user or entity trying to access a system, application, or resource. It
        typically involves the presentation of credentials, such as a username
        and password, biometric data, security tokens, or digital certificates,
        to prove the identity of the user.</p><p>Authentication is a critical
        component of IT security because it ensures that only authorized users
        gain access to sensitive information and resources. However,
        authentication mechanisms can be vulnerable to various attacks, which is
        why they need to be hardened or strengthened against potential threats.
        Here are some reasons why:</p><ul><li><p><strong>Protection against
        unauthorized access</strong>: If an authentication mechanism is not
        properly hardened, attackers may be able to bypass it and gain
        unauthorized access to sensitive data or resources. For example, weak
        passwords, insecure password storage, or improper session management can
        all be exploited by attackers to gain unauthorized
        access.</p></li><li><p><strong>Prevention of credential theft</strong>:
        Attackers may attempt to steal user credentials through techniques such
        as phishing, malware, or brute force attacks. A hardened authentication
        mechanism implements measures to mitigate these threats, such as
        multi-factor authentication (MFA), CAPTCHA, or rate limiting to prevent
        brute force attacks.</p></li><li><p><strong>Mitigation of authentication
        bypass vulnerabilities</strong>: Authentication bypass vulnerabilities
        can allow attackers to bypass the authentication process altogether and
        gain unauthorized access to the system or application. Hardening
        authentication mechanisms involves identifying and patching these
        vulnerabilities to prevent
        exploitation.</p></li><li><p><strong>Protection against session
        hijacking</strong>: Session hijacking occurs when an attacker steals a
        user's session token or cookie to impersonate the user and gain
        unauthorized access to their account. Hardened authentication mechanisms
        use techniques such as secure session management, encryption, and
        token-based authentication to prevent session hijacking
        attacks.</p></li><li><p><strong>Compliance with regulations and
        standards</strong>: Many regulatory standards, such as the Payment Card
        Industry Data Security Standard (PCI DSS) and the General Data
        Protection Regulation (GDPR), require organizations to implement strong
        authentication measures to protect sensitive data and ensure user
        privacy. Failure to harden authentication mechanisms can result in
        non-compliance and potential legal consequences.</p></li></ul>
      references:
        - >-
          https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/04-Authentication_Testing/04-Testing_for_Bypassing_Authentication_Schema
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N
  details:
    - locale: EN
      title: 'WSTG-CLNT-07: Cross Origin Resource Sharing'
      vulnType: Pentest
      description: >-
        <p>CORS (Cross-Origin Resource Sharing) is a security feature that
        controls how resources on a web page can be requested from another
        domain. <br>It uses HTTP headers to allow a server to specify which
        origins are permitted to access its resources.<br>CORS can prevent
        unauthorized cross-origin requests and ensures secure communication
        between web pages and servers on different domains.</p><p>Risks of
        Incorrect CORS Configuration:</p><ul><li><p><strong>Unauthorized
        Access</strong>: If CORS is configured too permissively, such as
        allowing access from any origin (<code>*</code>), it can expose the
        server to unauthorized access, enabling malicious sites to interact with
        the server as if they were trusted.</p></li><li><p><strong>Cross-Site
        Scripting (XSS) Exploits</strong>: Insecure CORS settings can facilitate
        XSS attacks, where attackers inject malicious scripts into web pages
        viewed by other users, leveraging the compromised trust between the
        server and the client.</p></li><li><p><strong>Data Theft</strong>:
        Incorrectly configured CORS may allow an attacker to bypass the
        Same-Origin Policy, enabling them to make unauthorized requests and
        steal sensitive data from web
        applications.</p></li><li><p><strong>Credential Exposure</strong>: If
        credentials (such as cookies or HTTP authentication) are included in
        cross-origin requests and CORS is not properly configured, attackers can
        potentially hijack user sessions and gain unauthorized
        access.</p></li></ul>
      remediation: >-
        <p>Implement CORS according to the standards referred in the reference
        section if needed.</p><p>Best Practices:</p><ul><li><p><strong>Restrict
        Allowed Origins</strong>: Only allow specific, trusted domains to access
        resources.</p></li><li><p><strong>Use HTTPS</strong>: Ensure that
        cross-origin requests are made over HTTPS to protect data in
        transit.</p></li><li><p><strong>Restrict Methods and Headers</strong>:
        Limit the allowed HTTP methods (GET, POST, etc.) and headers to the
        minimum necessary.</p></li><li><p><strong>Review Preflight
        Requests</strong>: Carefully handle CORS preflight requests to ensure
        that only safe requests are processed.</p></li></ul>
      references:
        - https://portswigger.net/web-security/cors
        - >-
          https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/11-Client-side_Testing/07-Testing_Cross_Origin_Resource_Sharing
        - https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
  priority: 4
  remediationComplexity: 2
  details:
    - locale: EN
      title: 'WSTG-IDNT-02: User Registration Process allowing for Account Takeover'
      vulnType: Pentest
      description: >-
        <p>In web applications, a particularly dangerous form of account
        takeover vulnerability can occur when the user registration function is
        improperly designed, allowing one user to overwrite another user's
        account. Here’s an overview of how this vulnerability arises and its
        potential impacts:</p><p>How It Occurs:</p><ul><li><p><strong>Improper
        Validation</strong>:</p><ul><li><p>The registration function does not
        properly validate whether an email address or username already exists in
        the database.</p></li></ul></li><li><p><strong>Insecure
        Implementation</strong>:</p><ul><li><p>The backend code allows
        overwriting of existing user records when a new registration is
        attempted with the same identifier (e.g., email or username) as an
        existing account.</p></li></ul></li><li><p><strong>Lack of Unique
        Constraints</strong>:</p><ul><li><p>The database schema does not enforce
        unique constraints on user identifiers, allowing duplicates or
        overwrites.</p></li></ul></li></ul><p>Impact:</p><ul><li><p><strong>Account
        Hijacking</strong>:</p><ul><li><p>An attacker can register a new account
        using the email or username of an existing user, effectively taking over
        the existing user's account.</p></li></ul></li><li><p><strong>Data
        Loss</strong>:</p><ul><li><p>The original user's data can be overwritten
        or deleted, leading to loss of personal information, settings, and
        stored data.</p></li></ul></li><li><p><strong>Unauthorized
        Access</strong>:</p><ul><li><p>The attacker gains unauthorized access to
        the application with the victim's privileges, potentially leading to
        further exploitation or misuse of the
        application.</p></li></ul></li><li><p><strong>Loss of User
        Trust</strong>:</p><ul><li><p>Users may lose trust in the application if
        they find that their accounts can be easily hijacked, leading to
        reputational damage.</p></li></ul></li></ul>
      remediation: >-
        <ul><li><p><strong>Unique Constraints</strong>:</p><ul><li><p>Ensure
        that the database enforces unique constraints on user identifiers such
        as email addresses and
        usernames.</p></li></ul></li><li><p><strong>Proper
        Validation</strong>:</p><ul><li><p>Implement thorough server-side
        validation to check if a user identifier already exists before allowing
        a new registration.</p></li></ul></li><li><p><strong>Error
        Handling</strong>:</p><ul><li><p>Provide appropriate error messages when
        a user attempts to register with an existing identifier, without
        revealing whether the identifier is already in
        use.</p></li></ul></li><li><p><strong>Security
        Audits</strong>:</p><ul><li><p>Regularly audit the registration process
        and other critical parts of the application for security
        vulnerabilities.</p></li></ul></li><li><p><strong>Logging and
        Monitoring</strong>:</p><ul><li><p>Implement logging and monitoring to
        detect and respond to suspicious registration
        activities.</p></li></ul></li></ul>
      references:
        - >-
          https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/03-Identity_Management_Testing/02-Test_User_Registration_Process
        - >-
          https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/05-Authorization_Testing/03-Testing_for_Privilege_Escalation
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
  priority: 4
  remediationComplexity: 2
  details:
    - locale: EN
      title: 'WSTG-BUSL-03: Integrity Checks'
      description: >-
        <p>Many applications are designed to display different fields depending
        on the user or situation by leaving some inputs hidden. However, in many
        cases it is possible to submit hidden field values to the server using a
        proxy. In these cases the server-side controls must be smart enough to
        perform relational or server-side edits to ensure that the proper data
        is allowed to the server based on user and application specific business
        logic. The same holds true for received data. This should only be the
        data needed for the current task and not over-expose information to the
        user.</p><p>Additionally, the application must not depend on
        non-editable controls, drop-down menus or hidden fields for business
        logic processing because these fields remain non-editable only in the
        context of the browsers. Users may be able to edit their values using
        proxy editor tools and try to manipulate business logic. If the
        application exposes values related to business rules like quantity, etc.
        as non-editable fields, it must maintain a copy on the server-side and
        use the same for business logic processing. Finally, aside from
        application/system data, log systems must be secured to prevent read,
        writing, and updating.</p><p>Business logic integrity check
        vulnerabilities are unique in that these misuse cases are application
        specific and if users are able to make changes, one should only be able
        to write or update/edit specific artifacts at specific times as per the
        business process logic. At the same time only access to the info needed
        for the current task must be reflected by the application.</p><p>The
        application must be smart enough to check for relational edits and not
        allow users to submit information directly to the server that is not
        valid, trusted because it came from a non-editable controls or the user
        is not authorized to submit through the frontend. Additionally, system
        artifacts such as logs must be “protected” from unauthorized read,
        writing and removal.</p>
      observation: <p></p><p></p>
      remediation: >-
        <p>Restrict access to sensitive functions to only authorized
        users.<br>Restrict access to API documentation.<br>Restrict the amount
        of data that is reflected to the minimum that is needed to fulfill the
        current task.</p>
      references:
        - >-
          https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/10-Business_Logic_Testing/03-Test_Integrity_Checks
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:H/A:L
  details:
    - locale: EN
      title: Structural Findings
      description: >-
        <p>This finding is to aggregate structural findings that came up during
        the engagement but that do not fit into the OWASP categories.</p>
      references: []
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N
  priority: 3
  remediationComplexity: 2
  details:
    - locale: EN
      title: 'WSTG-SESS-01: Session Management'
      description: >-
        <p><strong>Session management</strong> is a fundamental aspect of web
        application security. It involves creating, maintaining, and securely
        managing sessions between a user and a web server during interactions.
        One common method of session management involves issuing a
        <strong>session ID</strong> (e.g., <code>PHPSESSID</code>) to a user,
        which is stored in a cookie and sent with each request to identify the
        user’s session on the server.</p><p>Key aspects of proper session
        management include:</p><ul><li><p><strong>Secure Session ID
        generation</strong>: Session IDs must be <strong>random,
        unique</strong>, and <strong>cryptographically secure</strong> to
        prevent guessing or prediction.</p></li><li><p><strong>Session ID
        lifecycle management</strong>: Session IDs should be
        <strong>regenerated</strong> upon login and after privilege escalation
        to avoid session fixation.</p></li><li><p><strong>Cookie
        attributes</strong>: Use secure cookie attributes like
        <code>HttpOnly</code>, <code>Secure</code>, and <code>SameSite</code> to
        prevent client-side access (e.g., via JavaScript) and restrict cookie
        transmission to trusted channels
        (HTTPS).</p></li></ul><p><strong>Implications of Improper Session
        Management</strong></p><p>When session management is improperly
        implemented, it can lead to several serious vulnerabilities, such
        as:</p><ul><li><p><strong>Session Fixation</strong>: An attacker can
        provide a user with a predetermined session ID, which continues to be
        used after the user logs in. The attacker can then hijack the session
        using the fixed ID.</p></li><li><p><strong>Session Hijacking</strong>:
        If the session ID is predictable or vulnerable to interception (e.g.,
        via insecure cookies or over HTTP), an attacker can impersonate the
        victim by using their session ID.</p></li><li><p><strong>Session
        Expiration Issues</strong>: If sessions don't expire or regenerate
        appropriately, attackers can reuse old session IDs to gain unauthorized
        access, even after a legitimate session ends.</p></li></ul>
      remediation: >-
        <ul><li><p><strong>Regenerate Session IDs</strong>: Regenerate the
        session ID (e.g. <code>session_regenerate_id()</code> in PHP) after
        critical actions like login to prevent session
        fixation.</p></li><li><p><strong>Secure Session ID Generation</strong>:
        Ensure that session IDs are <strong>random</strong> and
        <strong>unique</strong>, using a strong random generator to prevent
        attackers from guessing or setting arbitrary session
        IDs.</p></li><li><p><strong>Enforce server-side session ID
        generation</strong>: Ensure that session IDs are always generated by the
        server, not accepted from clients.</p></li><li><p><strong>Use Secure
        Cookie Settings</strong>:</p><ul><li><p><code>HttpOnly</code>: Prevents
        JavaScript from accessing the session
        cookie.</p></li><li><p><code>Secure</code>: Ensures cookies are only
        sent over HTTPS.</p></li><li><p><code>SameSite</code>: Mitigates
        cross-site request forgery (CSRF) attacks by limiting cross-origin
        cookie requests.</p></li></ul></li><li><p><strong>Session Expiration and
        Timeout</strong>: Implement proper <strong>session timeout</strong>
        policies and force logout after inactivity to minimize the risk of
        session hijacking.</p></li></ul><p>By enforcing these practices, you
        reduce the attack surface and ensure secure session handling.</p>
      references:
        - >-
          https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/06-Session_Management_Testing/01-Testing_for_Session_Management_Schema
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N
  priority: 2
  remediationComplexity: 2
  details:
    - locale: EN
      title: 'WSTG-BUSL-02: Ability to Forge Requests'
      description: >-
        <p>Forging requests is a method that attackers use to circumvent the
        front end GUI application to directly submit information for back end
        processing. The goal of the attacker is to send HTTP POST/GET requests
        through an intercepting proxy with data values that is not supported,
        guarded against or expected by the applications business logic. Some
        examples of forged requests include exploiting guessable or predictable
        parameters or expose “hidden” features and functionality such as
        enabling debugging or presenting special screens or windows that are
        very useful during development but may leak information or bypass the
        business logic.</p><p>Vulnerabilities related to the ability to forge
        requests is unique to each application and different from business logic
        data validation in that it s focus is on breaking the business logic
        workflow.</p><p>This vulnerability type is particularly risky because it
        can lead to unauthorized actions,
        including:</p><ul><li><p><strong>Unauthorized Access or
        Operations</strong>: Attackers may manipulate requests to gain access to
        restricted resources or
        functionality.</p></li><li><p><strong>Transaction Manipulation</strong>:
        This can allow for unauthorized changes in transaction amounts,
        quantities, or prices, leading to financial
        losses.</p></li><li><p><strong>Workflow Bypass</strong>: Forging
        requests can let attackers skip necessary validation or authorization
        steps in a multi-step process.</p></li></ul>
      remediation: >-
        <p>To protect against forged requests, organizations can implement
        several defenses:</p><ul><li><p><strong>Session and Token
        Validation</strong>:</p><ul><li><p>Use secure, unique tokens (e.g., CSRF
        tokens) for each request to validate session
        authenticity.</p></li></ul></li><li><p><strong>Strict Server-Side
        Validation</strong>:</p><ul><li><p>Validate all user actions on the
        server side, including roles, permissions, and expected parameter
        values, to prevent unauthorized
        changes.</p></li></ul></li><li><p><strong>Replay Detection
        Mechanisms</strong>:</p><ul><li><p>Implement nonce values, request
        timeouts, and monitoring to identify and block repeated or suspicious
        requests.</p></li></ul></li><li><p><strong>Logging and
        Monitoring</strong>:</p><ul><li><p>Log requests and analyze traffic
        patterns to detect unusual behavior that may indicate request forgery
        attempts.</p></li></ul></li></ul>
      references:
        - >-
          https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/10-Business_Logic_Testing/02-Test_Ability_to_Forge_Requests
      customFields: []
  category: Web Pentest
- cvssv3: null
  details:
    - locale: EN
      title: 'WSTG-INFO-05: Information Leakage'
      description: >-
        <p>Information leakage occurs when a web application unintentionally
        exposes sensitive details through responses, error messages, HTTP
        headers, source code comments, or API responses. This type of disclosure
        can reveal internal system architecture, software versions, database
        structures, or even user data, which can be exploited by attackers to
        map the system and identify vulnerabilities. Even seemingly harmless
        leaks can aid in reconnaissance, making it easier for attackers to craft
        targeted attacks such as SQL injection, authentication bypasses, or
        privilege escalation.</p>
      remediation: >-
        <p>To prevent information leakage, one should:</p><ul><li><p>Not expose
        any sensitive information to a broader audience than needed. Apply the
        principle of least privilege.</p></li><li><p>Implement generic error
        messages that do not reveal system details.</p></li><li><p>Disable
        debugging and verbose logging in production
        environments.</p></li><li><p>Restrict excessive data exposure in API
        responses and ensure only necessary information is
        returned.</p></li><li><p>Configure HTTP headers to avoid disclosing
        sensitive details such as server versions.</p></li><li><p>Regularly
        audit the application for unintended disclosures using manual reviews
        and automated security testing tools.</p></li></ul>
      references:
        - >-
          https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/01-Information_Gathering/05-Review_Webpage_Content_for_Information_Leakage
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N
  details:
    - locale: EN
      title: 'WSTG-CONF-12: Content Security Policy (CSP)'
      vulnType: Pentest
      description: >-
        <p><strong>Content Security Policy (CSP)</strong> is a security standard
        introduced to help mitigate client-side attacks, particularly
        <strong>Cross-Site Scripting (XSS)</strong> and <strong>data injection
        vulnerabilities</strong> in modern web applications. CSP works by
        allowing a web application to define a whitelist of trusted content
        sources that browsers are permitted to load for specific content types,
        such as scripts, stylesheets, images, and frames.</p><p>By enforcing a
        strict CSP, applications can significantly reduce the risk of malicious
        content being executed in the context of the user’s browser — even in
        the presence of underlying vulnerabilities. CSP also provides protection
        against attacks like <strong>malicious script injection</strong>,
        <strong>clickjacking</strong>, and <strong>data exfiltration to
        third-party servers</strong>.</p><p>Proper implementation of CSP is
        considered a defense-in-depth measure, complementing input validation
        and output encoding mechanisms.</p><p><strong>Security Implications of a
        Missing or Weak CSP</strong></p><ul><li><p>Increases exposure to
        <strong>XSS</strong> attacks, even in cases where sanitization
        fails.</p></li><li><p>Allows <strong>execution of untrusted third-party
        scripts</strong>, including ads, trackers, or malicious
        payloads.</p></li><li><p>Enables <strong>data leakage</strong> through
        external domains or scripts.</p></li><li><p>Provides no restriction on
        <strong>embedding</strong>, which can be used in <strong>UI
        redressing</strong> or <strong>clickjacking</strong>
        scenarios.</p></li></ul>
      observation: <p></p><p></p>
      remediation: >-
        <p>The CSP policy should be hardened to help protect against further
        attacks. Please refer to the reference section for more details.<br>A
        secure CSP policy could look like
        this:<br><code>Content-Security-Policy: default-src 'self'; script-src
        'self' 'nonce-random123'; frame-ancestors 'none'; form-action 'self';
        object-src 'none';</code></p><p><code>nonce-random123</code> ensures
        only scripts with the correct nonce can run, preventing attacks like
        <code>&lt;script&gt;alert(1)&lt;/script&gt;</code>.</p><p><code>script-src
        'self'</code> means only scripts from your own domain are allowed,
        blocking external script execution like <code>&lt;script
        src="http://evil.com/xss.js"&gt;&lt;/script&gt;</code>.</p><p><code>form-action
        'self'</code> prevents forms from being submitted to an external
        site.</p><p><code>frame-ancestors 'none'</code> ensures the site can’t
        be embedded in any iframe.</p>
      references:
        - >-
          https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/12-Test_for_Content_Security_Policy
        - >-
          https://cheatsheetseries.owasp.org/cheatsheets/Content_Security_Policy_Cheat_Sheet.html
      customFields: []
  category: Web Pentest
- cvssv3: CVSS:3.1/AV:P/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  priority: 3
  remediationComplexity: 2
  details:
    - locale: EN
      title: MIFARE Classic - Authentication by UID only
      vulnType: Pentest
      description: >-
        <p>Each NFC tag has a unique ID (UID). This UID can be read by everyone
        and is not protected in the case of MIFARE Classic tags.<br>Systems can
        be configured to only check the UID as an authentication feature, where
        no validation against data in the tag's encrypted sectors is taking
        place.<br><br>All an attacker would need to do is “touch” an ID tag with
        e.g., a Flipper Zero or other according hardware to fetch the UID. Think
        of standing in an elevator, the keycard on a lanyard, and just walking
        by your target. After successfully fetching the UID, it would be
        possible to impersonate that user granting access to all his resources.
        <br>This might be doors, gates, hotel rooms, a skiing-pass, student ID
        or a printing solution. <br><br>Another way of attacking such weak
        implementations is a brute force attack against the UID. This might
        obviously take a long time, but nevertheless poses a risk.</p>
      observation: <p></p><p></p>
      remediation: >-
        <p>One point to address is user awareness. If an attacker cannot “touch”
        the ID card, it cannot be read. This, however, interferes with the
        corporate policy to always wear your badge visibly to everyone. So at
        least outside of the campus, badges should not be worn visibly.<br>The
        other thing is to check whether the solution is capable of not only
        relying on the UID, but rather data that is stored in one of the secured
        sectors. In this course you need to make sure to use safe technology
        like <em>MIFARE DESFire</em>, as for example the MIFARE Classic
        technology is broken and full of security flaws.</p>
      references: []
      customFields: []
  category: Physical Security
- cvssv3: CVSS:3.1/AV:P/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  priority: 3
  remediationComplexity: 3
  details:
    - locale: EN
      title: Usage of MIFARE Classic technology
      vulnType: Pentest
      description: >-
        <p>In 2008 the proprietary encryption algorithm <em>CRYPTO-1</em>,
        developed by NXP, was completely reverse engineered by the Radboud
        University Nijmegen [1]. <br>In 2009, the MIFARE Classic Offline Cracker
        (MFOC) was released, wrapped around the so called nested attack which
        makes it possible to recover all sector encryption keys when only one
        key is known. <br>Following was the <em>MFCUK-MiFare Classic Universal
        toolkit</em>, which allowed to retrieve a valid key, even if no key was
        known at all.<br>The answer to these flaws was the release of the
        <em>MIFARE Classic EV1</em> tags as well as the MIFARE DESFire tags by
        NXP, which had several security improvements over the original
        implementation.<br>However, in 2015 the <em>hardnested attack [2]</em>
        was published, which allowed to even crack these hardened tags open by a
        side-channel attack.</p><p>As soon as an attacker gets a hold on a
        vulnerable tag, he can recover all keys, access all sectors, tamper with
        the content, and clone the tag.<br>Attack scenarios might include a lost
        tag or stolen tag, a cloned tag or even an inside
        attacker.</p><p>Another way of abuse involves just having the UID of a
        card (read in a second with a Flipper Zero or Proxmark3) and emulate it
        to collect encrypted nonces [3] from a valid reader to later be able to
        offline crack the encryption keys. In some cases this is not sufficient
        and an attacker needs to sniff traffic from a legit card and reader to
        successfully collect the nonces.</p>
      observation: <p></p><p></p>
      remediation: >-
        <p>According to NXP <em>MIFARE Classic</em> cards are no longer
        considered save [4] and should not be used anymore, when it comes to
        managing access rights or other security relevant implementations. The
        most modern successor is <em>MIFARE DESFire</em>. </p>
      references:
        - >-
          [1]
          https://www.researchgate.net/publication/1915327_A_practical_attack_on_the_MIFARE_classic
        - >-
          [2]
          http://www.cs.ru.nl/R.Verdult/Ciphertext-only_Cryptanalysis_on_Hardened_Mifare_Classic_Cards-CCS_2015.pdf
        - '[3] https://github.com/equipter/mfkey32v2'
        - >-
          [4]
          https://www.mifare.net/en/products/chip-card-ics/mifare-classic/security-statement-on-crypto1-implementations/
      customFields: []
  category: Physical Security
- cvssv3: CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L
  priority: 2
  remediationComplexity: 1
  details:
    - locale: EN
      title: Shared platform usage
      vulnType: Pentest
      description: >-
        <p>Running services with shared resources carries the risk that if one
        of the apps is vulnerable or exploitable, all others are at risk as
        well. More services most likely means that more users have access to the
        system, but these user don't necessary have the rights to access the
        other solutions running on that system. However, the compromise of the
        user of another service, might give an attacker a first foothold on the
        shared system, which later might result in a full compromise of all
        hosted services.</p><p>For critical service like e.g. a Certificate
        Authority, Domain Services, Backup solutions, it is best practice to
        have them running on dedicated systems.</p>
      remediation: <p>Migrate the affected service to a dedicated platform.</p>
      references: []
      customFields: []
  category: Internal Pentest
- cvssv3: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  priority: 3
  remediationComplexity: 3
  details:
    - locale: EN
      title: Missing Network Seperation
      vulnType: Pentest
      description: >-
        <p>Using network segmentation and separation together offers an
        additional level of security to systems and data. <br>A robust ‘defense
        in depth’ network enhances security by physically and virtually ensuring
        data flow and connectivity within networks is for known and approved
        connections only. It controls who can access which resource from
        where.</p><ul><li><p>Network segmentation involves breaking down an
        organization's network into smaller networks, using DMZ’s and other
        logical segmentation (like Production/Test) to logically segment
        processing activity.</p></li><li><p>Network separation means using
        different access controls to allow connections across these smaller
        networks. This can be by employing different technologies and filters to
        further control data flow.</p></li></ul><p>These measures make it harder
        for an attacker to move laterally and access unwanted and critical
        resources, once he gained an initial foothold in the internal
        network.<br><br>Access to critical infrastructure like Domain
        Controllers, Certificate Authorities, Backup solutions and alike, should
        be secured as much as possible.</p>
      remediation: >-
        <p>Systems that can be accessed from the Internet should always be
        placed in a demilitarized zone (DMZ), as these systems are exposed to an
        increased risk.</p><p>It is recommended to divide the systems into
        different TIER levels, in which the sensitivity and criticality of the
        servers is differentiated. Direct access by clients to services is
        enabled in a specific TIER level, the other TIER levels can only be
        accessed from the next lower level and are separated in each
        case.</p><p>The bare minimum that should be implemented is a network
        separation between the client and server networks. This will better
        protect the server network from automated attacks by executed malware
        (for example, ransomware) on clients, as well as from network
        attacks.</p>
      references:
        - >-
          https://learn.microsoft.com/en-us/security/compass/privileged-access-access-model
      customFields: []
  category: Internal Pentest
- cvssv3: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
  priority: 3
  remediationComplexity: 1
  details:
    - locale: EN
      title: SMB Signing not activated
      vulnType: Vulnerability Scan
      description: >-
        <p>SMB (Server Message Block) signing is a security feature that is used
        to digitally sign SMB packets to ensure their authenticity and
        integrity. <br>This helps to prevent man-in-the-middle (MitM) attacks,
        where an attacker intercepts and modifies SMB packets in transit, by
        allowing the recipient to verify that the packets were sent by an
        authenticated sender and have not been tampered with. <br>The most
        widely known attack that abuses the lack of SMB signing is
        relaying.<br>SMB signing can be enabled or disabled on both the client
        and server side and is supported on Windows Server and Windows client
        operating systems. It is typically used in enterprise environments to
        secure file sharing and other types of data transfer over the
        network.</p>
      remediation: >-
        <p>SMB signing should be enabled and enforced on both the client and
        server side.</p>
      references:
        - https://luemmelsec.github.io/Relaying-101/
      customFields: []
  category: Internal Pentest
- cvssv3: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:N
  priority: 1
  remediationComplexity: 1
  details:
    - locale: EN
      title: Usage of untrusted Certificates
      vulnType: Vulnerability Scan
      description: >-
        <p>The reason that a certificate is considered untrustworthy can have
        different causes. In the following scenarios, a certificate might be
        detected as not valid:</p><ul><li><p>The server's certificate does not
        have a valid certificate chain to a trusted root certificate authority.
        This happens if the certificate was issued by an unrecognized
        certificate authority, if the certificate is a self-signed certificate,
        or if an intermediate certificate is missing from the certificate
        chain.</p></li><li><p>The commonName (CN) parameter of the certificate
        does not match the domain name of the server. This might happen if the
        IP is used instead for the DNS name.</p></li><li><p>The signature of the
        certificate could not be verified.</p></li><li><p>A certificate is
        invalid if the server's certificate has expired, i.e. during
        verification the certificate's valid date range does not match the
        current date.</p></li></ul><p>These issues make it difficult for users
        to verify the certificate and increase the risk of Man-in-the-Middle
        attacks.</p>
      remediation: >-
        <p>Create and apply trusted certificates.<br>Internet facing systems
        should have a certificate signed by a 3rd party trusted public CA.</p>
      references: []
      customFields: []
  category: Internal Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
  priority: 2
  remediationComplexity: 2
  details:
    - locale: EN
      title: Unauthenticated User Enumeration over SMB - CVE-2000-1200
      vulnType: Vulnerability Scan
      description: >-
        <p>Windows NT allows remote attackers to list all users in a domain by
        obtaining the domain SID with the <em>LsaQueryInformationPolicy</em>
        policy function via a null session and using the SID to list the
        users.</p>
      remediation: >-
        <p>Contact the vendor to see if appropriate settings, updates or fixes
        are available.</p>
      references:
        - https://nvd.nist.gov/vuln/detail/CVE-2000-1200
      customFields: []
  category: Internal Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  priority: 4
  remediationComplexity: 1
  details:
    - locale: EN
      title: Extremely weak Admin Credentials
      vulnType: Pentest
      description: >-
        <p>Accounts with critical privileges like Domain Admins, Firewall
        Admins, Backup Admins and alike should always be handled with care and
        secured accordingly.<br>People using these accounts need to be aware of
        the potential risks that arise when their accounts get
        compromised:</p><ul><li><p>Data breaches and theft of sensitive
        information: If a hacker gains access to an administrative account, they
        may be able to view, steal or manipulate confidential data stored on the
        system, such as personal information, financial records, or trade
        secrets.</p></li><li><p>System damage and disruption of services: The
        attacker may use the administrative privileges to cause harm to the
        system, for example, by deleting critical files, modifying system
        settings, or shutting down servers. This could result in significant
        downtime and disruption of services for the organization and its
        customers.</p></li><li><p>Spread of malware and further compromise: The
        attacker may use the compromised administrative account to install
        malware, such as viruses, Trojans, or ransomware, which can spread to
        other systems and devices on the network, leading to additional security
        breaches and compromise. This could result in significant damage to the
        organization's reputation and financial loss.</p></li></ul><p>In this
        case the password complexity of these administrative accounts must be
        rated as extremely weak. <br>The password is either guessable or if an
        attacker gets a hold on hashed material easily recoverable.</p>
      remediation: >-
        <p>Privileged accounts should have extremely strong passwords. They
        should be at least 20 characters long, and comply to complexity with
        uppercase, lowercase, numbers and special characters. The passwords
        should be randomly generated, no words! Password blacklisting can be
        issued to help here.<br>Password reusage should be avoided at all
        costs.<br>Personal holding higher privileges needs to be trained and
        made aware of the possible risks. <br>Saving credentials in a Web
        Browser should also be avoided.<br>Additionally these accounts should be
        hardened via Multi Factor Authentication where possible.</p>
      references: []
      customFields: []
  category: Internal Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  priority: 3
  remediationComplexity: 3
  details:
    - locale: EN
      title: Deficient Roles and Authorization Concept
      vulnType: Pentest
      description: >-
        <p>A Roles and Authorization Concept purpose is to restrict access to
        sensitive resources as much as possible.<br>This can be achieved through
        appropriate measures like e.g.:</p><ul><li><p>Limiting the number of
        users that have access to the resource</p></li><li><p>Limiting the
        access rights to the absolute minimum each user needs - concept of least
        privilege</p></li><li><p>Limiting the sources which have access - e.g.
        from where can a valid user access an
        application</p></li><li><p>Defining a password policy and MFA
        requirements</p></li></ul><p></p>
      remediation: >-
        <p>Implement a sufficient and secure Roles and Authorization
        concept.<br>Review the access rights to the systems.<br>Change
        passwords.<br>Follow best practices like the TIER model from
        Microsoft.</p>
      references:
        - >-
          https://learn.microsoft.com/en-us/security/privileged-access-workstations/privileged-access-access-model
      customFields: []
  category: Internal Pentest
- cvssv3: CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:L/I:L/A:N
  priority: 3
  remediationComplexity: 1
  details:
    - locale: EN
      title: Outdated Software
      vulnType: Pentest
      description: >-
        <p>Used soft- and firmware as well as operating systems should always be
        kept to the most current versions.</p><p>Using outdated versions poses
        several direct and indirect security risks like:<br>- Security
        vulnerabilities: outdated software may have unpatched security holes
        that can be exploited by attackers.<br>- Compatibility issues: new
        hardware or software may not be compatible with old systems.<br>-
        Performance degradation: outdated software may run slower, become less
        responsive, or crash more often.<br>- Lack of features: newer software
        may have additional features or improvements that are not available in
        older versions.<br>- Compliance problems: outdated software may not meet
        industry regulations or standards.<br><br>So staying up to date is a
        mandatory requirement to a matured security culture and should be part
        of the patch management process.<br></p>
      observation: >-
        <p><br>Criticality depending on what could be achieved due to systems
        and software being outdated.</p>
      remediation: >-
        <p>Check if any of the mentioned software components can be upgraded /
        updated and if important security updates are missing.<br>Implement a
        patch management strategy and process that ensures that all your systems
        are up to date and that updates are applied timely according to their
        criticality.<br>Apply workarounds when no patches are available when
        tackling critical flaws.</p>
      references:
        - ''
      customFields: []
  category: Internal Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
  priority: 3
  remediationComplexity: 2
  details:
    - locale: EN
      title: Password Requirements
      vulnType: Pentest
      description: >-
        <p>Using weak passwords has several security implications and is posing
        one of the biggest risks in the IT security threat landscape with the
        following impacts:<br></p><ul><li><p>Easy to guess: Bad passwords are
        often easily predictable, making it easier for hackers to guess or crack
        them.</p></li><li><p>Dictionary attacks: Poor passwords are susceptible
        to dictionary attacks, where a hacker uses a list of commonly used
        passwords to gain access to an account.</p></li><li><p>Brute force
        attacks: In a brute force attack, a hacker tries every possible
        combination of characters to crack a password, making a weak password
        easier to crack.</p></li><li><p>Reuse: People often reuse the same
        password across multiple accounts, putting all their information at risk
        if a single password is compromised.</p></li><li><p>...</p><p></p><p>If
        the passwords used by the users are not complex enough they can easily
        be guessed or the clear text passwords can trivially be recovered if an
        attacker gets access to their hashed values.</p></li></ul>
      remediation: >-
        <p>The following settings and measures can help to harden access to
        users and their credentials:</p><ul><li><p>Implementing multi-factor
        authentication.</p></li><li><p>Implementing a secure domain wide
        password policy in case of Active Directory. At least 12 characters for
        low privileged and 14 characters for high privileged accounts. For
        service accounts at least 20 characters should be
        used.</p></li><li><p>Using a password manager. Best in combination with
        the possibility for fine granular rights management and MFA
        authentication.</p></li><li><p>Password blacklisting. Ban passwords with
        the company name, seasons, passwords on leaked lists
        etc.</p></li><li><p>Implementing password policies based on the access
        rights of the accounts affected.</p></li><li><p>Regular password
        audits.</p></li><li><p>User awareness campaigns. Especially security
        related trainings for technical staff.</p><p></p></li></ul><p>Best
        practices for the Domain Password
        Policy:</p><ul><li><p>ComplexityEnabled =
        True</p></li><li><p>LockoutDuration &gt;= 15
        Minutes</p></li><li><p>LockoutObservationWindow &gt;= 15
        Minutes</p></li><li><p>LockoutThreshold &lt;= 10
        Minutes</p></li><li><p>MinPasswordLength &gt;=
        12</p></li><li><p>ReversibleEncryptionEnabled =
        False</p></li></ul><p><br></p>
      references: []
      customFields: []
  category: Internal Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L
  priority: 2
  remediationComplexity: 2
  details:
    - locale: EN
      title: Management Service Misconfiguration
      vulnType: Pentest
      description: >-
        <p>Management services like SSH, RDP, Telnet, WinRM etc. are meant for
        administrative purposes of systems and applications.<br>Access to those
        services should be restricted as much as possible to follow the
        defense-in-depth approach as well as the least privilege
        principle.<br>Even if not currently affected by a directly exploitable
        vulnerability, they at least pose the risk of being accessed with stolen
        / impersonated identities.</p>
      remediation: >-
        <p>Access to management services and their according ports should be
        restricted by means of network separation or (local) firewalls. <br>Most
        of these services offer hardened authentication methods and settings
        like certificate based authentication for SSH or restricted host polices
        for access to WinRM [1][2].<br>Systems ideally reside in a dedicated
        management VLAN to which only the needed systems and people can connect
        to.</p>
      references:
        - >-
          [1]
          https://learn.microsoft.com/en-us/windows/win32/winrm/authentication-for-remote-connections
        - >-
          [2]
          https://learn.microsoft.com/en-us/windows/win32/winrm/installation-and-configuration-for-windows-remote-management
      customFields: []
  category: Internal Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
  priority: 2
  remediationComplexity: 2
  details:
    - locale: EN
      title: Servers with Internet Access
      vulnType: Pentest
      description: >-
        <p>Not restricting internet access to systems poses several potential
        security risks like:</p><ul><li><p>Malware can be downloaded directly
        onto the system's disk</p></li><li><p>Malware can be downloaded directly
        into the system's memory</p></li><li><p>The system can be connected and
        controlled via an internet hosted Command &amp; Control server or a
        Botnet</p></li></ul><p>Especially servers that don't necessarily need
        access to the internet should not be given these possibilities.<br></p>
      remediation: >-
        <p>Internet access must only be granted if absolutely necessary.<br>If
        needed, there should be dedicated communication-matrix and only targets
        that need to be reachable should me made available.<br>If really needed,
        the internet traffic should be routed through a firewall or proxy that
        analyzes the dataflow and connections made. <br>It should be able to
        block access and isolate the host in case something suspicious pops
        up.</p>
      references: []
      customFields: []
  category: Internal Pentest
- cvssv3: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:L
  priority: 3
  remediationComplexity: 1
  details:
    - locale: EN
      title: General Observations Work Ethics
      vulnType: Pentest
      description: >-
        <p>Sensitive files should always be handled with care. Cleaning up when
        files are no longer used is an essential part of work ethics.</p><p>For
        attackers, valuable information residing inside such files comes in
        handy and can drastically expose further services and systems, allowing
        for privilege escalation or lateral movement.</p>
      observation: >-
        <p>Critically dependant on the info found and according
        possibilities</p>
      remediation: >-
        <p>Technical staff should be trained and forced to clean up after their
        work is done.<br>Leaving sensitive info exposed on systems is bad
        practice and should be avoided at all costs.</p>
      references: []
      customFields: []
  category: Internal Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
  priority: 3
  remediationComplexity: 2
  details:
    - locale: EN
      title: General Observations in regard to Alerts
      vulnType: Pentest
      description: >-
        <p>Critical systems and events should be monitored closely to be able to
        react on a shorthand if something bad happens.</p><p>Having visibility
        inside the whole network is a crucial fundamental of a matured
        IT-Security strategy.</p>
      observation: <p></p><p></p>
      remediation: >-
        <p>Logs and events need to be monitored closely. If critical alerts show
        up, according investigations and countermeasures need to take place.</p>
      references: []
      customFields: []
  category: Internal Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  priority: 4
  remediationComplexity: 3
  details:
    - locale: EN
      title: MSSQL Features xp_*** available to low privileged Users
      vulnType: Pentest
      description: >-
        <p>xp_cmdshell, xp_dirtree and xp_fileexist are MSSQL native extended
        stored procedures. While xp_cmdshell allows for executing shell
        commands, the latter ones are aimed at file and directory
        operations.</p><p>xp_cmdshell: This extended stored procedure enables
        the execution of operating system commands from within SQL Server. If
        accessible to low privilege users, it poses significant security risks.
        Exploiting xp_cmdshell, an attacker can execute arbitrary commands on
        the server's operating system with the permissions of the SQL Server
        service account. This can lead to unauthorized actions, such as
        accessing or modifying sensitive files, compromising the system, or even
        gaining full control over the server.</p><p>xp_dirtree and xp_filexist
        can be executed by members of the Public role by default in SQL Server
        2000-2014. The public role is essentially a group that includes all
        database users by default. Both can be used to force the SQL Server
        service account to authenticate to a remote attacker.&nbsp; The service
        account password hash can then be captured + cracked or relayed to gain
        unauthorized access to systems. This also means they can be used to
        escalate a lower privileged user to sysadmin when a machine or managed
        account isn't being used.&nbsp;That's because the SQL Server service
        account is a member of the sysadmin role in SQL Server 2000-2014, by
        default. Also, if the service accounts happen to be local administrators
        on the servers themselves, an attacker can takeover those as well.</p>
      remediation: >-
        <p>There are several points to take into consideration
        here:</p><ul><li><p>It must URGENTLY be avoided to reuse service
        accounts. If really needed, there should be a dedicated service account
        per SQL server. If possible the computeraccount should be used.
        Alternateively managed service accounts per instance.</p></li><li><p>It
        must URGENTLY be avoided that (MSSQL) service accounts also hold local
        admin rights on servers. This needs to be checked on ALL (not only the
        ones listed) servers.</p></li><li><p>ALL (not only the ones listed)
        instances where the xp_ procedures are available to low privileged users
        have to be identified and the permissions need to be adjusted according
        to the principle of least privilege.</p></li><li><p>ALL (not only the
        ones listed) instances where ALL domain users have access to have to be
        identified and evaluated if those broadly applied rights are really
        needed. Adjustment has to be made according to the principle of least
        privilege.</p></li><li><p>SMB Signing MUST be enabled on ALL servers,
        not only MSSQL servers. Best would be to do it domain wide, also on
        clients.</p></li><li><p>Robust AV MUST be in place that prevents attacks
        via malware.</p></li><li><p>Monitoring for critical events MUST be in
        place and reactions and countermeasures MUST take place
        immediately.</p></li><li><p>TIERing MUST be implemented. Access to
        servers is to be applied according to the principle of least
        privilege.</p></li></ul>
      references:
        - https://www.offsec-journey.com/post/attacking-ms-sql-servers
        - >-
          https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/abusing-ad-mssql
      customFields: []
  category: Internal Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
  priority: 4
  remediationComplexity: 3
  details:
    - locale: EN
      title: Shared Service Accounts
      vulnType: Pentest
      description: >-
        <p>Using shared service accounts can pose security risks due to the
        following reasons:</p><ul><li><p>Lack of Accountability: When multiple
        services or applications use the same service account, it becomes
        difficult to determine which service or application performed a
        particular action. This lack of accountability can hinder incident
        response and make it challenging to identify the source of unauthorized
        or malicious activities.</p></li><li><p>Overprivileged Access: Shared
        service accounts often have elevated privileges to perform various tasks
        across different systems or applications. If an attacker gains access to
        a shared service account, they inherit all the privileges associated
        with it, potentially granting them widespread access to sensitive data
        or critical systems. The principle of least privilege is compromised
        when using shared service accounts, as multiple services may have more
        access than they actually require.</p></li><li><p>Password Management
        Challenges: Shared service accounts typically have long lifetimes and
        are seldom changed or updated, which increases the risk of password
        compromise. If the password for a shared service account is compromised,
        all the services using that account are also compromised. Additionally,
        updating the password for a shared service account can be challenging
        due to its wide usage, leading to delayed or neglected password
        changes.</p></li><li><p>Difficulty in Monitoring and Auditing:
        Monitoring and auditing become more challenging when multiple services
        share the same account. It becomes difficult to attribute specific
        actions to individual services or track activities associated with the
        account. This can impede security investigations, compliance audits, and
        the ability to detect and respond to security incidents
        effectively.</p></li><li><p>Dependency Risks: When multiple services
        rely on a shared service account, any disruption or compromise of the
        account can have a cascading effect on all the dependent services. A
        single security incident or misconfiguration can result in widespread
        service disruptions or unauthorized access to critical
        systems.</p></li></ul>
      remediation: >-
        <p>To mitigate these risks, it is generally recommended to use
        individual service accounts with unique credentials for each service or
        application. This allows for better accountability, enables fine-grained
        access control, simplifies auditing and monitoring, and reduces the
        impact of a compromised account to a single service or application.</p>
      references: []
      customFields: []
  category: Internal Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
  priority: 2
  remediationComplexity: 1
  details:
    - locale: EN
      title: SPN Remnants
      vulnType: Pentest
      description: >-
        <p>SPN stands for Service Principal Name, and it is a concept in a
        Windows environment, particularly within Active Directory (AD). An SPN
        is a unique identifier for a service instance that runs under a specific
        user account. It is used by clients to identify and authenticate the
        service they are trying to access.</p><p>Here are some key points about
        SPNs in a Windows environment/AD:</p><ul><li><p>Purpose: The primary
        purpose of an SPN is to associate a service with a specific account in
        order to facilitate mutual authentication. When a client wants to
        communicate with a service, it can use the SPN to locate and
        authenticate the service.</p></li><li><p>Format: An SPN is composed of
        two parts: the service class and the service name, separated by a
        forward slash (/). The service class identifies the type of service,
        such as "HTTP" for a web service or "MSSQLSvc" for a SQL Server service.
        The service name is the fully qualified domain name (FQDN) or the
        NetBIOS name of the server hosting the service.</p></li><li><p>Unique
        Identifiers: Each service instance running under a specific user account
        should have a unique SPN associated with it. This allows clients to
        differentiate between different instances of the same service running on
        different servers.</p></li><li><p>Kerberos Authentication: SPNs are
        primarily used with Kerberos authentication in a Windows environment.
        When a client needs to authenticate to a service using Kerberos, it
        requests a ticket-granting ticket (TGT) from the Key Distribution Center
        (KDC) using the SPN associated with the service. The SPN helps the KDC
        locate the appropriate service account to authenticate the client
        against.</p></li><li><p>Registering SPNs: Service accounts can register
        their SPNs automatically or manually. Automatic registration occurs when
        services start up and utilize the Network Service or Local System
        accounts. Manual registration is required when using custom service
        accounts.</p></li><li><p>Duplicate SPNs: Each SPN must be unique within
        a domain to avoid conflicts. Duplicate SPNs can cause authentication
        failures or unpredictable behavior. It's important to ensure that
        different services or instances use distinct
        SPNs.</p></li><li><p>Delegation: SPNs also play a role in delegation
        scenarios, where a service needs to forward a client's credentials to
        another service on behalf of the client. Service accounts require proper
        configuration, including the appropriate SPNs and delegation settings,
        to enable secure delegation.</p></li></ul><p>In summary, SPNs in a
        Windows environment/AD are unique identifiers used to associate services
        with specific user accounts for authentication purposes, primarily in
        the context of Kerberos authentication. They help clients locate and
        authenticate the services they want to access while ensuring secure and
        accurate identification of the service instances.<br><br>In some
        circumstances, mainly when SPNs get registered manually with the help of
        the <a target="_blank" rel="noopener noreferrer nofollow"
        href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc731241(v=ws.11)">setspn</a>
        tool, or when the machine is not able to unregister SPNs for several
        reasons while being decommissioned, you might have dead SPNs in your
        environment.<br><br>These dead SPNs can still be used to conduct
        Kerberoasting attacks. When SPNs are tied to use accounts rather than to
        computer objects, it might be the case that the password is weak. With
        the Kerberoasting attack the cleartext credentials can then be
        retrieved.</p>
      observation: >-
        <p>Criticality depends on what is possible.<br>If we can kerberoast
        accounts where no actual service is running but which still have an SPN
        and are admin or sth, this would be high/critical.<br>If they have
        strong passwords and nothing can be done, medium to low.</p>
      remediation: >-
        <p>Remove ALL SPNs that are pointing to systems that no longer exist.
        This has do be done for ALL domains.<br>This can either be done by
        directly changing the <em>servicePrincipalName</em> value of the AD
        objects or by using the <em>setspn</em> command:</p><pre><code>setspn -d
        &lt;SPN&gt; &lt;accountname&gt;  

        setspn -d MSSQL/SQLSERVER1 sqlservice </code></pre>
      references:
        - https://luemmelsec.github.io/Kerberoasting-VS-AS-REP-Roasting/
      customFields: []
  category: Internal Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  details:
    - locale: EN
      title: SAP Gateway ACL Misconfiguration
      vulnType: Vulnerability Scan
      description: >-
        <p>A remote code execution vulnerability exists in the remote SAP
        Gateway as a result of allowing non-SAP applications to communicate
        with, and potentially run OS commands on SAP applications. An
        unauthenticated attacker can run the arbitrary commands on remote server
        to gain access to the system or to read/write sensitive information.</p>
      remediation: >-
        <ul><li><p>Secure your Gateway ACL pointed by profile parameter
        gw/sec_info with help of SAP note 1408081</p></li><li><p>Filter out
        access from untrusted sources to the Gateway (port
        tcp/33NN)</p></li></ul>
      references:
        - https://github.com/chipik/SAP_GW_RCE_exploit
        - https://github.com/gelim/sap_ms
        - >-
          https://blogs.sap.com/2019/05/02/10kblaze-exploit-can-potentially-impact-most-sap-customers/
        - https://www.tenable.com/plugins/nessus/126003
      customFields: []
  category: Internal Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
  priority: 3
  remediationComplexity: 1
  details:
    - locale: EN
      title: Write Access to Network Shares
      vulnType: Pentest
      description: >-
        <p>Network shares with improperly configured write permissions can allow
        unauthorized users to modify, overwrite, or upload malicious files. This
        misconfiguration can lead to:</p><ul><li><p><strong>Data
        Tampering</strong> – Attackers can alter or delete critical
        files.</p></li><li><p><strong>Malware Propagation</strong> – Malicious
        files (e.g., ransomware, trojans) can be uploaded and
        executed.</p></li><li><p><strong>Privilege Escalation</strong> –
        Sensitive scripts or executables can be modified to execute malicious
        code.</p></li><li><p><strong>Data Exfiltration</strong> – Attackers can
        replace legitimate files with fake ones to trick users into revealing
        credentials or sensitive data.</p></li></ul><p>If exploited, write
        access on network shares can result in operational disruptions, data
        loss, and security breaches.</p>
      remediation: >-
        <ul><li><p><strong>Implement the Principle of Least Privilege
        (PoLP)</strong> – Only grant write access to users who need
        it.</p></li><li><p><strong>Regular Permission Audits</strong> –
        Periodically review and restrict write permissions on shared
        folders.</p></li><li><p><strong>Enable Access Control Lists
        (ACLs)</strong> – Define and enforce granular permissions to prevent
        unauthorized modifications.</p></li><li><p><strong>Monitor File
        Activity</strong> – Use logging and alerts to detect unauthorized file
        changes.</p></li><li><p><strong>Disable Guest or Everyone Write
        Access</strong> – Ensure that anonymous or broad user groups do not have
        write privileges.</p></li><li><p><strong>Implement Endpoint
        Protection</strong> – Use antivirus and anti-malware solutions to detect
        suspicious activity on shares.</p></li><li><p><strong>Network
        Segmentation</strong> – Limit exposure by segregating critical shares
        from general user access.</p></li></ul>
      references: []
      customFields: []
  category: Internal Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
  priority: 3
  remediationComplexity: 1
  details:
    - locale: EN
      title: Kerberoasting
      vulnType: Pentest
      description: >-
        <p>Kerberoasting is an attack technique where an attacker with access to
        a Windows domain requests service tickets (TGS) for accounts with
        Service Principal Names (SPNs). These tickets are encrypted with the
        service account's NTLM hash. If the service account has weak
        credentials, the attacker can crack the hash offline and gain
        unauthorized access.</p><p><strong>Security
        Implications:</strong></p><ul><li><p><strong>Privilege
        Escalation</strong> – If a service account has high privileges (e.g.,
        Domain Admin), an attacker can take over the
        domain.</p></li><li><p><strong>Lateral Movement</strong> – Attackers can
        use the compromised account to move deeper into the
        network.</p></li><li><p><strong>Persistence</strong> – Once an attacker
        cracks a service account password, they can maintain long-term
        access.</p></li><li><p><strong>Stealthy Exploitation</strong> – Since
        Kerberoasting doesn’t require direct interaction with the target
        machine, it often evades detection by traditional endpoint security
        tools.</p></li></ul>
      remediation: >-
        <ul><li><p><strong>Use Strong Service Account Passwords</strong> –
        Ensure service accounts have long, complex passwords (25+
        characters).</p></li><li><p><strong>Regular Password Rotation</strong> –
        Frequently change service account passwords to reduce
        exposure.</p></li><li><p><strong>Limit Service Account
        Privileges</strong> – Avoid using high-privilege accounts for services
        unless absolutely necessary.</p></li><li><p><strong>Monitor for Unusual
        Ticket Requests</strong> – Set up alerts for abnormal Kerberos TGS
        requests, especially from non-administrative
        users.</p></li><li><p><strong>Implement Managed Service Accounts (MSAs)
        or Group Managed Service Accounts (gMSAs)</strong> – These automatically
        rotate strong passwords.</p></li><li><p><strong>Enable Kerberos AES
        Encryption</strong> – Use AES-256 encryption instead of weaker RC4 to
        make password cracking more difficult.</p></li><li><p><strong>Reduce
        Exposure of SPNs</strong> – Minimize the number of accounts with SPNs
        registered, and use least privilege
        principles.</p></li><li><p><strong>Detect &amp; Respond</strong> –
        Utilize SIEM solutions to monitor and detect Kerberoasting attempts in
        logs (e.g., Event ID 4769 with RC4 encryption).</p></li></ul>
      references:
        - https://luemmelsec.github.io/Kerberoasting-VS-AS-REP-Roasting/
      customFields: []
  category: Internal Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
  priority: 3
  remediationComplexity: 1
  details:
    - locale: EN
      title: AS-REP Roasting
      vulnType: Pentest
      description: >-
        <p>AS-REP Roasting is an attack against Kerberos authentication in
        Active Directory. It targets accounts with the <strong>"Do not require
        Kerberos preauthentication"</strong> setting enabled. Attackers can
        request an Authentication Service Response (AS-REP) for such accounts,
        which contains an encrypted NTLM hash of the user’s password. The
        attacker can then perform offline password cracking to retrieve the
        plaintext credentials.</p><p><strong>Security
        Implications:</strong></p><ul><li><p><strong>Credential Theft</strong> –
        Weak passwords can be cracked, giving attackers direct access to user or
        service accounts.</p></li><li><p><strong>Privilege Escalation</strong> –
        If a privileged account (e.g., administrator or service account) is
        vulnerable, attackers can gain control over critical
        systems.</p></li><li><p><strong>Lateral Movement</strong> – Compromised
        credentials can be used to move across the network and escalate
        attacks.</p></li><li><p><strong>Stealthy Attack</strong> – Since AS-REP
        requests are legitimate Kerberos operations, they can go unnoticed in
        standard monitoring.</p></li></ul>
      remediation: >-
        <ul><li><p><strong>Disable "Do not require Kerberos
        preauthentication"</strong> – Ensure all accounts require
        preauthentication to prevent AS-REP Roasting.</p></li><li><p><strong>Use
        Strong Passwords</strong> – Enforce long, complex passwords to make
        cracking infeasible.</p></li><li><p><strong>Monitor for Unusual AS-REP
        Requests</strong> – Detect suspicious Kerberos AS-REQ events (Windows
        Event ID <strong>4768</strong> with result code
        <strong>0x0</strong>).</p></li><li><p><strong>Limit Privileges on
        Accounts</strong> – Apply the <strong>Principle of Least Privilege
        (PoLP)</strong> to reduce exposure if an account is
        compromised.</p></li><li><p><strong>Implement Multi-Factor
        Authentication (MFA)</strong> – Protect high-value accounts with MFA to
        add an extra layer of security.</p></li><li><p><strong>Use Group Managed
        Service Accounts (gMSAs)</strong> – Instead of manually created service
        accounts, use gMSAs, which automatically rotate complex
        passwords.</p></li><li><p><strong>Deploy SIEM Solutions</strong> – Use
        security monitoring tools to flag abnormal authentication
        attempts.</p></li></ul>
      references: []
      customFields: []
  category: Internal Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
  priority: 3
  remediationComplexity: 1
  details:
    - locale: EN
      title: Passwords in Description Fields of AD Users
      vulnType: Pentest
      description: >-
        <p>Some organizations mistakenly store passwords or other sensitive
        information in the <strong>description field</strong> of Active
        Directory (AD) user accounts. Attackers who gain read access to AD (even
        with a low-privileged account) can easily extract this information and
        use it to compromise accounts.</p><p><strong>Security
        Implications:</strong></p><ul><li><p><strong>Credential
        Exposure</strong> – Any user with basic read access to AD can extract
        stored passwords.</p></li><li><p><strong>Privilege Escalation</strong> –
        If admin or service account credentials are exposed, attackers can
        escalate their privileges.</p></li><li><p><strong>Lateral
        Movement</strong> – Compromised credentials allow attackers to move
        through the network undetected.</p></li><li><p><strong>Automated
        Discovery by Attackers</strong> – Tools like PowerShell, BloodHound, and
        AD enumeration scripts can quickly harvest plaintext credentials from AD
        fields.</p></li><li><p><strong>Regulatory &amp; Compliance
        Risks</strong> – Storing plaintext passwords in AD violates security
        best practices and compliance requirements (e.g., GDPR, HIPAA,
        PCI-DSS).</p></li></ul>
      remediation: >-
        <ul><li><p><strong>Search &amp; Remove Stored Passwords</strong> –
        Regularly scan AD for sensitive data in <strong>description, comment, or
        notes fields</strong> and remove it. Use e.g.
        PowerShell:</p><p></p><p><code>Get-ADUser -Filter * -Properties
        Description | Where-Object {$_.Description -match "password"} |
        Select-Object Name,
        Description</code></p><p></p></li><li><p><strong>Restrict AD Read
        Access</strong> – Limit who can read user attributes in AD to prevent
        easy credential harvesting.</p></li><li><p><strong>Implement Group
        Policy Restrictions</strong> – Enforce policies that prevent users from
        saving sensitive data in AD fields.</p></li><li><p><strong>Educate IT
        &amp; Admins</strong> – Train staff to never store passwords in AD
        fields, emails, or documentation.</p></li><li><p><strong>Use Secure
        Credential Management</strong> – Store passwords securely in
        <strong>password managers</strong> or vaults like <strong>CyberArk,
        HashiCorp Vault, or KeePass</strong>.</p></li><li><p><strong>Monitor for
        Suspicious Queries</strong> – Use <strong>SIEM tools</strong> to detect
        bulk AD enumeration attempts.</p></li><li><p><strong>Audit AD for
        Misconfigurations</strong> – Regularly review AD configurations for
        security weaknesses.</p></li></ul>
      references: []
      customFields: []
  category: Internal Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
  priority: 3
  remediationComplexity: 3
  details:
    - locale: EN
      title: Domain Password Spray Attack
      vulnType: Pentest
      description: >-
        <p>A <strong>Domain Password Spray Attack</strong> is a brute-force
        technique where an attacker tries a few common passwords (e.g.,
        <em>Spring2024!</em>, <em>Welcome1</em> or <em>P@ssw0rd</em>) against
        many different user accounts within an Active Directory (AD) domain.
        Unlike traditional brute-force attacks that target a single account with
        many password attempts (leading to account lockouts), password spraying
        avoids detection by spreading attempts across multiple
        users.</p><p><strong>Security
        Implications:</strong></p><ul><li><p><strong>Account Compromise</strong>
        – Users with weak or commonly used passwords are vulnerable to
        takeover.</p></li><li><p><strong>Bypassing Lockout Policies</strong> –
        Since each user is only tested a few times, domain lockout policies
        don’t trigger.</p></li><li><p><strong>Privilege Escalation &amp; Lateral
        Movement</strong> – If an attacker compromises an admin account or
        service account, they can move deeper into the
        network.</p></li><li><p><strong>Stealthy Execution</strong> – The attack
        often goes unnoticed because it generates minimal failed login attempts
        per user.</p></li><li><p><strong>Cloud &amp; Hybrid Threat</strong> –
        Password spraying can be used against on-prem AD, cloud environments
        like <strong>Azure AD</strong>, or federated authentication
        services.</p></li></ul>
      remediation: >-
        <ul><li><p><strong>Enforce Strong Password Policies</strong> – Require
        long, complex, and unique passwords that resist common password
        lists.</p></li><li><p><strong>Implement Multi-Factor Authentication
        (MFA)</strong> – Use MFA to prevent unauthorized access, even if
        credentials are compromised.</p></li><li><p><strong>Monitor for Unusual
        Login Failures</strong> – Detect patterns of failed logins across
        multiple accounts (Event IDs <strong>4625</strong> for Windows or
        <strong>SigninLogs</strong> in Azure AD).</p></li><li><p><strong>Use
        Smart Lockout Mechanisms</strong> – Configure adaptive lockout policies
        that block repeated failed logins from a single
        IP.</p></li><li><p><strong>Apply Conditional Access Policies</strong> –
        Restrict access based on device compliance, location, or risk level
        (Azure AD Conditional Access).</p></li><li><p><strong>Audit &amp; Rotate
        Service Account Credentials</strong> – Ensure service accounts use long,
        unique passwords that are changed
        periodically.</p></li><li><p><strong>Enable Threat Intelligence &amp;
        SIEM Monitoring</strong> – Use tools like <strong>Microsoft Defender for
        Identity</strong>, <strong>Splunk</strong>, or <strong>Azure
        Sentinel</strong> to detect suspicious login
        patterns.</p></li><li><p><strong>Limit Legacy Authentication
        Protocols</strong> – Disable legacy authentication (e.g., NTLM, older
        SMTP, and IMAP) which lacks MFA support and is commonly targeted in
        spraying attacks.</p></li><li><p><strong>Have all users which were
        identified having weak credentials change their password
        immediately</strong></p></li></ul>
      references: []
      customFields: []
  category: Internal Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
  priority: 3
  remediationComplexity: 2
  details:
    - locale: EN
      title: Weak Password Policy
      vulnType: Pentest
      description: >-
        <p>A <strong>weak password policy</strong> in an Active Directory (AD)
        environment allows users to set passwords that are short, simple, or
        commonly used. This significantly increases the risk of password-related
        attacks, including:</p><ul><li><p><strong>Brute-Force &amp; Dictionary
        Attacks</strong> – Attackers can easily guess weak passwords using
        automated tools.</p></li><li><p><strong>Password Spraying</strong> –
        Attackers test common passwords across multiple accounts without
        triggering lockouts.</p></li><li><p><strong>Credential Stuffing</strong>
        – Reused passwords from data breaches can grant unauthorized
        access.</p></li><li><p><strong>Privilege Escalation</strong> – If admin
        or service accounts use weak passwords, attackers can gain control over
        critical systems.</p></li><li><p><strong>Compliance Violations</strong>
        – Many regulations (e.g., <strong>NIST, PCI-DSS, HIPAA</strong>) require
        strong password policies.</p></li></ul>
      remediation: >-
        <ul><li><p><strong>Enforce Strong Password
        Requirements</strong></p><ul><li><p>Minimum <strong>14+
        characters</strong></p></li><li><p>Require <strong>uppercase, lowercase,
        numbers, and special characters</strong></p></li><li><p>Avoid dictionary
        words or common patterns (e.g.,
        <em>Spring2024!</em>)</p></li></ul></li><li><p><strong>Enable Azure AD
        Password Protection</strong> (For hybrid/cloud
        environments)</p><ul><li><p>Blocks commonly used
        passwords</p></li><li><p>Prevents slight variations of known weak
        passwords</p></li></ul></li><li><p><strong>Implement Passphrases Instead
        of Complex Rules</strong></p><ul><li><p>Example:
        <em>BlueTiger$CoffeeRain22</em> (Easier to remember, harder to
        crack)</p></li></ul></li><li><p><strong>Use Multi-Factor Authentication
        (MFA)</strong></p><ul><li><p>Even if passwords are compromised, MFA adds
        a second layer of protection</p></li></ul></li><li><p><strong>Prevent
        Password Reuse &amp; History Violations</strong></p><ul><li><p>Enforce a
        <strong>password history</strong> of at least <strong>24 previous
        passwords</strong></p></li></ul></li><li><p><strong>Deploy Account
        Lockout Policies</strong></p><ul><li><p>Lock accounts after <strong>5-10
        failed attempts</strong> to slow brute-force
        attacks</p></li></ul></li><li><p><strong>Regularly Audit &amp; Monitor
        Password Security</strong></p><ul><li><p>Check for weak passwords using
        tools like <strong>LAPS, BloodHound, or
        PwnedPasswords</strong></p></li><li><p>Monitor <strong>Event ID
        4740</strong> (Account Lockouts) for suspicious
        behavior</p></li></ul></li><li><p><strong>Use a Privileged Access
        Management (PAM) Solution</strong></p><ul><li><p>Protect high-value
        admin/service accounts with <strong>password rotation &amp;
        vaulting</strong></p></li></ul></li></ul>
      references: []
      customFields: []
  category: Internal Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
  priority: 3
  remediationComplexity: 2
  details:
    - locale: EN
      title: Storing Credentials in Browser
      vulnType: Pentest
      description: >-
        <p>Many users store credentials in web browsers for convenience, but
        this practice introduces significant security risks,
        including:</p><ul><li><p><strong>Credential Theft</strong> – Malware
        (e.g., <strong>RedLine Stealer, Mimikatz, or Raccoon Stealer</strong>)
        can extract stored passwords from
        browsers.</p></li><li><p><strong>Session Hijacking</strong> – Attackers
        with local or remote access can steal stored session
        cookies.</p></li><li><p><strong>Compromised Cloud &amp; Enterprise
        Accounts</strong> – If corporate credentials are stored and later
        stolen, attackers can access critical business
        applications.</p></li><li><p><strong>Weak or No Encryption</strong> –
        Some browsers store passwords in <strong>unencrypted or weakly encrypted
        formats</strong>, making them easy to
        extract.</p></li><li><p><strong>Syncing Risks</strong> – If a user’s
        personal device is compromised, stolen credentials may sync across all
        linked devices.</p></li></ul>
      remediation: >-
        <ul><li><p><strong>Disable Browser Credential
        Storage</strong></p><ul><li><p>Use <strong>Group Policy (GPO), Intune,
        or MDM</strong> to block password storage in
        browsers.</p></li><li><p>Example: In Windows, disable <strong>"Offer to
        save passwords"</strong> in Chrome via
        GPO.</p></li></ul></li><li><p><strong>Use a Secure Password
        Manager</strong></p><ul><li><p>Deploy <strong>enterprise-grade password
        managers</strong> (e.g., <strong>Bitwarden, 1Password, KeePass, or
        CyberArk</strong>).</p></li><li><p>Ensure they support
        <strong>multi-factor authentication
        (MFA)</strong>.</p></li></ul></li><li><p><strong>Enforce MFA on All
        Accounts</strong></p><ul><li><p>Even if credentials are compromised, MFA
        reduces the risk of unauthorized
        access.</p></li></ul></li><li><p><strong>Monitor &amp; Block Password
        Stealing Malware</strong></p><ul><li><p>Use <strong>Endpoint Detection
        &amp; Response (EDR)</strong> solutions like <strong>Microsoft Defender
        for Endpoint, CrowdStrike, or
        SentinelOne</strong>.</p></li><li><p>Regularly update anti-malware
        definitions.</p></li></ul></li><li><p><strong>Restrict Administrative
        Access</strong></p><ul><li><p>Prevent attackers from escalating
        privileges if they gain access to a system.</p></li><li><p>Use
        <strong>Least Privilege Access</strong> and <strong>Just-in-Time (JIT)
        access</strong>.</p></li></ul></li><li><p><strong>Educate Users on
        Security Risks</strong></p><ul><li><p>Conduct regular security awareness
        training.</p></li><li><p>Teach employees to avoid saving credentials in
        browsers and to use <strong>strong, unique
        passwords</strong>.</p></li></ul></li></ul>
      references: []
      customFields: []
  category: Internal Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
  priority: 3
  remediationComplexity: 3
  details:
    - locale: EN
      title: Sensitive Data in Network Shares
      vulnType: Pentest
      description: >-
        <p>Sensitive data, such as passwords, financial records, personally
        identifiable information (PII), or proprietary business data, is
        sometimes stored in <strong>insecure network shares</strong> with overly
        permissive access. This misconfiguration creates serious security risks,
        including:</p><ul><li><p><strong>Unauthorized Access</strong> –
        Attackers or unauthorized employees can access, steal, or alter
        sensitive information.</p></li><li><p><strong>Data Exfiltration</strong>
        – Compromised data can be leaked, violating regulations like
        <strong>GDPR, HIPAA, PCI-DSS</strong>.</p></li><li><p><strong>Ransomware
        &amp; Malware</strong> – Attackers can encrypt or corrupt critical
        files.</p></li><li><p><strong>Privilege Escalation</strong> – Exposed
        credentials in files (e.g., <strong>passwords.txt, config.ini</strong>)
        can lead to domain compromise.</p></li><li><p><strong>Regulatory &amp;
        Legal Risks</strong> – Non-compliance with industry regulations may lead
        to hefty fines and reputational damage.</p></li></ul>
      remediation: >-
        <ul><li><p><strong>Implement Access Controls (Principle of Least
        Privilege)</strong></p><ul><li><p>Restrict access based on job
        roles.</p></li><li><p>Ensure <strong>only authorized users</strong> can
        read or modify sensitive
        files.</p></li></ul></li><li><p><strong>Regularly Audit &amp; Classify
        Data</strong></p><ul><li><p>Scan for sensitive data using tools like
        <strong>Microsoft Purview, Varonis, or
        OpenDLP</strong>.</p></li><li><p>Remove or relocate exposed sensitive
        files.</p></li></ul></li><li><p><strong>Encrypt Sensitive
        Files</strong></p><ul><li><p>Use <strong>BitLocker, EFS (Encrypting File
        System), or AES-256 encryption</strong> to protect sensitive data at
        rest.</p></li></ul></li><li><p><strong>Monitor &amp; Log File
        Access</strong></p><ul><li><p>Enable auditing for shared folders (Event
        ID <strong>4663</strong> for file access tracking).</p></li><li><p>Use
        <strong>SIEM solutions</strong> to detect abnormal file access
        patterns.</p></li></ul></li><li><p><strong>Use Data Loss Prevention
        (DLP) Solutions</strong></p><ul><li><p>Prevent unauthorized file
        transfers using <strong>Microsoft DLP, Symantec DLP, or Forcepoint
        DLP</strong>.</p></li></ul></li><li><p><strong>Secure Administrative
        Shares</strong></p><ul><li><p>Remove <strong>Everyone</strong> and
        <strong>Authenticated Users</strong> from high-risk share
        permissions.</p></li><li><p>Disable <strong>default administrative
        shares</strong> if not needed (e.g., <strong>C$,
        Admin$</strong>).</p></li></ul></li><li><p><strong>Regularly Review
        &amp; Remove Unused Shares</strong></p><ul><li><p>Decommission old or
        unnecessary shares to reduce attack surface.</p></li></ul></li></ul>
      references: []
      customFields: []
  category: Internal Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
  priority: 3
  remediationComplexity: 2
  details:
    - locale: EN
      title: MitM - Active Directory Integrated DNS (ADIDNS) Attacks
      vulnType: Pentest
      description: >-
        <p><strong>Active Directory Integrated DNS (ADIDNS)</strong> is a
        configuration where DNS data is stored directly in Active Directory,
        leveraging AD replication mechanisms. While this setup provides
        centralized management, it also introduces several security
        risks:</p><ul><li><p><strong>DNS Poisoning/Cache Poisoning</strong> – If
        attackers gain access to ADIDNS, they can manipulate DNS records,
        redirecting traffic to malicious servers.</p></li><li><p><strong>Domain
        Admin Compromise</strong> – An attacker with control over DNS data could
        escalate their privileges by altering domain-joined machine records or
        pointing to malicious domain controllers.</p></li><li><p><strong>Lateral
        Movement &amp; Privilege Escalation</strong> – By modifying DNS records
        for key services (e.g., <strong>Kerberos, LDAP, or SMB</strong>),
        attackers can redirect traffic to compromised servers, enabling them to
        steal credentials or escalate
        privileges.</p></li><li><p><strong>Persistence &amp; Stealth</strong> –
        ADIDNS records are replicated across the domain, making it harder to
        detect unauthorized changes. Once changes are made, they can persist
        even if initial access is lost.<br></p></li></ul><p>By default, every
        member of the <strong>Authenticated Users</strong> group (this means
        every user and every computer) can add such DNS entries. <br>One attack
        scenario is to add a Wildcard Record of "*" so that all entries that
        fail to resolve via ADIDNS would resolve to the attacker controlled
        entry.</p>
      remediation: >-
        <ul><li><p><strong>Restrict DNS Admin
        Access</strong></p><ul><li><p>Apply <strong>least privilege</strong> by
        limiting administrative rights to DNS records and DNS
        servers.</p></li><li><p>Use <strong>Group Policy</strong> to enforce
        restricted access to AD-integrated
        DNS.</p></li></ul></li><li><p><strong>Monitor DNS
        Changes</strong></p><ul><li><p>Implement <strong>auditing</strong> for
        DNS record changes (e.g., using <strong>Event ID 5136</strong> to
        monitor Active Directory modifications).</p></li><li><p>Use
        <strong>SIEM</strong> solutions (e.g., <strong>Splunk,
        SentinelOne</strong>) to detect suspicious DNS record
        changes.</p></li></ul></li><li><p><strong>Harden DNS
        Servers</strong></p><ul><li><p>Ensure DNS servers are <strong>isolated
        from general user access</strong> and only accessible by
        administrators.</p></li><li><p>Enable <strong>DNSSEC</strong> (DNS
        Security Extensions) for additional protection.</p></li><li><p>Use
        <strong>DNS logging</strong> to track query patterns and identify
        potential abuses.</p></li><li><p>Set a Wildcard Record by your own and
        point it e.g. to 127.0.0.1 or
        0.0.0.0</p></li></ul></li><li><p><strong>Use Time-Based
        Monitoring</strong></p><ul><li><p>Monitor for unusual DNS query patterns
        that could indicate DNS manipulation or unauthorized
        access.</p></li><li><p>Detect unusual traffic redirecting to unexpected
        or malicious IPs.</p></li></ul></li><li><p><strong>Regularly Review DNS
        Records</strong></p><ul><li><p>Periodically check for unauthorized or
        suspicious records in the AD-integrated DNS zones.</p></li><li><p>Verify
        that all DNS records align with your organizational requirements and
        configurations.</p></li></ul></li><li><p><strong>Use Split-Horizon
        DNS</strong></p><ul><li><p>For environments with both internal and
        external DNS, implement <strong>split-horizon DNS</strong> to segregate
        internal and external domain
        data.</p></li></ul></li><li><p><strong>Deploy Endpoint
        Protection</strong></p><ul><li><p>Use <strong>EDR (Endpoint Detection
        and Response)</strong> solutions to monitor devices for signs of
        DNS-related attacks.</p></li><li><p>Ensure endpoints are regularly
        scanned for malware that could alter DNS configurations or
        traffic.<br></p></li></ul></li></ul><p><strong>Please take into
        consideration that changes to how ADIDNS operates might have
        implications on your infrastructure. Please also refer to the reference
        section.</strong></p>
      references:
        - >-
          https://www.netspi.com/blog/technical/network-penetration-testing/adidns-revisited/
      customFields: []
  category: Internal Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  priority: 3
  remediationComplexity: 2
  details:
    - locale: EN
      title: Mitm - DHCPv6 Attacks
      vulnType: Pentest
      description: >-
        <p><strong>DHCPv6 Man-in-the-Middle (MitM)</strong> attacks occur when
        an attacker intercepts, manipulates, or impersonates the <strong>Dynamic
        Host Configuration Protocol version 6 (DHCPv6)</strong> communication
        between a device (client) and a DHCPv6 server. In a typical DHCPv6
        setup, clients rely on the DHCPv6 server to obtain configuration
        information, such as IP addresses, DNS servers, and other network
        settings. The attacker exploits this communication to perform malicious
        actions.</p><p>A <strong>MitM attack</strong> on DHCPv6 can lead
        to:</p><ul><li><p><strong>IP Spoofing</strong> – The attacker can
        provide false network configuration data to clients, such as a malicious
        DNS server or gateway.</p></li><li><p><strong>Denial of Service
        (DoS)</strong> – By overwhelming the network with rogue DHCPv6 server
        advertisements or responses, the attacker can prevent clients from
        obtaining valid configurations.</p></li><li><p><strong>Traffic
        Interception</strong> – The attacker can route traffic through a
        malicious system, enabling them to eavesdrop on sensitive data or launch
        further attacks like <strong>credential sniffing</strong> or
        <strong>data exfiltration</strong>.</p></li><li><p><strong>Network
        Manipulation</strong> – By providing a malicious <strong>default
        gateway</strong> or <strong>DNS server</strong>, the attacker can
        manipulate traffic, redirect users to phishing sites, or disrupt
        communications.</p></li></ul><p>In a typical attack scenario, the IPv6
        of the attacker will be set as the DNS Server on the victim systems
        rather than as Default Gateway, which allows a more granular control
        over which assets to attack.</p>
      remediation: >-
        <ul><li><p><strong>Disable IPv6 where
        possible</strong></p></li><li><p><strong>Give IPv4 precedence over
        IPv6</strong></p><ul><li><p>In that case the regular DNS Server provided
        via DHCPv4 would take over and not the malicious DHCPv6
        one.</p></li></ul></li><li><p><strong>Deploy your own IPv6 configuration
        with a valid Gateway and DNS
        server</strong></p></li><li><p><strong>Enable DHCPv6 Security
        Features</strong></p><ul><li><p><strong>DHCPv6 Secure Server</strong>:
        Use authenticated DHCPv6 servers (e.g., <strong>Authorization
        Tokens</strong>) to prevent unauthorized devices from responding to DHCP
        requests.</p></li><li><p><strong>Use RA Guard</strong>: Enable
        <strong>Router Advertisement (RA) Guard</strong> on network switches to
        prevent rogue routers from advertising malicious DHCPv6
        configurations.</p></li><li><p><strong>Use DHCPv6 Snooping</strong>:
        Enable <strong>DHCPv6 Snooping</strong> on network switches to ensure
        only legitimate DHCPv6 servers can send responses to
        clients.</p></li></ul></li><li><p><strong>Implement Network
        Segmentation</strong></p><ul><li><p>Use VLANs or other segmentation
        techniques to separate trusted DHCP servers from untrusted networks,
        making it harder for attackers to introduce rogue DHCPv6
        servers.</p></li></ul></li><li><p><strong>Deploy Intrusion Detection
        Systems (IDS)</strong></p><ul><li><p>Monitor DHCPv6 traffic for
        suspicious behavior (e.g., multiple servers offering configurations or
        conflicting options). Use <strong>IDS/IPS systems</strong> (like
        <strong>Suricata</strong> or <strong>Snort</strong>) to detect and block
        malicious DHCPv6 traffic.</p></li></ul></li><li><p><strong>Monitor for
        Rogue DHCPv6 Servers</strong></p><ul><li><p>Regularly scan the network
        for rogue DHCPv6 servers using tools like <strong>dhcpdump</strong> or
        <strong>Wireshark</strong> to capture and analyze DHCPv6 packets for any
        suspicious activity.</p></li><li><p>Set up alerts for any
        <strong>unauthorized DHCPv6 advertisements</strong> on the
        network.</p></li></ul></li><li><p><strong>Use
        IPsec</strong></p><ul><li><p>Implement <strong>IPsec</strong> or other
        encryption mechanisms to protect the integrity and confidentiality of
        DHCPv6 communications, reducing the risk of interception and
        modification.</p></li></ul></li><li><p><strong>Educate Users and
        Implement Strong Network Access Control</strong></p><ul><li><p>Use
        <strong>802.1X</strong> network authentication to prevent unauthorized
        devices from connecting to the network.</p></li><li><p>Train employees
        to recognize potential phishing or other social engineering attacks that
        could follow a successful DHCPv6 MitM
        attack.</p></li></ul></li><li><p><strong>Implement DHCPv6 Lease Expiry
        &amp; Monitoring</strong></p><ul><li><p>Monitor DHCPv6 lease times and
        ensure that leases are refreshed periodically to avoid long-term
        exploitation of compromised configurations.</p></li></ul></li></ul><p>Be
        especially cautious when doing this on Server systems. Microsoft does
        not recommend disabling IPv6 especially on Domain Controllers and
        Exchange Servers.</p>
      references: []
      customFields: []
  category: Internal Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  priority: 3
  remediationComplexity: 2
  details:
    - locale: EN
      title: Mitm - ARP Spoofing
      vulnType: Pentest
      description: >-
        <p><strong>ARP Spoofing</strong> (or <strong>ARP poisoning</strong>) is
        a type of <strong>Man-in-the-Middle (MitM)</strong> attack in which an
        attacker sends fake <strong>Address Resolution Protocol (ARP)</strong>
        messages on a local network. ARP is used to map a device's IP address to
        its MAC address, allowing devices on a network to communicate with each
        other. By spoofing ARP messages, the attacker can associate their
        <strong>MAC address with a legitimate IP address</strong>, usually that
        of a <strong>gateway</strong> or <strong>target
        device</strong>.</p><p><strong>Security Implications of ARP
        Spoofing:</strong></p><ul><li><p><strong>Traffic Interception &amp;
        Sniffing</strong> – The attacker can intercept and read all network
        traffic between devices, allowing them to capture sensitive information
        like passwords, usernames, and session
        cookies.</p></li><li><p><strong>Man-in-the-Middle (MitM)
        Attacks</strong> – After intercepting traffic, attackers can alter it
        before sending it to the intended recipient. This opens the door for
        activities like session hijacking, data modification, and injection of
        malicious content.</p></li><li><p><strong>Denial of Service
        (DoS)</strong> – By corrupting ARP tables or creating network loops,
        attackers can disrupt communication, preventing devices from accessing
        critical resources.</p></li><li><p><strong>Privilege Escalation</strong>
        – In some cases, attackers can exploit the data they intercept (such as
        unencrypted credentials) to escalate privileges on internal
        systems.</p></li><li><p><strong>Bypass Network Security</strong> – ARP
        spoofing can be used to bypass security mechanisms like firewalls,
        IDS/IPS, or encryption if the attacker is positioned between the target
        devices and the network resources.</p></li></ul>
      remediation: >-
        <ul><li><p><strong>Use Static ARP
        Entries</strong></p><ul><li><p>Manually configure static ARP entries for
        critical systems (like gateways, DNS servers, or servers with sensitive
        data) so that ARP resolution cannot be poisoned. This reduces the
        likelihood of spoofing.</p></li><li><p>On Linux/Unix systems, you can
        add static ARP entries using:</p><p><code>sudo arp -s &lt;IP Address&gt;
        &lt;MAC Address&gt;</code></p></li></ul></li><li><p><strong>Enable
        Dynamic ARP Inspection (DAI)</strong></p><ul><li><p>Use <strong>Dynamic
        ARP Inspection (DAI)</strong> on network switches to validate ARP
        packets. DAI checks the integrity of ARP packets before they are
        processed, ensuring they come from trusted sources.</p></li><li><p>Most
        modern <strong>Cisco</strong> and <strong>HP ProCurve</strong> switches
        support DAI to prevent ARP spoofing
        attacks.</p></li></ul></li><li><p><strong>Use VLANs and Network
        Segmentation</strong></p><ul><li><p>Segment networks into smaller VLANs
        (Virtual Local Area Networks) to limit the scope of ARP poisoning
        attacks. This ensures that attackers can’t affect the entire
        network.</p></li><li><p>Limit the ARP broadcast domain to reduce the
        attack surface.</p></li></ul></li><li><p><strong>Implement Intrusion
        Detection Systems (IDS)</strong></p><ul><li><p>Use <strong>IDS</strong>
        tools (e.g., <strong>Snort, Suricata, or Zeek</strong>) to detect
        abnormal ARP traffic, such as multiple ARP replies with different MAC
        addresses for the same IP.</p></li><li><p>Many IDS systems can
        automatically alert or take action if suspicious ARP traffic is
        detected.</p></li></ul></li><li><p><strong>Monitor Network
        Traffic</strong></p><ul><li><p>Regularly monitor ARP traffic on the
        network using tools like <strong>Wireshark</strong> or
        <strong>tcpdump</strong> to identify any irregular ARP
        replies.</p></li><li><p>Look for duplicate IP-to-MAC address mappings,
        which could indicate an ARP spoofing
        attack.</p></li></ul></li><li><p><strong>Use
        Encryption</strong></p><ul><li><p>Employ <strong>TLS/SSL
        encryption</strong> for sensitive communications to prevent attackers
        from reading or altering intercepted data, even if they are successful
        in executing ARP spoofing.</p></li><li><p>Use <strong>VPNs</strong> for
        internal communication to ensure that the traffic is encrypted
        end-to-end, protecting it from
        interception.</p></li></ul></li><li><p><strong>Use ARP Spoofing
        Detection Tools</strong></p><ul><li><p>Tools like <strong>XArp</strong>,
        <strong>Cain &amp; Abel</strong>, or <strong>arpspoof</strong> can be
        used to detect and block ARP poisoning on the
        network.</p></li><li><p>These tools can help identify discrepancies in
        ARP tables and identify suspicious activities on the local
        network.</p></li></ul></li><li><p><strong>Educate
        Users</strong></p><ul><li><p>Train network users to be aware of
        suspicious network behavior (e.g., abnormal performance, certificate
        errors, etc.) and encourage the use of encrypted communication for
        sensitive operations.</p></li></ul></li></ul>
      references: []
      customFields: []
  category: Internal Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N
  priority: 2
  remediationComplexity: 3
  details:
    - locale: EN
      title: LDAP Signing and Channel Binding
      description: >-
        <p><strong>LDAP Signing</strong> and <strong>Channel Binding</strong>
        are security mechanisms designed to protect <strong>LDAP</strong>
        (Lightweight Directory Access Protocol) traffic between clients and
        servers from being tampered with or intercepted by attackers. Without
        these protections, LDAP traffic can be vulnerable to
        <strong>Man-in-the-Middle (MitM)</strong> attacks, where attackers can
        intercept, modify, or impersonate legitimate LDAP
        communications.</p><p><strong>LDAP Signing</strong>:</p><p>LDAP Signing
        ensures that the data exchanged between the LDAP client and server is
        <strong>integrity-protected</strong>, preventing tampering during
        transmission. When LDAP Signing is enabled, both the client and server
        verify that the data has not been altered in
        transit.</p><ul><li><p><strong>Security Implications of LDAP
        Signing</strong>:</p><ul><li><p><strong>Man-in-the-Middle (MitM)
        Attacks</strong>: If LDAP signing is disabled, an attacker can intercept
        and modify LDAP traffic, potentially compromising user credentials or
        altering authentication requests.</p></li><li><p><strong>Credential
        Theft</strong>: Attackers can steal plaintext credentials or session
        data if the LDAP traffic is not signed and
        encrypted.</p></li><li><p><strong>Replay Attacks</strong>: Without
        signing, attackers can replay intercepted LDAP messages to gain
        unauthorized access.</p></li></ul></li></ul><p><strong>Channel
        Binding</strong>:</p><p>Channel Binding works alongside <strong>LDAP
        Signing</strong> and adds an additional layer of protection. It binds
        the authentication channel to the underlying transport layer (typically
        <strong>TLS/SSL</strong> or <strong>SMB</strong>), ensuring that LDAP
        traffic is encrypted and protected from tampering or interception by
        unauthorized parties. This mechanism helps defend against attacks that
        might involve manipulating the channel’s
        identity.</p><ul><li><p><strong>Security Implications of Channel
        Binding</strong>:</p><ul><li><p><strong>Session Hijacking</strong>:
        Without channel binding, attackers can hijack a valid session by
        intercepting and manipulating the
        connection.</p></li><li><p><strong>Unencrypted Communications</strong>:
        Channel binding ensures that LDAP messages are not only signed but also
        securely encrypted, protecting sensitive
        information.</p></li><li><p><strong>Man-in-the-Middle (MitM)
        Attacks</strong>: In the absence of channel binding, attackers could
        exploit vulnerabilities in the transport layer (e.g., downgrade attacks)
        to bypass encryption.</p></li></ul></li></ul>
      remediation: >-
        <p><strong>Enforce LDAP Signing</strong></p><ul><li><p><strong>Group
        Policy Configuration</strong>: Ensure that LDAP signing is enabled
        across the domain. In Active Directory, LDAP signing can be enforced via
        Group Policy settings.</p><ul><li><p>Open <strong>Group Policy
        Management</strong> → Computer Configuration → Administrative Templates
        → System → <strong>Netlogon</strong> → Enable <strong>LDAP client
        signing</strong> and <strong>LDAP server
        signing</strong>.</p></li><li><p><strong>Setting</strong>:
        <strong>Require signing</strong> (This forces all LDAP communication to
        be signed).</p></li></ul></li><li><p><strong>Registry
        Configuration</strong>: On the server side, ensure the registry is
        configured to require LDAP
        signing:</p><p><code>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\NTDS\Parameters</code></p><p><code>Value
        Name: LDAPServerIntegrity Value Type: REG_DWORD Value Data:
        2</code></p><p>The value <code>2</code> ensures that LDAP communication
        is signed by requiring it.</p></li></ul><p><strong>Enable LDAP Channel
        Binding</strong></p><ul><li><p><strong>Enable Channel Binding in Group
        Policy</strong>: Channel binding is part of the modern <strong>Kerberos
        authentication</strong> in Windows environments and can be configured
        through Group Policy settings:</p><ul><li><p>Open <strong>Group Policy
        Management</strong> → Computer Configuration → Administrative Templates
        → System → <strong>Kerberos</strong> → <strong>Enable Channel
        Binding</strong>.</p></li><li><p>Set to <strong>Enabled</strong> to
        ensure that LDAP authentication is protected by the transport
        layer.</p></li></ul></li><li><p><strong>Registry Configuration</strong>:
        On the server side, ensure the registry is configured to require LDAP
        signing:</p><p><code>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\NTDS\Parameters</code></p><p><code>Value
        Name: LDAPEnforceChannelBinding Value Type: REG_DWORD Value Data:
        2</code></p><p>The value <code>2</code> enforces LDAP Channel Binding.
        Value <code>1</code> would enable it "when
        supported".</p></li><li><p><strong>Use TLS/SSL for LDAP</strong>: Make
        sure that LDAP traffic is encrypted using <strong>LDAPS</strong> (LDAP
        over SSL/TLS). This prevents attackers from being able to intercept or
        tamper with the LDAP traffic.</p><ul><li><p>You can configure the LDAP
        server to listen on the secure port <strong>636</strong> for LDAPS
        connections.</p></li></ul></li></ul><p><strong>Regularly Review and
        Update Security Protocols</strong></p><ul><li><p><strong>Use Modern
        Cryptographic Protocols</strong>: Ensure that LDAP signing and channel
        binding are using up-to-date, secure cryptographic protocols. Avoid
        deprecated versions of TLS/SSL (e.g., SSLv3 or TLS
        1.0).</p></li><li><p><strong>Enforce Strong Encryption</strong>: Enforce
        encryption for all network traffic, especially for administrative
        access, to prevent data leakage or manipulation. Prefer
        <strong>AES</strong> and <strong>RSA</strong> algorithms over weaker
        ciphers.</p></li></ul><p><strong>Network Monitoring and Intrusion
        Detection</strong></p><ul><li><p><strong>Audit LDAP Traffic</strong>:
        Regularly monitor LDAP traffic using network security tools (e.g.,
        <strong>Wireshark</strong>, <strong>NetFlow</strong>, or <strong>NAC
        solutions</strong>) to identify unencrypted, unsigned, or anomalous
        traffic.</p></li><li><p><strong>Use SIEM Solutions</strong>: Security
        Information and Event Management (SIEM) tools can help detect and alert
        on suspicious LDAP traffic patterns or unexpected attempts to disable
        LDAP signing or channel binding.</p></li></ul><p><strong>Educate and
        Train Administrators</strong></p><ul><li><p>Ensure that <strong>IT
        administrators</strong> are aware of the importance of enforcing
        <strong>LDAP signing</strong> and <strong>channel binding</strong>,
        especially when working with older systems or transitioning between
        protocols.</p></li></ul><p><strong>Perform Regular Vulnerability
        Scanning</strong></p><ul><li><p>Regularly scan your LDAP infrastructure
        for vulnerabilities using tools like <strong>Nessus</strong>,
        <strong>Qualys</strong>, or <strong>OpenVAS</strong>. Ensure that there
        are no weak configurations or outdated protocols allowing unprotected
        LDAP traffic.</p></li></ul>
      references: []
      customFields: []
  category: Internal Pentest
- cvssv3: null
  details:
    - locale: EN
      title: Structural Findings Internal Pentest
      vulnType: Pentest
      description: >-
        <p>This finding is to aggregate structural findings that came up during
        the engagement but that do not fit into specific categories.</p>
      references: []
      customFields: []
  category: Internal Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N
  priority: 2
  remediationComplexity: 1
  details:
    - locale: EN
      title: Open Mail Relay
      vulnType: Pentest
      description: >-
        <p>An <strong>open mail relay</strong> occurs when an <strong>email
        server</strong> (such as Microsoft Exchange) accepts and forwards emails
        from <strong>any source without authentication</strong>. This allows
        attackers to:</p><ul><li><p><strong>Send spam or phishing
        emails</strong> using your server’s
        IP/domain.</p></li><li><p><strong>Spoof legitimate emails</strong> to
        impersonate internal users.</p></li><li><p><strong>Bypass security
        filters</strong> by relaying emails
        internally.</p></li><li><p><strong>Get blacklisted</strong> by email
        providers due to spam activity.</p></li><li><p><strong>Aid in data
        exfiltration</strong> by forwarding sensitive emails outside the
        organization.</p></li></ul>
      remediation: >-
        <ul><li><p><strong>Restrict Mail Relay to Trusted
        Hosts</strong></p></li><li><p><strong>Enforce
        authentication</strong></p></li><li><p><strong>Disable Anonymous Mail
        Relay</strong></p></li><li><p><strong>Enable Logging to Detect
        Abuse</strong></p></li></ul>
      references: []
      customFields: []
  category: Internal Pentest
- cvssv3: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N
  priority: 2
  remediationComplexity: 1
  details:
    - locale: EN
      title: Resource Based Constrained Delegation (RBCD) Attacks
      vulnType: Pentest
      description: >-
        <p>Resource-Based Constrained Delegation (RBCD) allows a service on one
        computer to authenticate as a user to another computer. It is commonly
        used for service-to-service authentication in Active Directory
        environments.</p><p>If misconfigured, attackers can abuse RBCD to
        escalate privileges and move laterally within the
        network.</p><p><strong>Security Risks of Misconfigured
        RBCD</strong></p><ul><li><p><strong>Privilege Escalation</strong> –
        Attackers can impersonate privileged users e.g. a Domain
        Admin.</p></li><li><p><strong>Lateral Movement</strong> – An attacker
        who compromises one machine can pivot to
        others.</p></li><li><p><strong>Persistence</strong> – Attackers can
        create rogue computer objects and grant themselves delegation
        rights.</p></li></ul>
      remediation: >-
        <p>Set the ms-DS-MachineAccountQuota value of the domain to 0.<br>Remove
        the Authenticated Users group from the Default Domain Controllers policy
        to add to computer objects to the domain.<br></p><img
        class="custom-image" src="67dd199d9979c84ef3f170bd" alt="Setting to
        allow adding computer objects to the domain">
      references:
        - >-
          https://luemmelsec.github.io/S4fuckMe2selfAndUAndU2proxy-A-low-dive-into-Kerberos-delegations/
      customFields: []
  category: Internal Pentest
